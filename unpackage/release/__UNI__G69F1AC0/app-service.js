if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";const t={id:"2852637",name:"uniui图标库",font_family:"uniicons",css_prefix_text:"uniui-",description:"",glyphs:[{icon_id:"25027049",name:"yanse",font_class:"color",unicode:"e6cf",unicode_decimal:59087},{icon_id:"25027048",name:"wallet",font_class:"wallet",unicode:"e6b1",unicode_decimal:59057},{icon_id:"25015720",name:"settings-filled",font_class:"settings-filled",unicode:"e6ce",unicode_decimal:59086},{icon_id:"25015434",name:"shimingrenzheng-filled",font_class:"auth-filled",unicode:"e6cc",unicode_decimal:59084},{icon_id:"24934246",name:"shop-filled",font_class:"shop-filled",unicode:"e6cd",unicode_decimal:59085},{icon_id:"24934159",name:"staff-filled-01",font_class:"staff-filled",unicode:"e6cb",unicode_decimal:59083},{icon_id:"24932461",name:"VIP-filled",font_class:"vip-filled",unicode:"e6c6",unicode_decimal:59078},{icon_id:"24932462",name:"plus_circle_fill",font_class:"plus-filled",unicode:"e6c7",unicode_decimal:59079},{icon_id:"24932463",name:"folder_add-filled",font_class:"folder-add-filled",unicode:"e6c8",unicode_decimal:59080},{icon_id:"24932464",name:"yanse-filled",font_class:"color-filled",unicode:"e6c9",unicode_decimal:59081},{icon_id:"24932465",name:"tune-filled",font_class:"tune-filled",unicode:"e6ca",unicode_decimal:59082},{icon_id:"24932455",name:"a-rilidaka-filled",font_class:"calendar-filled",unicode:"e6c0",unicode_decimal:59072},{icon_id:"24932456",name:"notification-filled",font_class:"notification-filled",unicode:"e6c1",unicode_decimal:59073},{icon_id:"24932457",name:"wallet-filled",font_class:"wallet-filled",unicode:"e6c2",unicode_decimal:59074},{icon_id:"24932458",name:"paihangbang-filled",font_class:"medal-filled",unicode:"e6c3",unicode_decimal:59075},{icon_id:"24932459",name:"gift-filled",font_class:"gift-filled",unicode:"e6c4",unicode_decimal:59076},{icon_id:"24932460",name:"fire-filled",font_class:"fire-filled",unicode:"e6c5",unicode_decimal:59077},{icon_id:"24928001",name:"refreshempty",font_class:"refreshempty",unicode:"e6bf",unicode_decimal:59071},{icon_id:"24926853",name:"location-ellipse",font_class:"location-filled",unicode:"e6af",unicode_decimal:59055},{icon_id:"24926735",name:"person-filled",font_class:"person-filled",unicode:"e69d",unicode_decimal:59037},{icon_id:"24926703",name:"personadd-filled",font_class:"personadd-filled",unicode:"e698",unicode_decimal:59032},{icon_id:"24923351",name:"back",font_class:"back",unicode:"e6b9",unicode_decimal:59065},{icon_id:"24923352",name:"forward",font_class:"forward",unicode:"e6ba",unicode_decimal:59066},{icon_id:"24923353",name:"arrowthinright",font_class:"arrow-right",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923353",name:"arrowthinright",font_class:"arrowthinright",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrow-left",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrowthinleft",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923355",name:"arrowthinup",font_class:"arrow-up",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923355",name:"arrowthinup",font_class:"arrowthinup",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923356",name:"arrowthindown",font_class:"arrow-down",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923356",name:"arrowthindown",font_class:"arrowthindown",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923349",name:"arrowdown",font_class:"bottom",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923349",name:"arrowdown",font_class:"arrowdown",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923346",name:"arrowright",font_class:"right",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923346",name:"arrowright",font_class:"arrowright",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923347",name:"arrowup",font_class:"top",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923347",name:"arrowup",font_class:"arrowup",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923348",name:"arrowleft",font_class:"left",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923348",name:"arrowleft",font_class:"arrowleft",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923334",name:"eye",font_class:"eye",unicode:"e651",unicode_decimal:58961},{icon_id:"24923335",name:"eye-filled",font_class:"eye-filled",unicode:"e66a",unicode_decimal:58986},{icon_id:"24923336",name:"eye-slash",font_class:"eye-slash",unicode:"e6b3",unicode_decimal:59059},{icon_id:"24923337",name:"eye-slash-filled",font_class:"eye-slash-filled",unicode:"e6b4",unicode_decimal:59060},{icon_id:"24923305",name:"info-filled",font_class:"info-filled",unicode:"e649",unicode_decimal:58953},{icon_id:"24923299",name:"reload-01",font_class:"reload",unicode:"e6b2",unicode_decimal:59058},{icon_id:"24923195",name:"mic_slash_fill",font_class:"micoff-filled",unicode:"e6b0",unicode_decimal:59056},{icon_id:"24923165",name:"map-pin-ellipse",font_class:"map-pin-ellipse",unicode:"e6ac",unicode_decimal:59052},{icon_id:"24923166",name:"map-pin",font_class:"map-pin",unicode:"e6ad",unicode_decimal:59053},{icon_id:"24923167",name:"location",font_class:"location",unicode:"e6ae",unicode_decimal:59054},{icon_id:"24923064",name:"starhalf",font_class:"starhalf",unicode:"e683",unicode_decimal:59011},{icon_id:"24923065",name:"star",font_class:"star",unicode:"e688",unicode_decimal:59016},{icon_id:"24923066",name:"star-filled",font_class:"star-filled",unicode:"e68f",unicode_decimal:59023},{icon_id:"24899646",name:"a-rilidaka",font_class:"calendar",unicode:"e6a0",unicode_decimal:59040},{icon_id:"24899647",name:"fire",font_class:"fire",unicode:"e6a1",unicode_decimal:59041},{icon_id:"24899648",name:"paihangbang",font_class:"medal",unicode:"e6a2",unicode_decimal:59042},{icon_id:"24899649",name:"font",font_class:"font",unicode:"e6a3",unicode_decimal:59043},{icon_id:"24899650",name:"gift",font_class:"gift",unicode:"e6a4",unicode_decimal:59044},{icon_id:"24899651",name:"link",font_class:"link",unicode:"e6a5",unicode_decimal:59045},{icon_id:"24899652",name:"notification",font_class:"notification",unicode:"e6a6",unicode_decimal:59046},{icon_id:"24899653",name:"staff",font_class:"staff",unicode:"e6a7",unicode_decimal:59047},{icon_id:"24899654",name:"VIP",font_class:"vip",unicode:"e6a8",unicode_decimal:59048},{icon_id:"24899655",name:"folder_add",font_class:"folder-add",unicode:"e6a9",unicode_decimal:59049},{icon_id:"24899656",name:"tune",font_class:"tune",unicode:"e6aa",unicode_decimal:59050},{icon_id:"24899657",name:"shimingrenzheng",font_class:"auth",unicode:"e6ab",unicode_decimal:59051},{icon_id:"24899565",name:"person",font_class:"person",unicode:"e699",unicode_decimal:59033},{icon_id:"24899566",name:"email-filled",font_class:"email-filled",unicode:"e69a",unicode_decimal:59034},{icon_id:"24899567",name:"phone-filled",font_class:"phone-filled",unicode:"e69b",unicode_decimal:59035},{icon_id:"24899568",name:"phone",font_class:"phone",unicode:"e69c",unicode_decimal:59036},{icon_id:"24899570",name:"email",font_class:"email",unicode:"e69e",unicode_decimal:59038},{icon_id:"24899571",name:"personadd",font_class:"personadd",unicode:"e69f",unicode_decimal:59039},{icon_id:"24899558",name:"chatboxes-filled",font_class:"chatboxes-filled",unicode:"e692",unicode_decimal:59026},{icon_id:"24899559",name:"contact",font_class:"contact",unicode:"e693",unicode_decimal:59027},{icon_id:"24899560",name:"chatbubble-filled",font_class:"chatbubble-filled",unicode:"e694",unicode_decimal:59028},{icon_id:"24899561",name:"contact-filled",font_class:"contact-filled",unicode:"e695",unicode_decimal:59029},{icon_id:"24899562",name:"chatboxes",font_class:"chatboxes",unicode:"e696",unicode_decimal:59030},{icon_id:"24899563",name:"chatbubble",font_class:"chatbubble",unicode:"e697",unicode_decimal:59031},{icon_id:"24881290",name:"upload-filled",font_class:"upload-filled",unicode:"e68e",unicode_decimal:59022},{icon_id:"24881292",name:"upload",font_class:"upload",unicode:"e690",unicode_decimal:59024},{icon_id:"24881293",name:"weixin",font_class:"weixin",unicode:"e691",unicode_decimal:59025},{icon_id:"24881274",name:"compose",font_class:"compose",unicode:"e67f",unicode_decimal:59007},{icon_id:"24881275",name:"qq",font_class:"qq",unicode:"e680",unicode_decimal:59008},{icon_id:"24881276",name:"download-filled",font_class:"download-filled",unicode:"e681",unicode_decimal:59009},{icon_id:"24881277",name:"pengyouquan",font_class:"pyq",unicode:"e682",unicode_decimal:59010},{icon_id:"24881279",name:"sound",font_class:"sound",unicode:"e684",unicode_decimal:59012},{icon_id:"24881280",name:"trash-filled",font_class:"trash-filled",unicode:"e685",unicode_decimal:59013},{icon_id:"24881281",name:"sound-filled",font_class:"sound-filled",unicode:"e686",unicode_decimal:59014},{icon_id:"24881282",name:"trash",font_class:"trash",unicode:"e687",unicode_decimal:59015},{icon_id:"24881284",name:"videocam-filled",font_class:"videocam-filled",unicode:"e689",unicode_decimal:59017},{icon_id:"24881285",name:"spinner-cycle",font_class:"spinner-cycle",unicode:"e68a",unicode_decimal:59018},{icon_id:"24881286",name:"weibo",font_class:"weibo",unicode:"e68b",unicode_decimal:59019},{icon_id:"24881288",name:"videocam",font_class:"videocam",unicode:"e68c",unicode_decimal:59020},{icon_id:"24881289",name:"download",font_class:"download",unicode:"e68d",unicode_decimal:59021},{icon_id:"24879601",name:"help",font_class:"help",unicode:"e679",unicode_decimal:59001},{icon_id:"24879602",name:"navigate-filled",font_class:"navigate-filled",unicode:"e67a",unicode_decimal:59002},{icon_id:"24879603",name:"plusempty",font_class:"plusempty",unicode:"e67b",unicode_decimal:59003},{icon_id:"24879604",name:"smallcircle",font_class:"smallcircle",unicode:"e67c",unicode_decimal:59004},{icon_id:"24879605",name:"minus-filled",font_class:"minus-filled",unicode:"e67d",unicode_decimal:59005},{icon_id:"24879606",name:"micoff",font_class:"micoff",unicode:"e67e",unicode_decimal:59006},{icon_id:"24879588",name:"closeempty",font_class:"closeempty",unicode:"e66c",unicode_decimal:58988},{icon_id:"24879589",name:"clear",font_class:"clear",unicode:"e66d",unicode_decimal:58989},{icon_id:"24879590",name:"navigate",font_class:"navigate",unicode:"e66e",unicode_decimal:58990},{icon_id:"24879591",name:"minus",font_class:"minus",unicode:"e66f",unicode_decimal:58991},{icon_id:"24879592",name:"image",font_class:"image",unicode:"e670",unicode_decimal:58992},{icon_id:"24879593",name:"mic",font_class:"mic",unicode:"e671",unicode_decimal:58993},{icon_id:"24879594",name:"paperplane",font_class:"paperplane",unicode:"e672",unicode_decimal:58994},{icon_id:"24879595",name:"close",font_class:"close",unicode:"e673",unicode_decimal:58995},{icon_id:"24879596",name:"help-filled",font_class:"help-filled",unicode:"e674",unicode_decimal:58996},{icon_id:"24879597",name:"plus-filled",font_class:"paperplane-filled",unicode:"e675",unicode_decimal:58997},{icon_id:"24879598",name:"plus",font_class:"plus",unicode:"e676",unicode_decimal:58998},{icon_id:"24879599",name:"mic-filled",font_class:"mic-filled",unicode:"e677",unicode_decimal:58999},{icon_id:"24879600",name:"image-filled",font_class:"image-filled",unicode:"e678",unicode_decimal:59e3},{icon_id:"24855900",name:"locked-filled",font_class:"locked-filled",unicode:"e668",unicode_decimal:58984},{icon_id:"24855901",name:"info",font_class:"info",unicode:"e669",unicode_decimal:58985},{icon_id:"24855903",name:"locked",font_class:"locked",unicode:"e66b",unicode_decimal:58987},{icon_id:"24855884",name:"camera-filled",font_class:"camera-filled",unicode:"e658",unicode_decimal:58968},{icon_id:"24855885",name:"chat-filled",font_class:"chat-filled",unicode:"e659",unicode_decimal:58969},{icon_id:"24855886",name:"camera",font_class:"camera",unicode:"e65a",unicode_decimal:58970},{icon_id:"24855887",name:"circle",font_class:"circle",unicode:"e65b",unicode_decimal:58971},{icon_id:"24855888",name:"checkmarkempty",font_class:"checkmarkempty",unicode:"e65c",unicode_decimal:58972},{icon_id:"24855889",name:"chat",font_class:"chat",unicode:"e65d",unicode_decimal:58973},{icon_id:"24855890",name:"circle-filled",font_class:"circle-filled",unicode:"e65e",unicode_decimal:58974},{icon_id:"24855891",name:"flag",font_class:"flag",unicode:"e65f",unicode_decimal:58975},{icon_id:"24855892",name:"flag-filled",font_class:"flag-filled",unicode:"e660",unicode_decimal:58976},{icon_id:"24855893",name:"gear-filled",font_class:"gear-filled",unicode:"e661",unicode_decimal:58977},{icon_id:"24855894",name:"home",font_class:"home",unicode:"e662",unicode_decimal:58978},{icon_id:"24855895",name:"home-filled",font_class:"home-filled",unicode:"e663",unicode_decimal:58979},{icon_id:"24855896",name:"gear",font_class:"gear",unicode:"e664",unicode_decimal:58980},{icon_id:"24855897",name:"smallcircle-filled",font_class:"smallcircle-filled",unicode:"e665",unicode_decimal:58981},{icon_id:"24855898",name:"map-filled",font_class:"map-filled",unicode:"e666",unicode_decimal:58982},{icon_id:"24855899",name:"map",font_class:"map",unicode:"e667",unicode_decimal:58983},{icon_id:"24855825",name:"refresh-filled",font_class:"refresh-filled",unicode:"e656",unicode_decimal:58966},{icon_id:"24855826",name:"refresh",font_class:"refresh",unicode:"e657",unicode_decimal:58967},{icon_id:"24855808",name:"cloud-upload",font_class:"cloud-upload",unicode:"e645",unicode_decimal:58949},{icon_id:"24855809",name:"cloud-download-filled",font_class:"cloud-download-filled",unicode:"e646",unicode_decimal:58950},{icon_id:"24855810",name:"cloud-download",font_class:"cloud-download",unicode:"e647",unicode_decimal:58951},{icon_id:"24855811",name:"cloud-upload-filled",font_class:"cloud-upload-filled",unicode:"e648",unicode_decimal:58952},{icon_id:"24855813",name:"redo",font_class:"redo",unicode:"e64a",unicode_decimal:58954},{icon_id:"24855814",name:"images-filled",font_class:"images-filled",unicode:"e64b",unicode_decimal:58955},{icon_id:"24855815",name:"undo-filled",font_class:"undo-filled",unicode:"e64c",unicode_decimal:58956},{icon_id:"24855816",name:"more",font_class:"more",unicode:"e64d",unicode_decimal:58957},{icon_id:"24855817",name:"more-filled",font_class:"more-filled",unicode:"e64e",unicode_decimal:58958},{icon_id:"24855818",name:"undo",font_class:"undo",unicode:"e64f",unicode_decimal:58959},{icon_id:"24855819",name:"images",font_class:"images",unicode:"e650",unicode_decimal:58960},{icon_id:"24855821",name:"paperclip",font_class:"paperclip",unicode:"e652",unicode_decimal:58962},{icon_id:"24855822",name:"settings",font_class:"settings",unicode:"e653",unicode_decimal:58963},{icon_id:"24855823",name:"search",font_class:"search",unicode:"e654",unicode_decimal:58964},{icon_id:"24855824",name:"redo-filled",font_class:"redo-filled",unicode:"e655",unicode_decimal:58965},{icon_id:"24841702",name:"list",font_class:"list",unicode:"e644",unicode_decimal:58948},{icon_id:"24841489",name:"mail-open-filled",font_class:"mail-open-filled",unicode:"e63a",unicode_decimal:58938},{icon_id:"24841491",name:"hand-thumbsdown-filled",font_class:"hand-down-filled",unicode:"e63c",unicode_decimal:58940},{icon_id:"24841492",name:"hand-thumbsdown",font_class:"hand-down",unicode:"e63d",unicode_decimal:58941},{icon_id:"24841493",name:"hand-thumbsup-filled",font_class:"hand-up-filled",unicode:"e63e",unicode_decimal:58942},{icon_id:"24841494",name:"hand-thumbsup",font_class:"hand-up",unicode:"e63f",unicode_decimal:58943},{icon_id:"24841496",name:"heart-filled",font_class:"heart-filled",unicode:"e641",unicode_decimal:58945},{icon_id:"24841498",name:"mail-open",font_class:"mail-open",unicode:"e643",unicode_decimal:58947},{icon_id:"24841488",name:"heart",font_class:"heart",unicode:"e639",unicode_decimal:58937},{icon_id:"24839963",name:"loop",font_class:"loop",unicode:"e633",unicode_decimal:58931},{icon_id:"24839866",name:"pulldown",font_class:"pulldown",unicode:"e632",unicode_decimal:58930},{icon_id:"24813798",name:"scan",font_class:"scan",unicode:"e62a",unicode_decimal:58922},{icon_id:"24813786",name:"bars",font_class:"bars",unicode:"e627",unicode_decimal:58919},{icon_id:"24813788",name:"cart-filled",font_class:"cart-filled",unicode:"e629",unicode_decimal:58921},{icon_id:"24813790",name:"checkbox",font_class:"checkbox",unicode:"e62b",unicode_decimal:58923},{icon_id:"24813791",name:"checkbox-filled",font_class:"checkbox-filled",unicode:"e62c",unicode_decimal:58924},{icon_id:"24813794",name:"shop",font_class:"shop",unicode:"e62f",unicode_decimal:58927},{icon_id:"24813795",name:"headphones",font_class:"headphones",unicode:"e630",unicode_decimal:58928},{icon_id:"24813796",name:"cart",font_class:"cart",unicode:"e631",unicode_decimal:58929}]},a=(e,t)=>{const a=e.__vccOpts||e;for(const[n,i]of t)a[n]=i;return a};const n=a({name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""}},data:()=>({icons:t.glyphs}),computed:{unicode(){let e=this.icons.find((e=>e.font_class===this.type));return e?unescape(`%u${e.unicode}`):""},iconSize(){return"number"==typeof(e=this.size)||/^[0-9]*$/g.test(e)?e+"px":e;var e}},methods:{_onClick(){this.$emit("click")}}},[["render",function(t,a,n,i,o,l){return e.openBlock(),e.createElementBlock("text",{style:e.normalizeStyle({color:n.color,"font-size":l.iconSize}),class:e.normalizeClass(["uni-icons",["uniui-"+n.type,n.customPrefix,n.customPrefix?n.type:""]]),onClick:a[0]||(a[0]=(...e)=>l._onClick&&l._onClick(...e))},null,6)}],["__scopeId","data-v-7c2f6cb0"]]);function i(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}function o(e,t){return"string"==typeof e?t:e}const l=(t,a=0)=>(a,n=e.getCurrentInstance())=>{!e.isInSSRComponentSetup&&e.injectHook(t,a,n)},s=l("onShow",3),r=l("onHide",3),c=l("onLaunch",1),d=l("onLoad",2),u=l("onPullDownRefresh",2),m="/static/checked-checkbox.png",h="/static/filter.png",p=a({__name:"UserAvatar",props:{name:{type:String,default:""},avatarUrl:{type:String,default:""},avatarColor:{type:String,default:"#3b82f6"},size:{type:Number,default:40}},setup(t){const a=t,n=e.computed((()=>a.name?a.name.trim().charAt(0).toUpperCase():"?")),i=e.computed((()=>a.avatarColor?a.avatarColor:"var(--bg-input)")),o=e.computed((()=>a.avatarColor?"text-white":"text-adaptive"));return(a,l)=>(e.openBlock(),e.createElementBlock("view",{class:"rounded-full flex items-center justify-center overflow-hidden shrink-0",style:e.normalizeStyle({width:t.size+"px",height:t.size+"px",backgroundColor:i.value,borderRadius:"50%"})},[t.avatarUrl?(e.openBlock(),e.createElementBlock("image",{key:0,src:t.avatarUrl,class:"w-full h-full",mode:"aspectFill"},null,8,["src"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:e.normalizeClass(["font-bold flex items-center justify-center",o.value]),style:e.normalizeStyle({fontSize:.45*t.size+"px",lineHeight:"1",display:"flex"})},e.toDisplayString(n.value),7))],4))}},[["__scopeId","data-v-eb29fb07"]]);function g(e,t){return`${f(e)} ${_(e,t)}`}function f(e){e=D(e);const t=(e=new Date(e)).getFullYear(),a=e.getMonth()+1,n=e.getDate();return`${t}-${v(a)}-${v(n)}`}function _(e,t){e=D(e);const a=(e=new Date(e)).getHours(),n=e.getMinutes(),i=e.getSeconds();return t?`${v(a)}:${v(n)}`:`${v(a)}:${v(n)}:${v(i)}`}function v(e){return e<10&&(e=`0${e}`),e}function y(e){return e?"00:00":"00:00:00"}function k(e,t){return(e=new Date(D(e)))<=(t=new Date(D(t)))}function b(e){return e.match(/((19|20)\d{2})(-|\/)\d{1,2}(-|\/)\d{1,2}/g)}const w=/^\d{4}-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])( [0-5]?[0-9]:[0-5]?[0-9]:[0-5]?[0-9])?$/;function D(e){return"string"==typeof e&&w.test(e)&&(e=e.replace(/-/g,"/")),e}const C=a({props:{weeks:{type:Object,default:()=>({})},calendar:{type:Object,default:()=>({})},selected:{type:Array,default:()=>[]},checkHover:{type:Boolean,default:!1}},methods:{choiceDate(e){this.$emit("change",e)},handleMousemove(e){this.$emit("handleMouse",e)}}},[["render",function(t,a,n,i,o,l){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["uni-calendar-item__weeks-box",{"uni-calendar-item--disable":n.weeks.disable,"uni-calendar-item--before-checked-x":n.weeks.beforeMultiple,"uni-calendar-item--multiple":n.weeks.multiple,"uni-calendar-item--after-checked-x":n.weeks.afterMultiple}]),onClick:a[0]||(a[0]=e=>l.choiceDate(n.weeks)),onMouseenter:a[1]||(a[1]=e=>l.handleMousemove(n.weeks))},[e.createElementVNode("view",{class:e.normalizeClass(["uni-calendar-item__weeks-box-item",{"uni-calendar-item--checked":n.calendar.fullDate===n.weeks.fullDate&&(n.calendar.userChecked||!n.checkHover),"uni-calendar-item--checked-range-text":n.checkHover,"uni-calendar-item--before-checked":n.weeks.beforeMultiple,"uni-calendar-item--multiple":n.weeks.multiple,"uni-calendar-item--after-checked":n.weeks.afterMultiple,"uni-calendar-item--disable":n.weeks.disable}])},[n.selected&&n.weeks.extraInfo?(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-calendar-item__weeks-box-circle"})):e.createCommentVNode("",!0),e.createElementVNode("text",{class:"uni-calendar-item__weeks-box-text uni-calendar-item__weeks-box-text-disable uni-calendar-item--checked-text"},e.toDisplayString(n.weeks.date),1)],2),e.createElementVNode("view",{class:e.normalizeClass({"uni-calendar-item--today":n.weeks.isToday})},null,2)],34)}],["__scopeId","data-v-c408c085"]]);const S=a({name:"UniDatetimePicker",data:()=>({indicatorStyle:"height: 50px;",maskStyle:"background-image: none;",visible:!1,fixNvueBug:{},dateShow:!0,timeShow:!0,title:"日期和时间",time:"",year:1920,month:0,day:0,hour:0,minute:0,second:0,startYear:1920,startMonth:1,startDay:1,startHour:0,startMinute:0,startSecond:0,endYear:2120,endMonth:12,endDay:31,endHour:23,endMinute:59,endSecond:59}),props:{type:{type:String,default:"datetime"},value:{type:[String,Number],default:""},modelValue:{type:[String,Number],default:""},start:{type:[Number,String],default:""},end:{type:[Number,String],default:""},returnType:{type:String,default:"string"},disabled:{type:[Boolean,String],default:!1},border:{type:[Boolean,String],default:!0},hideSecond:{type:[Boolean,String],default:!1}},watch:{modelValue:{handler(e){e?(this.parseValue(D(e)),this.initTime(!1)):(this.time="",this.parseValue(Date.now()))},immediate:!0},type:{handler(e){"date"===e?(this.dateShow=!0,this.timeShow=!1,this.title="日期"):"time"===e?(this.dateShow=!1,this.timeShow=!0,this.title="时间"):(this.dateShow=!0,this.timeShow=!0,this.title="日期和时间")},immediate:!0},start:{handler(e){this.parseDatetimeRange(D(e),"start")},immediate:!0},end:{handler(e){this.parseDatetimeRange(D(e),"end")},immediate:!0},months(e){this.checkValue("month",this.month,e)},days(e){this.checkValue("day",this.day,e)},hours(e){this.checkValue("hour",this.hour,e)},minutes(e){this.checkValue("minute",this.minute,e)},seconds(e){this.checkValue("second",this.second,e)}},computed:{years(){return this.getCurrentRange("year")},months(){return this.getCurrentRange("month")},days(){return this.getCurrentRange("day")},hours(){return this.getCurrentRange("hour")},minutes(){return this.getCurrentRange("minute")},seconds(){return this.getCurrentRange("second")},ymd(){return[this.year-this.minYear,this.month-this.minMonth,this.day-this.minDay]},hms(){return[this.hour-this.minHour,this.minute-this.minMinute,this.second-this.minSecond]},currentDateIsStart(){return this.year===this.startYear&&this.month===this.startMonth&&this.day===this.startDay},currentDateIsEnd(){return this.year===this.endYear&&this.month===this.endMonth&&this.day===this.endDay},minYear(){return this.startYear},maxYear(){return this.endYear},minMonth(){return this.year===this.startYear?this.startMonth:1},maxMonth(){return this.year===this.endYear?this.endMonth:12},minDay(){return this.year===this.startYear&&this.month===this.startMonth?this.startDay:1},maxDay(){return this.year===this.endYear&&this.month===this.endMonth?this.endDay:this.daysInMonth(this.year,this.month)},minHour(){return"datetime"===this.type?this.currentDateIsStart?this.startHour:0:"time"===this.type?this.startHour:void 0},maxHour(){return"datetime"===this.type?this.currentDateIsEnd?this.endHour:23:"time"===this.type?this.endHour:void 0},minMinute(){return"datetime"===this.type?this.currentDateIsStart&&this.hour===this.startHour?this.startMinute:0:"time"===this.type?this.hour===this.startHour?this.startMinute:0:void 0},maxMinute(){return"datetime"===this.type?this.currentDateIsEnd&&this.hour===this.endHour?this.endMinute:59:"time"===this.type?this.hour===this.endHour?this.endMinute:59:void 0},minSecond(){return"datetime"===this.type?this.currentDateIsStart&&this.hour===this.startHour&&this.minute===this.startMinute?this.startSecond:0:"time"===this.type?this.hour===this.startHour&&this.minute===this.startMinute?this.startSecond:0:void 0},maxSecond(){return"datetime"===this.type?this.currentDateIsEnd&&this.hour===this.endHour&&this.minute===this.endMinute?this.endSecond:59:"time"===this.type?this.hour===this.endHour&&this.minute===this.endMinute?this.endSecond:59:void 0},selectTimeText(){return this.$t("uni-datetime-picker.selectTime")},okText(){return this.$t("uni-datetime-picker.ok")},clearText(){return this.$t("uni-datetime-picker.clear")},cancelText(){return this.$t("uni-datetime-picker.cancel")}},mounted(){},methods:{lessThanTen:e=>e<10?"0"+e:e,parseTimeType(e){if(e){let t=e.split(":");this.hour=Number(t[0]),this.minute=Number(t[1]),this.second=Number(t[2])}},initPickerValue(e){let t=null;e?t=this.compareValueWithStartAndEnd(e,this.start,this.end):(t=Date.now(),t=this.compareValueWithStartAndEnd(t,this.start,this.end)),this.parseValue(t)},compareValueWithStartAndEnd(e,t,a){let n=null;return e=this.superTimeStamp(e),t=this.superTimeStamp(t),a=this.superTimeStamp(a),n=t&&a?e<t?new Date(t):e>a?new Date(a):new Date(e):t&&!a?t<=e?new Date(e):new Date(t):!t&&a?e<=a?new Date(e):new Date(a):new Date(e),n},superTimeStamp(e){let t="";if("time"===this.type&&e&&"string"==typeof e){const e=new Date;t=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+" "}return Number(e)&&(e=parseInt(e),t=0),this.createTimeStamp(t+e)},parseValue(e){if(e){if("time"===this.type&&"string"==typeof e)this.parseTimeType(e);else{let t=null;t=new Date(e),"time"!==this.type&&(this.year=t.getFullYear(),this.month=t.getMonth()+1,this.day=t.getDate()),"date"!==this.type&&(this.hour=t.getHours(),this.minute=t.getMinutes(),this.second=t.getSeconds())}this.hideSecond&&(this.second=0)}},parseDatetimeRange(e,t){if(!e)return"start"===t&&(this.startYear=1920,this.startMonth=1,this.startDay=1,this.startHour=0,this.startMinute=0,this.startSecond=0),void("end"===t&&(this.endYear=2120,this.endMonth=12,this.endDay=31,this.endHour=23,this.endMinute=59,this.endSecond=59));if("time"===this.type){const a=e.split(":");this[t+"Hour"]=Number(a[0]),this[t+"Minute"]=Number(a[1]),this[t+"Second"]=Number(a[2])}else{if(!e)return void("start"===t?this.startYear=this.year-60:this.endYear=this.year+60);Number(e)&&(e=parseInt(e));const a=/[0-9]:[0-9]/;"datetime"!==this.type||"end"!==t||"string"!=typeof e||a.test(e)||(e+=" 23:59:59");const n=new Date(e);this[t+"Year"]=n.getFullYear(),this[t+"Month"]=n.getMonth()+1,this[t+"Day"]=n.getDate(),"datetime"===this.type&&(this[t+"Hour"]=n.getHours(),this[t+"Minute"]=n.getMinutes(),this[t+"Second"]=n.getSeconds())}},getCurrentRange(e){const t=[];for(let a=this["min"+this.capitalize(e)];a<=this["max"+this.capitalize(e)];a++)t.push(a);return t},capitalize:e=>e.charAt(0).toUpperCase()+e.slice(1),checkValue(e,t,a){-1===a.indexOf(t)&&(this[e]=a[0])},daysInMonth:(e,t)=>new Date(e,t,0).getDate(),fixIosDateFormat:e=>("string"==typeof e&&(e=e.replace(/-/g,"/")),e),createTimeStamp(e){if(e)return"number"==typeof e?e:(e=e.replace(/-/g,"/"),"date"===this.type&&(e+=" 00:00:00"),Date.parse(e))},createDomSting(){const e=this.year+"-"+this.lessThanTen(this.month)+"-"+this.lessThanTen(this.day);let t=this.lessThanTen(this.hour)+":"+this.lessThanTen(this.minute);return this.hideSecond||(t=t+":"+this.lessThanTen(this.second)),"date"===this.type?e:"time"===this.type?t:e+" "+t},initTime(e=!0){this.time=this.createDomSting(),e&&("timestamp"===this.returnType&&"time"!==this.type?(this.$emit("change",this.createTimeStamp(this.time)),this.$emit("input",this.createTimeStamp(this.time)),this.$emit("update:modelValue",this.createTimeStamp(this.time))):(this.$emit("change",this.time),this.$emit("input",this.time),this.$emit("update:modelValue",this.time)))},bindDateChange(e){const t=e.detail.value;this.year=this.years[t[0]],this.month=this.months[t[1]],this.day=this.days[t[2]]},bindTimeChange(e){const t=e.detail.value;this.hour=this.hours[t[0]],this.minute=this.minutes[t[1]],this.second=this.seconds[t[2]]},initTimePicker(){if(this.disabled)return;const e=D(this.time);this.initPickerValue(e),this.visible=!this.visible},tiggerTimePicker(e){this.visible=!this.visible},clearTime(){this.time="",this.$emit("change",this.time),this.$emit("input",this.time),this.$emit("update:modelValue",this.time),this.tiggerTimePicker()},setTime(){this.initTime(),this.tiggerTimePicker()}}},[["render",function(t,a,n,i,o,l){return e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker"},[e.createElementVNode("view",{onClick:a[0]||(a[0]=(...e)=>l.initTimePicker&&l.initTimePicker(...e))},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-datetime-picker-timebox-pointer",{"uni-datetime-picker-disabled":n.disabled,"uni-datetime-picker-timebox":n.border}])},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(o.time),1),o.time?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-datetime-picker-time"},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(l.selectTimeText),1)]))],2)]),!0)]),o.visible?(e.openBlock(),e.createElementBlock("view",{key:0,id:"mask",class:"uni-datetime-picker-mask",onClick:a[1]||(a[1]=(...e)=>l.tiggerTimePicker&&l.tiggerTimePicker(...e))})):e.createCommentVNode("",!0),o.visible?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["uni-datetime-picker-popup",[o.dateShow&&o.timeShow?"":"fix-nvue-height"]]),style:e.normalizeStyle(o.fixNvueBug)},[e.createElementVNode("view",{class:"uni-title"},[e.createElementVNode("text",{class:"uni-datetime-picker-text"},e.toDisplayString(l.selectTimeText),1)]),o.dateShow?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-datetime-picker__container-box"},[e.createElementVNode("picker-view",{class:"uni-datetime-picker-view","indicator-style":o.indicatorStyle,"mask-style":o.maskStyle,value:l.ymd,onChange:a[2]||(a[2]=(...e)=>l.bindDateChange&&l.bindDateChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.years,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(l.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.months,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(l.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.days,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(l.lessThanTen(t)),1)])))),128))])],40,["indicator-style","mask-style","value"]),e.createElementVNode("text",{class:"uni-datetime-picker-sign sign-left"},"-"),e.createElementVNode("text",{class:"uni-datetime-picker-sign sign-right"},"-")])):e.createCommentVNode("",!0),o.timeShow?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-datetime-picker__container-box"},[e.createElementVNode("picker-view",{class:e.normalizeClass(["uni-datetime-picker-view",[n.hideSecond?"time-hide-second":""]]),"indicator-style":o.indicatorStyle,"mask-style":o.maskStyle,value:l.hms,onChange:a[3]||(a[3]=(...e)=>l.bindTimeChange&&l.bindTimeChange(...e))},[e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.hours,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(l.lessThanTen(t)),1)])))),128))]),e.createElementVNode("picker-view-column",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.minutes,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(l.lessThanTen(t)),1)])))),128))]),n.hideSecond?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("picker-view-column",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.seconds,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-datetime-picker-item",key:a},[e.createElementVNode("text",{class:"uni-datetime-picker-item"},e.toDisplayString(l.lessThanTen(t)),1)])))),128))]))],42,["indicator-style","mask-style","value"]),e.createElementVNode("text",{class:e.normalizeClass(["uni-datetime-picker-sign",[n.hideSecond?"sign-center":"sign-left"]])},":",2),n.hideSecond?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:0,class:"uni-datetime-picker-sign sign-right"},":"))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-datetime-picker-btn"},[e.createElementVNode("view",{onClick:a[4]||(a[4]=(...e)=>l.clearTime&&l.clearTime(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(l.clearText),1)]),e.createElementVNode("view",{class:"uni-datetime-picker-btn-group"},[e.createElementVNode("view",{class:"uni-datetime-picker-cancel",onClick:a[5]||(a[5]=(...e)=>l.tiggerTimePicker&&l.tiggerTimePicker(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(l.cancelText),1)]),e.createElementVNode("view",{onClick:a[6]||(a[6]=(...e)=>l.setTime&&l.setTime(...e))},[e.createElementVNode("text",{class:"uni-datetime-picker-btn-text"},e.toDisplayString(l.okText),1)])])])],6)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-89df8750"]]),T=a(e.defineComponent({__name:"AppPicker",props:{range:{},value:{},title:{}},emits:["update:value","change"],setup(t,{emit:a}){const n=t,i=a,o=e.ref(!1),l=e.ref([0]),s=e.ref(0),r=e.computed((()=>n.range.length>0&&Array.isArray(n.range[0])));e.watch((()=>n.value),(e=>{Array.isArray(e)?(l.value=e,s.value=[...e]):(l.value=[e],s.value=e)}),{immediate:!0});const c=()=>{Array.isArray(n.value)?(s.value=[...n.value],l.value=[...n.value]):(s.value=n.value,l.value=[n.value]),o.value=!0},d=()=>{o.value=!1},u=e=>{const t=e.detail.value;r.value?s.value=t:s.value=t[0]},m=()=>{i("change",{detail:{value:s.value}}),i("update:value",s.value),d()};return(t,a)=>(e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("view",{onClick:c},[e.renderSlot(t.$slots,"default",{},void 0,!0)]),o.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["picker-mask",{show:o.value}]),onClick:d},null,2)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["picker-panel",{show:o.value}])},[e.createElementVNode("view",{class:"picker-toolbar"},[e.createElementVNode("text",{class:"btn-cancel",onClick:d},e.toDisplayString(t.$t("common.cancel")||"Hủy"),1),e.createElementVNode("text",{class:"title"},e.toDisplayString(t.title),1),e.createElementVNode("text",{class:"btn-confirm",onClick:m},e.toDisplayString(t.$t("common.confirm")||"Xong"),1)]),e.createElementVNode("picker-view",{value:l.value,onChange:u,class:"picker-view-box","indicator-style":"\n\t\theight: 50px; \n\t\tborder-top: 1px solid var(--border-color); \n\t\tborder-bottom: 1px solid var(--border-color);\n\t\tz-index: 0;\n\t","mask-style":"\n\t\tbackground-image: linear-gradient(to bottom, var(--bg-surface), rgba(0,0,0,0)), linear-gradient(to top, var(--bg-surface), rgba(0,0,0,0));\n\t\tz-index: 0;\n\t"},[r.value?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(t.range,((t,a)=>(e.openBlock(),e.createElementBlock("picker-view-column",{key:a},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"picker-item",key:a},e.toDisplayString(t),1)))),128))])))),128)):(e.openBlock(),e.createElementBlock("picker-view-column",{key:1},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.range,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"picker-item",key:a},e.toDisplayString(t),1)))),128))]))],40,["value"])],2)]))}}),[["__scopeId","data-v-1d6f5231"]]);const N=a({name:"UniDatetimePicker",options:{virtualHost:!0},components:{Calendar:a({components:{calendarItem:C,timePicker:S,AppPicker:T},props:{date:{type:String,default:""},defTime:{type:[String,Object],default:""},selectableTimes:{type:[Object],default:()=>({})},selected:{type:Array,default:()=>[]},startDate:{type:String,default:""},endDate:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},range:{type:Boolean,default:!1},hasTime:{type:Boolean,default:!1},insert:{type:Boolean,default:!0},showMonth:{type:Boolean,default:!0},clearDate:{type:Boolean,default:!0},checkHover:{type:Boolean,default:!0},hideSecond:{type:[Boolean],default:!1},pleStatus:{type:Object,default:()=>({before:"",after:"",data:[],fulldate:""})},defaultValue:{type:[String,Object,Array],default:""}},data:()=>({show:!1,weeks:[],pickerYears:[],calendar:{},nowDate:{},aniMaskShow:!1,firstEnter:!0,time:"",timeRange:{startTime:"",endTime:""},tempSingleDate:"",tempRange:{before:"",after:""}}),watch:{date:{immediate:!0,handler(e){this.range||(this.tempSingleDate=e,setTimeout((()=>{this.init(e)}),100))}},defTime:{immediate:!0,handler(e){this.range?(this.timeRange.startTime=e.start,this.timeRange.endTime=e.end):this.time=e}},startDate(e){this.cale&&(this.cale.setStartDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},endDate(e){this.cale&&(this.cale.setEndDate(e),this.cale.setDate(this.nowDate.fullDate),this.weeks=this.cale.weeks)},selected(e){this.cale&&(this.cale.setSelectInfo(this.nowDate.fullDate,e),this.weeks=this.cale.weeks)},pleStatus:{immediate:!0,handler(e){const{before:t,after:a,fulldate:n,which:i}=e;this.tempRange.before=t,this.tempRange.after=a,setTimeout((()=>{if(n)if(this.cale.setHoverMultiple(n),t&&a){if(this.cale.lastHover=!0,this.rangeWithinMonth(a,t))return;this.setDate(t)}else this.cale.setMultiple(n),this.setDate(this.nowDate.fullDate),this.calendar.fullDate="",this.cale.lastHover=!1;else{if(!this.cale)return;this.cale.setDefaultMultiple(t,a),"left"===i&&t?(this.setDate(t),this.weeks=this.cale.weeks):a&&(this.setDate(a),this.weeks=this.cale.weeks),this.cale.lastHover=!0}}),16)}}},computed:{timepickerStartTime(){return(this.range?this.tempRange.before:this.calendar.fullDate)===this.startDate?this.selectableTimes.start:""},timepickerEndTime(){return(this.range?this.tempRange.after:this.calendar.fullDate)===this.endDate?this.selectableTimes.end:""},selectDateText(){return this.$t("uni-datetime-picker.selectDate")},startDateText(){return this.startPlaceholder||this.$t("uni-datetime-picker.startDate")},endDateText(){return this.endPlaceholder||this.$t("uni-datetime-picker.endDate")},okText(){return this.$t("uni-datetime-picker.ok")},yearText(){return this.$t("uni-datetime-picker.year")},monthText(){return this.$t("uni-datetime-picker.month")},MONText(){return this.$t("uni-calender.MON")},TUEText(){return this.$t("uni-calender.TUE")},WEDText(){return this.$t("uni-calender.WED")},THUText(){return this.$t("uni-calender.THU")},FRIText(){return this.$t("uni-calender.FRI")},SATText(){return this.$t("uni-calender.SAT")},SUNText(){return this.$t("uni-calender.SUN")},confirmText(){return this.$t("uni-calender.confirm")},pickerMonths(){return[this.$t("uni-calender.jan"),this.$t("uni-calender.feb"),this.$t("uni-calender.mar"),this.$t("uni-calender.apr"),this.$t("uni-calender.may"),this.$t("uni-calender.jun"),this.$t("uni-calender.jul"),this.$t("uni-calender.aug"),this.$t("uni-calender.sep"),this.$t("uni-calender.oct"),this.$t("uni-calender.nov"),this.$t("uni-calender.dec")]},pickerRange(){return[this.pickerYears,this.pickerMonths]},pickerIndex(){if(!this.nowDate||!this.nowDate.year)return[0,0];const e=String(this.nowDate.year),t=this.pickerYears.indexOf(e),a=parseInt(this.nowDate.month)-1;return[t>=0?t:0,a>=0?a:0]}},created(){this.cale=new class{constructor({selected:e,startDate:t,endDate:a,range:n}={}){this.date=this.getDateObj(new Date),this.selected=e||[],this.startDate=t,this.endDate=a,this.range=n,this.cleanMultipleStatus(),this.weeks={},this.lastHover=!1}setDate(e){const t=this.getDateObj(e);this.getWeeks(t.fullDate)}cleanMultipleStatus(){this.multipleStatus={before:"",after:"",data:[]}}setStartDate(e){this.startDate=e}setEndDate(e){this.endDate=e}getPreMonthObj(e){e=D(e);const t=(e=new Date(e)).getMonth();e.setMonth(t-1);const a=e.getMonth();return 0!==t&&a-t==0&&e.setMonth(a-1),this.getDateObj(e)}getNextMonthObj(e){e=D(e);const t=(e=new Date(e)).getMonth();e.setMonth(t+1);const a=e.getMonth();return a-t>1&&e.setMonth(a-1),this.getDateObj(e)}getDateObj(e){return e=D(e),{fullDate:f(e=new Date(e)),year:e.getFullYear(),month:v(e.getMonth()+1),date:v(e.getDate()),day:e.getDay()}}getPreMonthDays(e,t){const a=[];for(let n=e-1;n>=0;n--){const e=t.month-1;a.push({date:new Date(t.year,e,-n).getDate(),month:e,disable:!0})}return a}getCurrentMonthDays(e,t){const a=[],n=this.date.fullDate;for(let i=1;i<=e;i++){const e=`${t.year}-${t.month}-${v(i)}`,o=n===e,l=this.selected&&this.selected.find((t=>{if(this.dateEqual(e,t.date))return t}));this.startDate&&k(this.startDate,e),this.endDate&&k(e,this.endDate);let s=this.multipleStatus.data,r=-1;this.range&&s&&(r=s.findIndex((t=>this.dateEqual(t,e))));const c=-1!==r;a.push({fullDate:e,year:t.year,date:i,multiple:!!this.range&&c,beforeMultiple:this.isLogicBefore(e,this.multipleStatus.before,this.multipleStatus.after),afterMultiple:this.isLogicAfter(e,this.multipleStatus.before,this.multipleStatus.after),month:t.month,disable:this.startDate&&!k(this.startDate,e)||this.endDate&&!k(e,this.endDate),isToday:o,userChecked:!1,extraInfo:l})}return a}_getNextMonthDays(e,t){const a=[],n=t.month+1;for(let i=1;i<=e;i++)a.push({date:i,month:n,disable:!0});return a}getInfo(e){return e||(e=new Date),this.calendar.find((t=>t.fullDate===this.getDateObj(e).fullDate))}dateEqual(e,t){return e=new Date(D(e)),t=new Date(D(t)),e.valueOf()===t.valueOf()}isLogicBefore(e,t,a){let n=t;return t&&a&&(n=k(t,a)?t:a),this.dateEqual(n,e)}isLogicAfter(e,t,a){let n=a;return t&&a&&(n=k(t,a)?a:t),this.dateEqual(n,e)}geDateAll(e,t){var a=[],n=e.split("-"),i=t.split("-"),o=new Date;o.setFullYear(n[0],n[1]-1,n[2]);var l=new Date;l.setFullYear(i[0],i[1]-1,i[2]);for(var s=o.getTime()-864e5,r=l.getTime()-864e5,c=s;c<=r;)c+=864e5,a.push(this.getDateObj(new Date(parseInt(c))).fullDate);return a}setMultiple(e){if(!this.range)return;let{before:t,after:a}=this.multipleStatus;if(t&&a){if(!this.lastHover)return void(this.lastHover=!0);this.multipleStatus.before=e,this.multipleStatus.after="",this.multipleStatus.data=[],this.multipleStatus.fulldate="",this.lastHover=!1}else t?(this.multipleStatus.after=e,k(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before),this.lastHover=!0):(this.multipleStatus.before=e,this.lastHover=!1);this.getWeeks(e)}setHoverMultiple(e){if(!this.range||this.lastHover)return;const{before:t}=this.multipleStatus;t?(this.multipleStatus.after=e,k(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before)):this.multipleStatus.before=e,this.getWeeks(e)}setDefaultMultiple(e,t){this.multipleStatus.before=e,this.multipleStatus.after=t,e&&t&&(k(e,t)?(this.multipleStatus.data=this.geDateAll(e,t),this.getWeeks(t)):(this.multipleStatus.data=this.geDateAll(t,e),this.getWeeks(e)))}getWeeks(e){const{year:t,month:a}=this.getDateObj(e),n=new Date(t,a-1,1).getDay(),i=this.getPreMonthDays(n,this.getDateObj(e)),o=new Date(t,a,0).getDate(),l=42-n-o,s=[...i,...this.getCurrentMonthDays(o,this.getDateObj(e)),...this._getNextMonthDays(l,this.getDateObj(e))],r=new Array(6);for(let c=0;c<s.length;c++){const e=Math.floor(c/7);r[e]||(r[e]=new Array(7)),r[e][c%7]=s[c]}this.calendar=s,this.weeks=r}}({selected:this.selected,startDate:this.startDate,endDate:this.endDate,range:this.range});const e=(new Date).getFullYear();for(let t=1900;t<=e+100;t++)this.pickerYears.push(String(t));this.init(this.date)},methods:{bindMultiPickerChange(e){const[t,a]=e.detail.value,n=a+1,i=`${this.pickerYears[t]}-${n<10?"0"+n:n}-01`;this.setDate(i),this.monthSwitch()},leaveCale(){this.firstEnter=!0},handleMouse(e){if(e.disable)return;if(this.cale.lastHover)return;let{before:t,after:a}=this.cale.multipleStatus;t&&(this.calendar=e,this.cale.setHoverMultiple(this.calendar.fullDate),this.weeks=this.cale.weeks,this.firstEnter&&(this.$emit("firstEnterCale",this.cale.multipleStatus),this.firstEnter=!1))},rangeWithinMonth(e,t){const[a,n]=e.split("-"),[i,o]=t.split("-");return a===i&&n===o},maskClick(){this.close(),this.$emit("maskClose")},clearCalender(){this.range?(this.timeRange.startTime="",this.timeRange.endTime="",this.tempRange.before="",this.tempRange.after="",this.cale.multipleStatus.before="",this.cale.multipleStatus.after="",this.cale.multipleStatus.data=[],this.cale.lastHover=!1):(this.time="",this.tempSingleDate=""),this.calendar.fullDate="",this.setDate(new Date)},bindDateChange(e){const t=e.detail.value+"-1";this.setDate(t)},init(e){if(this.cale&&(this.cale.setDate(e||new Date),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(e),this.calendar={...this.nowDate},!e&&(this.calendar.fullDate="",this.defaultValue&&!this.range))){const e=new Date(this.defaultValue),t=f(e),a=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),o=e.getDay();this.calendar={fullDate:t,year:a,month:n,date:i,day:o},this.tempSingleDate=t,this.time=_(e,this.hideSecond)}},open(){this.clearDate&&!this.insert&&this.cale.cleanMultipleStatus(),this.init(this.date),!this.range&&this.date&&(this.tempSingleDate=this.date),this.range?this.defTime&&this.defTime.start&&(this.timeRange.startTime=this.defTime.start,this.timeRange.endTime=this.defTime.end):this.defTime&&(this.time=this.defTime),this.show=!0,this.$nextTick((()=>{setTimeout((()=>{this.aniMaskShow=!0}),50)}))},close(){this.aniMaskShow=!1,this.$nextTick((()=>{setTimeout((()=>{this.show=!1,this.$emit("close")}),300)}))},confirm(){this.setEmit("confirm"),this.close()},change(){this.insert&&this.setEmit("change")},monthSwitch(){let{year:e,month:t}=this.nowDate;this.$emit("monthSwitch",{year:e,month:Number(t)})},setEmit(e){this.range||(this.calendar.fullDate||(this.calendar=this.cale.getInfo(new Date),this.tempSingleDate=this.calendar.fullDate),this.hasTime&&!this.time&&(this.time=_(new Date,this.hideSecond)));let{year:t,month:a,date:n,fullDate:i,extraInfo:o}=this.calendar;this.$emit(e,{range:this.cale.multipleStatus,year:t,month:a,date:n,time:this.time,timeRange:this.timeRange,fulldate:i,extraInfo:o||{}})},choiceDate(e){if(e.disable)return;this.calendar=e,this.calendar.userChecked=!0,this.cale.setMultiple(this.calendar.fullDate,!0),this.weeks=this.cale.weeks,this.tempSingleDate=this.calendar.fullDate;const t=new Date(this.cale.multipleStatus.before).getTime(),a=new Date(this.cale.multipleStatus.after).getTime();t>a&&a?(this.tempRange.before=this.cale.multipleStatus.after,this.tempRange.after=this.cale.multipleStatus.before):(this.tempRange.before=this.cale.multipleStatus.before,this.tempRange.after=this.cale.multipleStatus.after),this.change()},changeMonth(e){let t;"pre"===e?t=this.cale.getPreMonthObj(this.nowDate.fullDate).fullDate:"next"===e&&(t=this.cale.getNextMonthObj(this.nowDate.fullDate).fullDate),this.setDate(t),this.monthSwitch()},setDate(e){this.cale.setDate(e),this.weeks=this.cale.weeks,this.nowDate=this.cale.getInfo(e)}}},[["render",function(t,a,i,l,s,r){const c=e.resolveComponent("app-picker"),d=e.resolveComponent("calendar-item"),u=e.resolveComponent("time-picker"),m=o(e.resolveDynamicComponent("uni-icons"),n);return e.openBlock(),e.createElementBlock("view",{class:"uni-calendar",onMouseleave:a[8]||(a[8]=(...e)=>r.leaveCale&&r.leaveCale(...e))},[!i.insert&&s.show?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-calendar__mask",{"uni-calendar--mask-show":s.aniMaskShow}]),onClick:a[0]||(a[0]=(...e)=>r.maskClick&&r.maskClick(...e))},null,2)):e.createCommentVNode("",!0),i.insert||s.show?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["uni-calendar__content",{"uni-calendar--fixed":!i.insert,"uni-calendar--ani-show":s.aniMaskShow,"uni-calendar__content-mobile":s.aniMaskShow}])},[e.createElementVNode("view",{class:e.normalizeClass(["uni-calendar__header",{"uni-calendar__header-mobile":!i.insert}])},[e.createElementVNode("view",{class:"uni-calendar__header-btn-box",onClick:a[1]||(a[1]=e.withModifiers((e=>r.changeMonth("pre")),["stop"]))},[e.createElementVNode("view",{class:"uni-calendar__header-btn uni-calendar--left"})]),e.createVNode(c,{range:r.pickerRange,value:r.pickerIndex,onChange:r.bindMultiPickerChange},{default:e.withCtx((()=>[e.createElementVNode("text",{class:"uni-calendar__header-text"},e.toDisplayString(r.monthText+" "+(s.nowDate.month||"")+" "+r.yearText+" "+(s.nowDate.year||"")),1)])),_:1},8,["range","value","onChange"]),e.createElementVNode("view",{class:"uni-calendar__header-btn-box",onClick:a[2]||(a[2]=e.withModifiers((e=>r.changeMonth("next")),["stop"]))},[e.createElementVNode("view",{class:"uni-calendar__header-btn uni-calendar--right"})]),i.insert?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"dialog-close",onClick:a[3]||(a[3]=(...e)=>r.close&&r.close(...e))},[e.createElementVNode("view",{class:"dialog-close-plus","data-id":"close"}),e.createElementVNode("view",{class:"dialog-close-plus dialog-close-rotate","data-id":"close"})]))],2),e.createElementVNode("view",{class:"uni-calendar__box"},[i.showMonth?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-calendar__box-bg"},[e.createElementVNode("text",{class:"uni-calendar__box-bg-text"},e.toDisplayString(s.nowDate.month),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"uni-calendar__weeks",style:{"padding-bottom":"7px"}},[e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.SUNText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.MONText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.TUEText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.WEDText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.THUText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.FRIText),1)]),e.createElementVNode("view",{class:"uni-calendar__weeks-day"},[e.createElementVNode("text",{class:"uni-calendar__weeks-day-text"},e.toDisplayString(r.SATText),1)])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.weeks,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-calendar__weeks",key:a},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"uni-calendar__weeks-item",key:a},[e.createVNode(d,{class:"uni-calendar-item--hook",weeks:t,calendar:s.calendar,selected:i.selected,checkHover:i.range,onChange:r.choiceDate,onHandleMouse:r.handleMouse},null,8,["weeks","calendar","selected","checkHover","onChange","onHandleMouse"])])))),128))])))),128))]),i.insert||i.range||!i.hasTime?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-changed uni-calendar--fixed-top",style:{padding:"0 80px"}},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(s.tempSingleDate?s.tempSingleDate:r.selectDateText),1),e.createVNode(u,{type:"time",start:r.timepickerStartTime,end:r.timepickerEndTime,modelValue:s.time,"onUpdate:modelValue":a[4]||(a[4]=e=>s.time=e),disabled:!s.tempSingleDate,border:!1,"hide-second":i.hideSecond,class:"time-picker-style"},null,8,["start","end","modelValue","disabled","hide-second"])])),!i.insert&&i.range&&i.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-changed uni-calendar--fixed-top"},[e.createElementVNode("view",{class:"uni-date-changed--time-start"},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(s.tempRange.before?s.tempRange.before:r.startDateText),1),e.createVNode(u,{type:"time",start:r.timepickerStartTime,modelValue:s.timeRange.startTime,"onUpdate:modelValue":a[5]||(a[5]=e=>s.timeRange.startTime=e),border:!1,"hide-second":i.hideSecond,disabled:!s.tempRange.before,class:"time-picker-style"},null,8,["start","modelValue","hide-second","disabled"])]),e.createElementVNode("view",{style:{"line-height":"50px"}},[e.createVNode(m,{type:"arrowthinright",color:"#999"})]),e.createElementVNode("view",{class:"uni-date-changed--time-end"},[e.createElementVNode("view",{class:"uni-date-changed--time-date"},e.toDisplayString(s.tempRange.after?s.tempRange.after:r.endDateText),1),e.createVNode(u,{type:"time",end:r.timepickerEndTime,modelValue:s.timeRange.endTime,"onUpdate:modelValue":a[6]||(a[6]=e=>s.timeRange.endTime=e),border:!1,"hide-second":i.hideSecond,disabled:!s.tempRange.after,class:"time-picker-style"},null,8,["end","modelValue","hide-second","disabled"])])])):e.createCommentVNode("",!0),i.insert?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:2,class:"uni-date-changed uni-date-btn--ok"},[e.createElementVNode("view",{class:"uni-datetime-picker--btn",onClick:a[7]||(a[7]=(...e)=>r.confirm&&r.confirm(...e))},e.toDisplayString(r.confirmText),1)]))],2)):e.createCommentVNode("",!0)],32)}],["__scopeId","data-v-5f7b12c1"]]),TimePicker:S},data:()=>({isRange:!1,hasTime:!1,displayValue:"",inputDate:"",calendarDate:"",pickerTime:"",calendarRange:{startDate:"",startTime:"",endDate:"",endTime:""},displayRangeValue:{startDate:"",endDate:""},tempRange:{startDate:"",startTime:"",endDate:"",endTime:""},startMultipleStatus:{before:"",after:"",data:[],fulldate:""},endMultipleStatus:{before:"",after:"",data:[],fulldate:""},pickerVisible:!1,pickerPositionStyle:null,isEmitValue:!1,isPhone:!1,isFirstShow:!0}),props:{type:{type:String,default:"datetime"},value:{type:[String,Number,Array,Date],default:""},modelValue:{type:[String,Number,Array,Date],default:""},start:{type:[Number,String],default:""},end:{type:[Number,String],default:""},returnType:{type:String,default:"string"},placeholder:{type:String,default:""},startPlaceholder:{type:String,default:""},endPlaceholder:{type:String,default:""},rangeSeparator:{type:String,default:"-"},border:{type:[Boolean],default:!0},disabled:{type:[Boolean],default:!1},clearIcon:{type:[Boolean],default:!0},hideSecond:{type:[Boolean],default:!1},defaultValue:{type:[String,Object,Array],default:""}},watch:{type:{immediate:!0,handler(e){this.hasTime=-1!==e.indexOf("time"),this.isRange=-1!==e.indexOf("range")}},modelValue:{immediate:!0,handler(e){this.isEmitValue?this.isEmitValue=!1:this.initPicker(e)}},start:{immediate:!0,handler(e){e&&(this.calendarRange.startDate=f(e),this.hasTime&&(this.calendarRange.startTime=_(e)))}},end:{immediate:!0,handler(e){e&&(this.calendarRange.endDate=f(e),this.hasTime&&(this.calendarRange.endTime=_(e,this.hideSecond)))}}},computed:{timepickerStartTime(){return(this.isRange?this.tempRange.startDate:this.inputDate)===this.calendarRange.startDate?this.calendarRange.startTime:""},timepickerEndTime(){return(this.isRange?this.tempRange.endDate:this.inputDate)===this.calendarRange.endDate?this.calendarRange.endTime:""},mobileCalendarTime(){const e={start:this.tempRange.startTime,end:this.tempRange.endTime};return this.isRange?e:this.pickerTime},mobSelectableTime(){return{start:this.calendarRange.startTime,end:this.calendarRange.endTime}},datePopupWidth(){return this.isRange?653:301},singlePlaceholderText(){return this.placeholder||("date"===this.type?this.selectDateText:this.selectDateTimeText)},startPlaceholderText(){return this.startPlaceholder||this.startDateText},endPlaceholderText(){return this.endPlaceholder||this.endDateText},selectDateText(){return this.$t("uni-datetime-picker.selectDate")},selectDateTimeText(){return this.$t("uni-datetime-picker.selectDateTime")},selectTimeText(){return this.$t("uni-datetime-picker.selectTime")},startDateText(){return this.startPlaceholder||this.$t("uni-datetime-picker.startDate")},startTimeText(){return this.$t("uni-datetime-picker.startTime")},endDateText(){return this.endPlaceholder||this.$t("uni-datetime-picker.endDate")},endTimeText(){return this.$t("uni-datetime-picker.endTime")},okText(){return this.$t("uni-datetime-picker.ok")},clearText(){return this.$t("uni-datetime-picker.clear")},showClearIcon(){return this.clearIcon&&!this.disabled&&(this.displayValue||this.displayRangeValue.startDate&&this.displayRangeValue.endDate)}},created(){this.platform()},methods:{initPicker(e){if(!e&&!this.defaultValue||Array.isArray(e)&&!e.length)this.$nextTick((()=>{this.clear(!1)}));else if(Array.isArray(e)||this.isRange){const[t,a]=e;if(!t&&!a)return;const n=f(t),i=_(t,this.hideSecond),o=f(a),l=_(a,this.hideSecond),s=n,r=o;this.displayRangeValue.startDate=this.tempRange.startDate=s,this.displayRangeValue.endDate=this.tempRange.endDate=r,this.hasTime&&(this.displayRangeValue.startDate=`${n} ${i}`,this.displayRangeValue.endDate=`${o} ${l}`,this.tempRange.startTime=i,this.tempRange.endTime=l);const c={before:n,after:o};this.startMultipleStatus=Object.assign({},this.startMultipleStatus,c,{which:"right"}),this.endMultipleStatus=Object.assign({},this.endMultipleStatus,c,{which:"left"})}else e?(this.displayValue=this.inputDate=this.calendarDate=f(e),this.hasTime&&(this.pickerTime=_(e,this.hideSecond),this.displayValue=`${this.displayValue} ${this.pickerTime}`)):this.defaultValue&&(this.inputDate=this.calendarDate=f(this.defaultValue),this.hasTime&&(this.pickerTime=_(this.defaultValue,this.hideSecond)))},updateLeftCale(e){const t=this.$refs.left;t.cale.setHoverMultiple(e.after),t.setDate(this.$refs.left.nowDate.fullDate)},updateRightCale(e){const t=this.$refs.right;t.cale.setHoverMultiple(e.after),t.setDate(this.$refs.right.nowDate.fullDate)},platform(){if("undefined"!=typeof navigator)return void(this.isPhone=-1!==navigator.userAgent.toLowerCase().indexOf("mobile"));const{windowWidth:e}=uni.getSystemInfoSync();this.isPhone=e<=500,this.windowWidth=e},show(){if(this.disabled)return;if(this.platform(),this.isPhone)return void setTimeout((()=>{this.$refs.mobile.open()}),0);this.pickerPositionStyle={top:"10px"};uni.createSelectorQuery().in(this).select(".uni-date-editor").boundingClientRect((e=>{this.windowWidth-e.left<this.datePopupWidth&&(this.pickerPositionStyle.right=0)})).exec(),setTimeout((()=>{if(this.pickerVisible=!this.pickerVisible,this.pickerVisible&&(!this.isRange&&this.$refs.pcSingle?this.$refs.pcSingle.init(this.calendarDate):this.isRange&&this.$refs.left&&this.$refs.right&&(this.$refs.left.init(this.calendarRange.startDate),this.$refs.right.init(this.calendarRange.endDate))),!this.isPhone&&this.isRange&&this.isFirstShow){this.isFirstShow=!1;const{startDate:e,endDate:t}=this.calendarRange;e&&t?this.diffDate(e,t)<30&&this.$refs.right.changeMonth("pre"):(this.$refs.right.changeMonth("next"),this.isPhone&&(this.$refs.right.cale.lastHover=!1))}}),50)},close(){setTimeout((()=>{this.pickerVisible=!1,this.$emit("maskClick",this.value),this.$refs.mobile&&this.$refs.mobile.close()}),20)},setEmit(e){"timestamp"!==this.returnType&&"date"!==this.returnType||(Array.isArray(e)?(this.hasTime||(e[0]=e[0]+" 00:00:00",e[1]=e[1]+" 00:00:00"),e[0]=this.createTimestamp(e[0]),e[1]=this.createTimestamp(e[1]),"date"===this.returnType&&(e[0]=new Date(e[0]),e[1]=new Date(e[1]))):(this.hasTime||(e+=" 00:00:00"),e=this.createTimestamp(e),"date"===this.returnType&&(e=new Date(e)))),this.$emit("update:modelValue",e),this.$emit("input",e),this.$emit("change",e),this.isEmitValue=!0},createTimestamp:e=>(e=D(e),Date.parse(new Date(e))),singleChange(e){this.calendarDate=this.inputDate=e.fulldate,this.hasTime||this.confirmSingleChange()},confirmSingleChange(){if(!b(this.inputDate)){const e=new Date;this.calendarDate=this.inputDate=f(e),this.pickerTime=_(e,this.hideSecond)}let e,t,a=!1;if(this.start){let n=this.start;"number"==typeof this.start&&(n=g(this.start,this.hideSecond)),[e,t]=n.split(" "),this.start&&!k(e,this.inputDate)&&(a=!0,this.inputDate=e)}let n,i,o=!1;if(this.end){let e=this.end;"number"==typeof this.end&&(e=g(this.end,this.hideSecond)),[n,i]=e.split(" "),this.end&&!k(this.inputDate,n)&&(o=!0,this.inputDate=n)}this.hasTime?(a&&(this.pickerTime=t||y(this.hideSecond)),o&&(this.pickerTime=i||y(this.hideSecond)),this.pickerTime||(this.pickerTime=_(Date.now(),this.hideSecond)),this.displayValue=`${this.inputDate} ${this.pickerTime}`):this.displayValue=this.inputDate,this.setEmit(this.displayValue),this.pickerVisible=!1},leftChange(e){const{before:t,after:a}=e.range;this.rangeChange(t,a);const n={before:e.range.before,after:e.range.after,data:e.range.data,fulldate:e.fulldate};this.startMultipleStatus=Object.assign({},this.startMultipleStatus,n)},rightChange(e){const{before:t,after:a}=e.range;this.rangeChange(t,a);const n={before:e.range.before,after:e.range.after,data:e.range.data,fulldate:e.fulldate};this.endMultipleStatus=Object.assign({},this.endMultipleStatus,n)},mobileChange(e){if(this.isRange){const{before:t,after:a}=e.range;if(!t||!a)return;if(this.handleStartAndEnd(t,a,!0),this.hasTime){const{startTime:t,endTime:a}=e.timeRange;this.tempRange.startTime=t,this.tempRange.endTime=a}this.confirmRangeChange()}else this.calendarDate=e.fulldate,this.hasTime?(this.pickerTime=e.time,this.displayValue=e.fulldate+" "+e.time):this.displayValue=e.fulldate,this.setEmit(this.displayValue);this.$refs.mobile.close()},rangeChange(e,t){e&&t&&(this.handleStartAndEnd(e,t,!0),this.hasTime||this.confirmRangeChange())},confirmRangeChange(){if(!this.tempRange.startDate||!this.tempRange.endDate)return void(this.pickerVisible=!1);let e,t;b(this.tempRange.startDate)||(this.tempRange.startDate=f(Date.now())),b(this.tempRange.endDate)||(this.tempRange.endDate=f(Date.now()));let a,n,i=!1,o=!1;if(this.start){let e=this.start;"number"==typeof this.start&&(e=g(this.start,this.hideSecond)),[a,n]=e.split(" "),this.start&&!k(this.start,this.tempRange.startDate)&&(i=!0,this.tempRange.startDate=a),this.start&&!k(this.start,this.tempRange.endDate)&&(o=!0,this.tempRange.endDate=a)}let l,s,r=!1,c=!1;if(this.end){let e=this.end;"number"==typeof this.end&&(e=g(this.end,this.hideSecond)),[l,s]=e.split(" "),this.end&&!k(this.tempRange.startDate,this.end)&&(r=!0,this.tempRange.startDate=l),this.end&&!k(this.tempRange.endDate,this.end)&&(c=!0,this.tempRange.endDate=l)}this.hasTime?(i?this.tempRange.startTime=n||y(this.hideSecond):r&&(this.tempRange.startTime=s||y(this.hideSecond)),this.tempRange.startTime||(this.tempRange.startTime=_(Date.now(),this.hideSecond)),o?this.tempRange.endTime=n||y(this.hideSecond):c&&(this.tempRange.endTime=s||y(this.hideSecond)),this.tempRange.endTime||(this.tempRange.endTime=_(Date.now(),this.hideSecond)),e=this.displayRangeValue.startDate=`${this.tempRange.startDate} ${this.tempRange.startTime}`,t=this.displayRangeValue.endDate=`${this.tempRange.endDate} ${this.tempRange.endTime}`):(e=this.displayRangeValue.startDate=this.tempRange.startDate,t=this.displayRangeValue.endDate=this.tempRange.endDate),k(e,t)||([e,t]=[t,e]),this.displayRangeValue.startDate=e,this.displayRangeValue.endDate=t;const d=[e,t];this.setEmit(d),this.pickerVisible=!1},handleStartAndEnd(e,t,a=!1){if(!e||!t)return;const n=a?"tempRange":"range",i=k(e,t);this[n].startDate=i?e:t,this[n].endDate=i?t:e},dateCompare:(e,t)=>(e=new Date(e.replace("-","/").replace("-","/")))<=(t=new Date(t.replace("-","/").replace("-","/"))),diffDate(e,t){e=new Date(e.replace("-","/").replace("-","/"));const a=((t=new Date(t.replace("-","/").replace("-","/")))-e)/864e5;return Math.abs(a)},clear(e=!0){this.isRange?(this.displayRangeValue.startDate="",this.displayRangeValue.endDate="",this.tempRange.startDate="",this.tempRange.startTime="",this.tempRange.endDate="",this.tempRange.endTime="",this.isPhone?this.$refs.mobile&&this.$refs.mobile.clearCalender():(this.$refs.left&&this.$refs.left.clearCalender(),this.$refs.right&&this.$refs.right.clearCalender(),this.$refs.right&&this.$refs.right.changeMonth("next")),e&&(this.$emit("change",[]),this.$emit("input",[]),this.$emit("update:modelValue",[]))):(this.displayValue="",this.inputDate="",this.pickerTime="",this.isPhone?this.$refs.mobile&&this.$refs.mobile.clearCalender():this.$refs.pcSingle&&this.$refs.pcSingle.clearCalender(),e&&(this.$emit("change",""),this.$emit("input",""),this.$emit("update:modelValue","")))}}},[["render",function(t,a,i,l,s,r){const c=o(e.resolveDynamicComponent("uni-icons"),n),d=e.resolveComponent("time-picker"),u=e.resolveComponent("Calendar");return e.openBlock(),e.createElementBlock("view",{class:"uni-date"},[e.createElementVNode("view",{class:"uni-date-editor",onClick:a[1]||(a[1]=(...e)=>r.show&&r.show(...e))},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-date-editor--x",{"uni-date-editor--x__disabled":i.disabled,"uni-date-x--border":i.border}])},[s.isRange?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-x uni-date-range"},[e.createVNode(c,{class:"icon-calendar",type:"calendar",color:"#c0c4cc",size:"22"}),e.createElementVNode("view",{class:"uni-date__x-input text-center"},e.toDisplayString(s.displayRangeValue.startDate||r.startPlaceholderText),1),e.createElementVNode("view",{class:"range-separator"},e.toDisplayString(i.rangeSeparator),1),e.createElementVNode("view",{class:"uni-date__x-input text-center"},e.toDisplayString(s.displayRangeValue.endDate||r.endPlaceholderText),1)])):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-x uni-date-single"},[e.createVNode(c,{class:"icon-calendar",type:"calendar",color:"#c0c4cc",size:"22"}),e.createElementVNode("view",{class:"uni-date__x-input"},e.toDisplayString(s.displayValue||r.singlePlaceholderText),1)])),r.showClearIcon?(e.openBlock(),e.createElementBlock("view",{key:2,class:"uni-date__icon-clear",onClick:a[0]||(a[0]=e.withModifiers(((...e)=>r.clear&&r.clear(...e)),["stop"]))},[e.createVNode(c,{type:"clear",color:"#c0c4cc",size:"22"})])):e.createCommentVNode("",!0)],2)]),!0)]),e.withDirectives(e.createElementVNode("view",{class:"uni-date-mask--pc",onClick:a[2]||(a[2]=(...e)=>r.close&&r.close(...e))},null,512),[[e.vShow,s.pickerVisible]]),s.isPhone?e.createCommentVNode("",!0):e.withDirectives((e.openBlock(),e.createElementBlock("view",{key:0,ref:"datePicker",class:"uni-date-picker__container"},[s.isRange?(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-date-range--x",style:e.normalizeStyle(s.pickerPositionStyle)},[e.createElementVNode("view",{class:"uni-popper__arrow"}),s.hasTime?(e.openBlock(),e.createElementBlock("view",{key:0,class:"popup-x-header uni-date-changed"},[e.createElementVNode("view",{class:"popup-x-header--datetime"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":a[7]||(a[7]=e=>s.tempRange.startDate=e),placeholder:r.startDateText},null,8,["placeholder"]),[[e.vModelText,s.tempRange.startDate]]),e.createVNode(d,{type:"time",modelValue:s.tempRange.startTime,"onUpdate:modelValue":a[9]||(a[9]=e=>s.tempRange.startTime=e),start:r.timepickerStartTime,border:!1,disabled:!s.tempRange.startDate,hideSecond:i.hideSecond},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":a[8]||(a[8]=e=>s.tempRange.startTime=e),placeholder:r.startTimeText,disabled:!s.tempRange.startDate},null,8,["placeholder","disabled"]),[[e.vModelText,s.tempRange.startTime]])])),_:1},8,["modelValue","start","disabled","hideSecond"])]),e.createVNode(c,{type:"arrowthinright",color:"#999",style:{"line-height":"40px"}}),e.createElementVNode("view",{class:"popup-x-header--datetime"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":a[10]||(a[10]=e=>s.tempRange.endDate=e),placeholder:r.endDateText},null,8,["placeholder"]),[[e.vModelText,s.tempRange.endDate]]),e.createVNode(d,{type:"time",modelValue:s.tempRange.endTime,"onUpdate:modelValue":a[12]||(a[12]=e=>s.tempRange.endTime=e),end:r.timepickerEndTime,border:!1,disabled:!s.tempRange.endDate,hideSecond:i.hideSecond},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input uni-date-range__input",type:"text","onUpdate:modelValue":a[11]||(a[11]=e=>s.tempRange.endTime=e),placeholder:r.endTimeText,disabled:!s.tempRange.endDate},null,8,["placeholder","disabled"]),[[e.vModelText,s.tempRange.endTime]])])),_:1},8,["modelValue","end","disabled","hideSecond"])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"popup-x-body"},[e.createVNode(u,{ref:"left",showMonth:!1,"start-date":s.calendarRange.startDate,"end-date":s.calendarRange.endDate,range:!0,pleStatus:s.endMultipleStatus,onChange:r.leftChange,onFirstEnterCale:r.updateRightCale,style:{padding:"0 8px"}},null,8,["start-date","end-date","pleStatus","onChange","onFirstEnterCale"]),e.createVNode(u,{ref:"right",showMonth:!1,"start-date":s.calendarRange.startDate,"end-date":s.calendarRange.endDate,range:!0,onChange:r.rightChange,pleStatus:s.startMultipleStatus,onFirstEnterCale:r.updateLeftCale,style:{padding:"0 8px"},class:"calendar-right-border"},null,8,["start-date","end-date","onChange","pleStatus","onFirstEnterCale"])]),s.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-x-footer"},[e.createElementVNode("text",{onClick:a[13]||(a[13]=(...e)=>r.clear&&r.clear(...e))},e.toDisplayString(r.clearText),1),e.createElementVNode("text",{class:"confirm-text",onClick:a[14]||(a[14]=(...e)=>r.confirmRangeChange&&r.confirmRangeChange(...e))},e.toDisplayString(r.okText),1)])):e.createCommentVNode("",!0)],4)):(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-single--x",style:e.normalizeStyle(s.pickerPositionStyle)},[e.createElementVNode("view",{class:"uni-popper__arrow"}),s.hasTime?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-date-changed popup-x-header"},[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input text-center",type:"text","onUpdate:modelValue":a[3]||(a[3]=e=>s.inputDate=e),placeholder:r.selectDateText},null,8,["placeholder"]),[[e.vModelText,s.inputDate]]),e.createVNode(d,{type:"time",modelValue:s.pickerTime,"onUpdate:modelValue":a[5]||(a[5]=e=>s.pickerTime=e),border:!1,disabled:!s.inputDate,start:r.timepickerStartTime,end:r.timepickerEndTime,hideSecond:i.hideSecond,style:{width:"100%"}},{default:e.withCtx((()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-date__input text-center",type:"text","onUpdate:modelValue":a[4]||(a[4]=e=>s.pickerTime=e),placeholder:r.selectTimeText,disabled:!s.inputDate},null,8,["placeholder","disabled"]),[[e.vModelText,s.pickerTime]])])),_:1},8,["modelValue","disabled","start","end","hideSecond"])])):e.createCommentVNode("",!0),e.createVNode(u,{ref:"pcSingle",showMonth:!1,"start-date":s.calendarRange.startDate,"end-date":s.calendarRange.endDate,date:s.calendarDate,onChange:r.singleChange,"default-value":i.defaultValue,style:{padding:"0 8px"}},null,8,["start-date","end-date","date","onChange","default-value"]),s.hasTime?(e.openBlock(),e.createElementBlock("view",{key:1,class:"popup-x-footer"},[e.createElementVNode("text",{class:"confirm-text",onClick:a[6]||(a[6]=(...e)=>r.confirmSingleChange&&r.confirmSingleChange(...e))},e.toDisplayString(r.okText),1)])):e.createCommentVNode("",!0)],4))],512)),[[e.vShow,s.pickerVisible]]),s.isPhone?(e.openBlock(),e.createBlock(u,{key:1,ref:"mobile",clearDate:!1,date:s.calendarDate,defTime:r.mobileCalendarTime,"start-date":s.calendarRange.startDate,"end-date":s.calendarRange.endDate,selectableTimes:r.mobSelectableTime,startPlaceholder:i.startPlaceholder,endPlaceholder:i.endPlaceholder,"default-value":i.defaultValue,pleStatus:s.endMultipleStatus,showMonth:!1,range:s.isRange,hasTime:s.hasTime,insert:!1,hideSecond:i.hideSecond,onConfirm:r.mobileChange,onMaskClose:r.close},null,8,["date","defTime","start-date","end-date","selectableTimes","startPlaceholder","endPlaceholder","default-value","pleStatus","range","hasTime","hideSecond","onConfirm","onMaskClose"])):e.createCommentVNode("",!0)])}],["__scopeId","data-v-eaaf719c"]]),E=(e,t)=>{if(!e)return"";const a=Date.now()-e,n=(e,a)=>{let n="";if(t)n=t(e);else{if("common.time_just_now"===e)return"Vừa xong";"common.time_minutes_ago"===e&&(n="{n} phút trước"),"common.time_hours_ago"===e&&(n="{n} giờ trước")}return void 0!==a?n.replace("{n}",String(a)):n};if(a<6e4)return n("common.time_just_now");if(a<36e5){return n("common.time_minutes_ago",Math.floor(a/6e4))}if(a<864e5){return n("common.time_hours_ago",Math.floor(a/36e5))}const i=new Date(e);return`${i.getDate().toString().padStart(2,"0")}/${(i.getMonth()+1).toString().padStart(2,"0")}/${i.getFullYear()} ${i.getHours().toString().padStart(2,"0")}:${i.getMinutes().toString().padStart(2,"0")}`},x=e=>{if(!e)return"";try{if(e.includes("-")){const t=e.split("-");if(3===t.length){const[e,a,n]=t;return`${n}/${a}/${e}`}}return e}catch(t){return e}},V=e=>{if(!e)return null;const t=e.replace(/-/g,"/"),a=new Date(t);return isNaN(a.getTime())?null:a},$=e=>{const t=V(e);return t?(t.setHours(0,0,0,0),t.getTime()):-1},B=(e,t)=>{if(!e&&!t)return"";const a=$(e),n=(e=>{const t=V(e);return t?(t.setDate(t.getDate()+1),t.setHours(0,0,0,0),t.getTime()):-1})(t);if(-1===a&&-1===n)return"";return`${-1===a?"":a}|${-1===n?"":n}`},M=e=>{if(!e)return 0;const t=new Date(e.replace(/-/g,"/"));return isNaN(t.getTime())?0:(t.setSeconds(0),t.setMilliseconds(0),t.getTime())},I=(e,t)=>{const a=M(e),n=M(t);return!a||!n||!(n>=a)},O=e=>{if(!e||e<=0)return"";try{const t=new Date(e),a=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0"),o=t.getHours().toString().padStart(2,"0");return`${a}-${n}-${i} ${o}:${t.getMinutes().toString().padStart(2,"0")}:00`}catch{return""}},R="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,A=e=>R?Symbol(e):e,L=e=>JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),F=e=>"number"==typeof e&&isFinite(e),P=e=>"[object RegExp]"===Z(e),U=e=>ee(e)&&0===Object.keys(e).length;function z(e,t){"undefined"!=typeof console&&(console.warn("[intlify] "+e),t&&console.warn(t.stack))}const j=Object.assign;function H(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const W=Object.prototype.hasOwnProperty;function q(e,t){return W.call(e,t)}const Y=Array.isArray,G=e=>"function"==typeof e,K=e=>"string"==typeof e,J=e=>"boolean"==typeof e,Q=e=>null!==e&&"object"==typeof e,X=Object.prototype.toString,Z=e=>X.call(e),ee=e=>"[object Object]"===Z(e),te=Object.prototype.hasOwnProperty;function ae(e,t){return te.call(e,t)}const ne=e=>null!==e&&"object"==typeof e,ie=[];ie[0]={w:[0],i:[3,0],"[":[4],o:[7]},ie[1]={w:[1],".":[2],"[":[4],o:[7]},ie[2]={w:[2],i:[3,0],0:[3,0]},ie[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]},ie[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]},ie[5]={"'":[4,0],o:8,l:[5,0]},ie[6]={'"':[4,0],o:8,l:[6,0]};const oe=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function le(e){if(null==e)return"o";switch(e.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return e;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function se(e){const t=e.trim();return("0"!==e.charAt(0)||!isNaN(parseInt(e)))&&(a=t,oe.test(a)?function(e){const t=e.charCodeAt(0);return t!==e.charCodeAt(e.length-1)||34!==t&&39!==t?e:e.slice(1,-1)}(t):"*"+t);var a}const re=new Map;function ce(e,t){if(!ne(e))return null;let a=re.get(t);if(a||(a=function(e){const t=[];let a,n,i,o,l,s,r,c=-1,d=0,u=0;const m=[];function h(){const t=e[c+1];if(5===d&&"'"===t||6===d&&'"'===t)return c++,i="\\"+t,m[0](),!0}for(m[0]=()=>{void 0===n?n=i:n+=i},m[1]=()=>{void 0!==n&&(t.push(n),n=void 0)},m[2]=()=>{m[0](),u++},m[3]=()=>{if(u>0)u--,d=4,m[0]();else{if(u=0,void 0===n)return!1;if(n=se(n),!1===n)return!1;m[1]()}};null!==d;)if(c++,a=e[c],"\\"!==a||!h()){if(o=le(a),r=ie[d],l=r[o]||r.l||8,8===l)return;if(d=l[0],void 0!==l[1]&&(s=m[l[1]],s&&(i=a,!1===s())))return;if(7===d)return t}}(t),a&&re.set(t,a)),!a)return null;const n=a.length;let i=e,o=0;for(;o<n;){const e=i[a[o]];if(void 0===e)return null;i=e,o++}return i}function de(e){if(!ne(e))return e;for(const t in e)if(ae(e,t))if(t.includes(".")){const a=t.split("."),n=a.length-1;let i=e;for(let e=0;e<n;e++)a[e]in i||(i[a[e]]={}),i=i[a[e]];i[a[n]]=e[t],delete e[t],ne(i[a[n]])&&de(i[a[n]])}else ne(e[t])&&de(e[t]);return e}
/*!
    * @intlify/runtime v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */const ue=e=>e,me=e=>"",he=e=>0===e.length?"":e.join(""),pe=e=>null==e?"":Y(e)||ee(e)&&e.toString===X?JSON.stringify(e,null,2):String(e);function ge(e,t){return e=Math.abs(e),2===t?e?e>1?1:0:1:e?Math.min(e,2):0}function fe(e={}){const t=e.locale,a=function(e){const t=F(e.pluralIndex)?e.pluralIndex:-1;return e.named&&(F(e.named.count)||F(e.named.n))?F(e.named.count)?e.named.count:F(e.named.n)?e.named.n:t:t}(e),n=Q(e.pluralRules)&&K(t)&&G(e.pluralRules[t])?e.pluralRules[t]:ge,i=Q(e.pluralRules)&&K(t)&&G(e.pluralRules[t])?ge:void 0,o=e.list||[],l=e.named||{};F(e.pluralIndex)&&function(e,t){t.count||(t.count=e),t.n||(t.n=e)}(a,l);function s(t){const a=G(e.messages)?e.messages(t):!!Q(e.messages)&&e.messages[t];return a||(e.parent?e.parent.message(t):me)}const r=ee(e.processor)&&G(e.processor.normalize)?e.processor.normalize:he,c=ee(e.processor)&&G(e.processor.interpolate)?e.processor.interpolate:pe,d={list:e=>o[e],named:e=>l[e],plural:e=>e[n(a,e.length,i)],linked:(t,a)=>{const n=s(t)(d);return K(a)?(i=a,e.modifiers?e.modifiers[i]:ue)(n):n;var i},message:s,type:ee(e.processor)&&K(e.processor.type)?e.processor.type:"text",interpolate:c,normalize:r};return d}
/*!
    * @intlify/message-compiler v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */function _e(e,t,a={}){const{domain:n,messages:i,args:o}=a,l=new SyntaxError(String(e));return l.code=e,t&&(l.location=t),l.domain=n,l}
/*!
    * @intlify/core-base v9.1.9
    * (c) 2021 kazuya kawaguchi
    * Released under the MIT License.
    */let ve=0;function ye(e={}){const t=K(e.version)?e.version:"9.1.9",a=K(e.locale)?e.locale:"en-US",n=Y(e.fallbackLocale)||ee(e.fallbackLocale)||K(e.fallbackLocale)||!1===e.fallbackLocale?e.fallbackLocale:a,i=ee(e.messages)?e.messages:{[a]:{}},o=ee(e.datetimeFormats)?e.datetimeFormats:{[a]:{}},l=ee(e.numberFormats)?e.numberFormats:{[a]:{}},s=j({},e.modifiers||{},{upper:e=>K(e)?e.toUpperCase():e,lower:e=>K(e)?e.toLowerCase():e,capitalize:e=>K(e)?`${e.charAt(0).toLocaleUpperCase()}${e.substr(1)}`:e}),r=e.pluralRules||{},c=G(e.missing)?e.missing:null,d=!J(e.missingWarn)&&!P(e.missingWarn)||e.missingWarn,u=!J(e.fallbackWarn)&&!P(e.fallbackWarn)||e.fallbackWarn,m=!!e.fallbackFormat,h=!!e.unresolving,p=G(e.postTranslation)?e.postTranslation:null,g=ee(e.processor)?e.processor:null,f=!J(e.warnHtmlMessage)||e.warnHtmlMessage,_=!!e.escapeParameter,v=G(e.messageCompiler)?e.messageCompiler:undefined,y=G(e.onWarn)?e.onWarn:z,k=e,b=Q(k.__datetimeFormatters)?k.__datetimeFormatters:new Map,w=Q(k.__numberFormatters)?k.__numberFormatters:new Map,D=Q(k.__meta)?k.__meta:{};ve++;return{version:t,cid:ve,locale:a,fallbackLocale:n,messages:i,datetimeFormats:o,numberFormats:l,modifiers:s,pluralRules:r,missing:c,missingWarn:d,fallbackWarn:u,fallbackFormat:m,unresolving:h,postTranslation:p,processor:g,warnHtmlMessage:f,escapeParameter:_,messageCompiler:v,onWarn:y,__datetimeFormatters:b,__numberFormatters:w,__meta:D}}function ke(e,t,a,n,i){const{missing:o,onWarn:l}=e;if(null!==o){const n=o(e,a,t,i);return K(n)?n:t}return t}function be(e,t,a){const n=e;n.__localeChainCache||(n.__localeChainCache=new Map);let i=n.__localeChainCache.get(a);if(!i){i=[];let e=[a];for(;Y(e);)e=we(i,e,t);const o=Y(t)?t:ee(t)?t.default?t.default:null:t;e=K(o)?[o]:o,Y(e)&&we(i,e,!1),n.__localeChainCache.set(a,i)}return i}function we(e,t,a){let n=!0;for(let i=0;i<t.length&&J(n);i++){const o=t[i];K(o)&&(n=De(e,t[i],a))}return n}function De(e,t,a){let n;const i=t.split("-");do{n=Ce(e,i.join("-"),a),i.splice(-1,1)}while(i.length&&!0===n);return n}function Ce(e,t,a){let n=!1;if(!e.includes(t)&&(n=!0,t)){n="!"!==t[t.length-1];const i=t.replace(/!/g,"");e.push(i),(Y(a)||ee(a))&&a[i]&&(n=a[i])}return n}function Se(e,t,a){e.__localeChainCache=new Map,be(e,a,t)}function Te(e){return _e(e,null,void 0)}const Ne=()=>"",Ee=e=>G(e);function xe(e,...t){const{fallbackFormat:a,postTranslation:n,unresolving:i,fallbackLocale:o,messages:l}=e,[s,r]=$e(...t),c=(J(r.missingWarn)?r.missingWarn:e.missingWarn,J(r.fallbackWarn)?r.fallbackWarn:e.fallbackWarn,J(r.escapeParameter)?r.escapeParameter:e.escapeParameter),d=!!r.resolvedMessage,u=K(r.default)||J(r.default)?J(r.default)?s:r.default:a?s:"",m=a||""!==u,h=K(r.locale)?r.locale:e.locale;c&&function(e){Y(e.list)?e.list=e.list.map((e=>K(e)?H(e):e)):Q(e.named)&&Object.keys(e.named).forEach((t=>{K(e.named[t])&&(e.named[t]=H(e.named[t]))}))}(r);let[p,g,f]=d?[s,h,l[h]||{}]:function(e,t,a,n,i,o){const{messages:l,onWarn:s}=e,r=be(e,n,a);let c,d={},u=null;const m="translate";for(let h=0;h<r.length&&(c=r[h],d=l[c]||{},null===(u=ce(d,t))&&(u=d[t]),!K(u)&&!G(u));h++){const a=ke(e,t,c,0,m);a!==t&&(u=a)}return[u,c,d]}(e,s,h,o),_=s;if(d||K(p)||Ee(p)||m&&(p=u,_=p),!(d||(K(p)||Ee(p))&&K(g)))return i?-1:s;let v=!1;const y=Ee(p)?p:Ve(e,s,g,p,_,(()=>{v=!0}));if(v)return p;const k=function(e,t,a,n){const{modifiers:i,pluralRules:o}=e,l=n=>{const i=ce(a,n);if(K(i)){let a=!1;const o=Ve(e,n,t,i,n,(()=>{a=!0}));return a?Ne:o}return Ee(i)?i:Ne},s={locale:t,modifiers:i,pluralRules:o,messages:l};e.processor&&(s.processor=e.processor);n.list&&(s.list=n.list);n.named&&(s.named=n.named);F(n.plural)&&(s.pluralIndex=n.plural);return s}(e,g,f,r),b=function(e,t,a){return t(a)}(0,y,fe(k));return n?n(b):b}function Ve(e,t,a,n,i,o){const{messageCompiler:l,warnHtmlMessage:s}=e;if(Ee(n)){const e=n;return e.locale=e.locale||a,e.key=e.key||t,e}const r=l(n,function(e,t,a,n,i,o){return{warnHtmlMessage:i,onError:e=>{throw o&&o(e),e},onCacheKey:e=>((e,t,a)=>L({l:e,k:t,s:a}))(t,a,e)}}(0,a,i,0,s,o));return r.locale=a,r.key=t,r.source=n,r}function $e(...e){const[t,a,n]=e,i={};if(!K(t)&&!F(t)&&!Ee(t))throw Te(14);const o=F(t)?String(t):(Ee(t),t);return F(a)?i.plural=a:K(a)?i.default=a:ee(a)&&!U(a)?i.named=a:Y(a)&&(i.list=a),F(n)?i.plural=n:K(n)?i.default=n:ee(n)&&j(i,n),[o,i]}function Be(e,...t){const{datetimeFormats:a,unresolving:n,fallbackLocale:i,onWarn:o}=e,{__datetimeFormatters:l}=e,[s,r,c,d]=Me(...t);J(c.missingWarn)?c.missingWarn:e.missingWarn;J(c.fallbackWarn)?c.fallbackWarn:e.fallbackWarn;const u=!!c.part,m=K(c.locale)?c.locale:e.locale,h=be(e,i,m);if(!K(s)||""===s)return new Intl.DateTimeFormat(m).format(r);let p,g={},f=null;for(let y=0;y<h.length&&(p=h[y],g=a[p]||{},f=g[s],!ee(f));y++)ke(e,s,p,0,"datetime format");if(!ee(f)||!K(p))return n?-1:s;let _=`${p}__${s}`;U(d)||(_=`${_}__${JSON.stringify(d)}`);let v=l.get(_);return v||(v=new Intl.DateTimeFormat(p,j({},f,d)),l.set(_,v)),u?v.formatToParts(r):v.format(r)}function Me(...e){const[t,a,n,i]=e;let o,l={},s={};if(K(t)){if(!/\d{4}-\d{2}-\d{2}(T.*)?/.test(t))throw Te(16);o=new Date(t);try{o.toISOString()}catch(r){throw Te(16)}}else if("[object Date]"===Z(t)){if(isNaN(t.getTime()))throw Te(15);o=t}else{if(!F(t))throw Te(14);o=t}return K(a)?l.key=a:ee(a)&&(l=a),K(n)?l.locale=n:ee(n)&&(s=n),ee(i)&&(s=i),[l.key||"",o,l,s]}function Ie(e,t,a){const n=e;for(const i in a){const e=`${t}__${i}`;n.__datetimeFormatters.has(e)&&n.__datetimeFormatters.delete(e)}}function Oe(e,...t){const{numberFormats:a,unresolving:n,fallbackLocale:i,onWarn:o}=e,{__numberFormatters:l}=e,[s,r,c,d]=Re(...t);J(c.missingWarn)?c.missingWarn:e.missingWarn;J(c.fallbackWarn)?c.fallbackWarn:e.fallbackWarn;const u=!!c.part,m=K(c.locale)?c.locale:e.locale,h=be(e,i,m);if(!K(s)||""===s)return new Intl.NumberFormat(m).format(r);let p,g={},f=null;for(let y=0;y<h.length&&(p=h[y],g=a[p]||{},f=g[s],!ee(f));y++)ke(e,s,p,0,"number format");if(!ee(f)||!K(p))return n?-1:s;let _=`${p}__${s}`;U(d)||(_=`${_}__${JSON.stringify(d)}`);let v=l.get(_);return v||(v=new Intl.NumberFormat(p,j({},f,d)),l.set(_,v)),u?v.formatToParts(r):v.format(r)}function Re(...e){const[t,a,n,i]=e;let o={},l={};if(!F(t))throw Te(14);const s=t;return K(a)?o.key=a:ee(a)&&(o=a),K(n)?o.locale=n:ee(n)&&(l=n),ee(i)&&(l=i),[o.key||"",s,o,l]}function Ae(e,t,a){const n=e;for(const i in a){const e=`${t}__${i}`;n.__numberFormatters.has(e)&&n.__numberFormatters.delete(e)}}
/*!
    * vue-i18n v9.1.9
    * (c) 2022 kazuya kawaguchi
    * Released under the MIT License.
    */function Le(e,...t){return _e(e,null,void 0)}const Fe=A("__transrateVNode"),Pe=A("__datetimeParts"),Ue=A("__numberParts"),ze=A("__setPluralRules"),je=A("__injectWithOption");let He=0;function We(t){return(a,n,i,o)=>t(n,i,e.getCurrentInstance()||void 0,o)}function qe(e,t){const{messages:a,__i18n:n}=t,i=ee(a)?a:Y(n)?{}:{[e]:{}};if(Y(n)&&n.forEach((({locale:e,resource:t})=>{e?(i[e]=i[e]||{},Ge(t,i[e])):Ge(t,i)})),t.flatJson)for(const o in i)q(i,o)&&de(i[o]);return i}const Ye=e=>!Q(e)||Y(e);function Ge(e,t){if(Ye(e)||Ye(t))throw Le(20);for(const a in e)q(e,a)&&(Ye(e[a])||Ye(t[a])?t[a]=e[a]:Ge(e[a],t[a]))}function Ke(t={}){const{__root:a}=t,n=void 0===a;let i=!J(t.inheritLocale)||t.inheritLocale;const o=e.ref(a&&i?a.locale.value:K(t.locale)?t.locale:"en-US"),l=e.ref(a&&i?a.fallbackLocale.value:K(t.fallbackLocale)||Y(t.fallbackLocale)||ee(t.fallbackLocale)||!1===t.fallbackLocale?t.fallbackLocale:o.value),s=e.ref(qe(o.value,t)),r=e.ref(ee(t.datetimeFormats)?t.datetimeFormats:{[o.value]:{}}),c=e.ref(ee(t.numberFormats)?t.numberFormats:{[o.value]:{}});let d=a?a.missingWarn:!J(t.missingWarn)&&!P(t.missingWarn)||t.missingWarn,u=a?a.fallbackWarn:!J(t.fallbackWarn)&&!P(t.fallbackWarn)||t.fallbackWarn,m=a?a.fallbackRoot:!J(t.fallbackRoot)||t.fallbackRoot,h=!!t.fallbackFormat,p=G(t.missing)?t.missing:null,g=G(t.missing)?We(t.missing):null,f=G(t.postTranslation)?t.postTranslation:null,_=!J(t.warnHtmlMessage)||t.warnHtmlMessage,v=!!t.escapeParameter;const y=a?a.modifiers:ee(t.modifiers)?t.modifiers:{};let k,b=t.pluralRules||a&&a.pluralRules;k=ye({version:"9.1.9",locale:o.value,fallbackLocale:l.value,messages:s.value,messageCompiler:function(e){return t=>t.normalize([e])},datetimeFormats:r.value,numberFormats:c.value,modifiers:y,pluralRules:b,missing:null===g?void 0:g,missingWarn:d,fallbackWarn:u,fallbackFormat:h,unresolving:!0,postTranslation:null===f?void 0:f,warnHtmlMessage:_,escapeParameter:v,__datetimeFormatters:ee(k)?k.__datetimeFormatters:void 0,__numberFormatters:ee(k)?k.__numberFormatters:void 0,__v_emitter:ee(k)?k.__v_emitter:void 0,__meta:{framework:"vue"}}),Se(k,o.value,l.value);const w=e.computed({get:()=>o.value,set:e=>{o.value=e,k.locale=o.value}}),D=e.computed({get:()=>l.value,set:e=>{l.value=e,k.fallbackLocale=l.value,Se(k,o.value,e)}}),C=e.computed((()=>s.value)),S=e.computed((()=>r.value)),T=e.computed((()=>c.value));function N(e,t,n,i,d,u){let h;if(o.value,l.value,s.value,r.value,c.value,h=e(k),F(h)&&-1===h){const[e,n]=t();return a&&m?i(a):d(e)}if(u(h))return h;throw Le(14)}function E(...e){return N((t=>xe(t,...e)),(()=>$e(...e)),0,(t=>t.t(...e)),(e=>e),(e=>K(e)))}const x={normalize:function(t){return t.map((t=>K(t)?e.createVNode(e.Text,null,t,0):t))},interpolate:e=>e,type:"vnode"};function V(e){return s.value[e]||{}}He++,a&&(e.watch(a.locale,(e=>{i&&(o.value=e,k.locale=e,Se(k,o.value,l.value))})),e.watch(a.fallbackLocale,(e=>{i&&(l.value=e,k.fallbackLocale=e,Se(k,o.value,l.value))})));return{id:He,locale:w,fallbackLocale:D,get inheritLocale(){return i},set inheritLocale(e){i=e,e&&a&&(o.value=a.locale.value,l.value=a.fallbackLocale.value,Se(k,o.value,l.value))},get availableLocales(){return Object.keys(s.value).sort()},messages:C,datetimeFormats:S,numberFormats:T,get modifiers(){return y},get pluralRules(){return b||{}},get isGlobal(){return n},get missingWarn(){return d},set missingWarn(e){d=e,k.missingWarn=d},get fallbackWarn(){return u},set fallbackWarn(e){u=e,k.fallbackWarn=u},get fallbackRoot(){return m},set fallbackRoot(e){m=e},get fallbackFormat(){return h},set fallbackFormat(e){h=e,k.fallbackFormat=h},get warnHtmlMessage(){return _},set warnHtmlMessage(e){_=e,k.warnHtmlMessage=e},get escapeParameter(){return v},set escapeParameter(e){v=e,k.escapeParameter=e},t:E,rt:function(...e){const[t,a,n]=e;if(n&&!Q(n))throw Le(15);return E(t,a,j({resolvedMessage:!0},n||{}))},d:function(...e){return N((t=>Be(t,...e)),(()=>Me(...e)),0,(t=>t.d(...e)),(()=>""),(e=>K(e)))},n:function(...e){return N((t=>Oe(t,...e)),(()=>Re(...e)),0,(t=>t.n(...e)),(()=>""),(e=>K(e)))},te:function(e,t){return null!==ce(V(K(t)?t:o.value),e)},tm:function(e){const t=function(e){let t=null;const a=be(k,l.value,o.value);for(let n=0;n<a.length;n++){const i=ce(s.value[a[n]]||{},e);if(null!=i){t=i;break}}return t}(e);return null!=t?t:a&&a.tm(e)||{}},getLocaleMessage:V,setLocaleMessage:function(e,t){s.value[e]=t,k.messages=s.value},mergeLocaleMessage:function(e,t){s.value[e]=s.value[e]||{},Ge(t,s.value[e]),k.messages=s.value},getDateTimeFormat:function(e){return r.value[e]||{}},setDateTimeFormat:function(e,t){r.value[e]=t,k.datetimeFormats=r.value,Ie(k,e,t)},mergeDateTimeFormat:function(e,t){r.value[e]=j(r.value[e]||{},t),k.datetimeFormats=r.value,Ie(k,e,t)},getNumberFormat:function(e){return c.value[e]||{}},setNumberFormat:function(e,t){c.value[e]=t,k.numberFormats=c.value,Ae(k,e,t)},mergeNumberFormat:function(e,t){c.value[e]=j(c.value[e]||{},t),k.numberFormats=c.value,Ae(k,e,t)},getPostTranslationHandler:function(){return G(f)?f:null},setPostTranslationHandler:function(e){f=e,k.postTranslation=e},getMissingHandler:function(){return p},setMissingHandler:function(e){null!==e&&(g=We(e)),p=e,k.missing=g},[Fe]:function(...t){return N((e=>{let a;const n=e;try{n.processor=x,a=xe(n,...t)}finally{n.processor=null}return a}),(()=>$e(...t)),0,(e=>e[Fe](...t)),(t=>[e.createVNode(e.Text,null,t,0)]),(e=>Y(e)))},[Ue]:function(...e){return N((t=>Oe(t,...e)),(()=>Re(...e)),0,(t=>t[Ue](...e)),(()=>[]),(e=>K(e)||Y(e)))},[Pe]:function(...e){return N((t=>Be(t,...e)),(()=>Me(...e)),0,(t=>t[Pe](...e)),(()=>[]),(e=>K(e)||Y(e)))},[ze]:function(e){b=e,k.pluralRules=b},[je]:t.__injectWithOption}}function Je(e={}){const t=Ke(function(e){const t=K(e.locale)?e.locale:"en-US",a=K(e.fallbackLocale)||Y(e.fallbackLocale)||ee(e.fallbackLocale)||!1===e.fallbackLocale?e.fallbackLocale:t,n=G(e.missing)?e.missing:void 0,i=!J(e.silentTranslationWarn)&&!P(e.silentTranslationWarn)||!e.silentTranslationWarn,o=!J(e.silentFallbackWarn)&&!P(e.silentFallbackWarn)||!e.silentFallbackWarn,l=!J(e.fallbackRoot)||e.fallbackRoot,s=!!e.formatFallbackMessages,r=ee(e.modifiers)?e.modifiers:{},c=e.pluralizationRules,d=G(e.postTranslation)?e.postTranslation:void 0,u=!K(e.warnHtmlInMessage)||"off"!==e.warnHtmlInMessage,m=!!e.escapeParameterHtml,h=!J(e.sync)||e.sync;let p=e.messages;if(ee(e.sharedMessages)){const t=e.sharedMessages;p=Object.keys(t).reduce(((e,a)=>{const n=e[a]||(e[a]={});return j(n,t[a]),e}),p||{})}const{__i18n:g,__root:f,__injectWithOption:_}=e,v=e.datetimeFormats,y=e.numberFormats;return{locale:t,fallbackLocale:a,messages:p,flatJson:e.flatJson,datetimeFormats:v,numberFormats:y,missing:n,missingWarn:i,fallbackWarn:o,fallbackRoot:l,fallbackFormat:s,modifiers:r,pluralRules:c,postTranslation:d,warnHtmlMessage:u,escapeParameter:m,inheritLocale:h,__i18n:g,__root:f,__injectWithOption:_}}(e)),a={id:t.id,get locale(){return t.locale.value},set locale(e){t.locale.value=e},get fallbackLocale(){return t.fallbackLocale.value},set fallbackLocale(e){t.fallbackLocale.value=e},get messages(){return t.messages.value},get datetimeFormats(){return t.datetimeFormats.value},get numberFormats(){return t.numberFormats.value},get availableLocales(){return t.availableLocales},get formatter(){return{interpolate:()=>[]}},set formatter(e){},get missing(){return t.getMissingHandler()},set missing(e){t.setMissingHandler(e)},get silentTranslationWarn(){return J(t.missingWarn)?!t.missingWarn:t.missingWarn},set silentTranslationWarn(e){t.missingWarn=J(e)?!e:e},get silentFallbackWarn(){return J(t.fallbackWarn)?!t.fallbackWarn:t.fallbackWarn},set silentFallbackWarn(e){t.fallbackWarn=J(e)?!e:e},get modifiers(){return t.modifiers},get formatFallbackMessages(){return t.fallbackFormat},set formatFallbackMessages(e){t.fallbackFormat=e},get postTranslation(){return t.getPostTranslationHandler()},set postTranslation(e){t.setPostTranslationHandler(e)},get sync(){return t.inheritLocale},set sync(e){t.inheritLocale=e},get warnHtmlInMessage(){return t.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(e){t.warnHtmlMessage="off"!==e},get escapeParameterHtml(){return t.escapeParameter},set escapeParameterHtml(e){t.escapeParameter=e},get preserveDirectiveContent(){return!0},set preserveDirectiveContent(e){},get pluralizationRules(){return t.pluralRules||{}},__composer:t,t(...e){const[a,n,i]=e,o={};let l=null,s=null;if(!K(a))throw Le(15);const r=a;return K(n)?o.locale=n:Y(n)?l=n:ee(n)&&(s=n),Y(i)?l=i:ee(i)&&(s=i),t.t(r,l||s||{},o)},rt:(...e)=>t.rt(...e),tc(...e){const[a,n,i]=e,o={plural:1};let l=null,s=null;if(!K(a))throw Le(15);const r=a;return K(n)?o.locale=n:F(n)?o.plural=n:Y(n)?l=n:ee(n)&&(s=n),K(i)?o.locale=i:Y(i)?l=i:ee(i)&&(s=i),t.t(r,l||s||{},o)},te:(e,a)=>t.te(e,a),tm:e=>t.tm(e),getLocaleMessage:e=>t.getLocaleMessage(e),setLocaleMessage(e,a){t.setLocaleMessage(e,a)},mergeLocaleMessage(e,a){t.mergeLocaleMessage(e,a)},d:(...e)=>t.d(...e),getDateTimeFormat:e=>t.getDateTimeFormat(e),setDateTimeFormat(e,a){t.setDateTimeFormat(e,a)},mergeDateTimeFormat(e,a){t.mergeDateTimeFormat(e,a)},n:(...e)=>t.n(...e),getNumberFormat:e=>t.getNumberFormat(e),setNumberFormat(e,a){t.setNumberFormat(e,a)},mergeNumberFormat(e,a){t.mergeNumberFormat(e,a)},getChoiceIndex:(e,t)=>-1,__onComponentInstanceCreated(t){const{componentInstanceCreatedListener:n}=e;n&&n(t,a)}};return a}const Qe={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:e=>"parent"===e||"global"===e,default:"parent"},i18n:{type:Object}},Xe={name:"i18n-t",props:j({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:e=>F(e)||!isNaN(e)}},Qe),setup(t,a){const{slots:n,attrs:i}=a,o=t.i18n||lt({useScope:t.scope,__useComponent:!0}),l=Object.keys(n).filter((e=>"_"!==e));return()=>{const n={};t.locale&&(n.locale=t.locale),void 0!==t.plural&&(n.plural=K(t.plural)?+t.plural:t.plural);const s=function({slots:e},t){return 1===t.length&&"default"===t[0]?e.default?e.default():[]:t.reduce(((t,a)=>{const n=e[a];return n&&(t[a]=n()),t}),{})}(a,l),r=o[Fe](t.keypath,s,n),c=j({},i);return K(t.tag)||Q(t.tag)?e.h(t.tag,c,r):e.h(e.Fragment,c,r)}}};function Ze(t,a,n,i){const{slots:o,attrs:l}=a;return()=>{const a={part:!0};let s={};t.locale&&(a.locale=t.locale),K(t.format)?a.key=t.format:Q(t.format)&&(K(t.format.key)&&(a.key=t.format.key),s=Object.keys(t.format).reduce(((e,a)=>n.includes(a)?j({},e,{[a]:t.format[a]}):e),{}));const r=i(t.value,a,s);let c=[a.key];Y(r)?c=r.map(((e,t)=>{const a=o[e.type];return a?a({[e.type]:e.value,index:t,parts:r}):[e.value]})):K(r)&&(c=[r]);const d=j({},l);return K(t.tag)||Q(t.tag)?e.h(t.tag,d,c):e.h(e.Fragment,d,c)}}const et=["localeMatcher","style","unit","unitDisplay","currency","currencyDisplay","useGrouping","numberingSystem","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","notation","formatMatcher"],tt={name:"i18n-n",props:j({value:{type:Number,required:!0},format:{type:[String,Object]}},Qe),setup(e,t){const a=e.i18n||lt({useScope:"parent",__useComponent:!0});return Ze(e,t,et,((...e)=>a[Ue](...e)))}},at=["dateStyle","timeStyle","fractionalSecondDigits","calendar","dayPeriod","numberingSystem","localeMatcher","timeZone","hour12","hourCycle","formatMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName"],nt={name:"i18n-d",props:j({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},Qe),setup(e,t){const a=e.i18n||lt({useScope:"parent",__useComponent:!0});return Ze(e,t,at,((...e)=>a[Pe](...e)))}};function it(e){const t=(t,{instance:a,value:n,modifiers:i})=>{if(!a||!a.$)throw Le(22);const o=function(e,t){const a=e;if("composition"===e.mode)return a.__getInstance(t)||e.global;{const n=a.__getInstance(t);return null!=n?n.__composer:e.global.__composer}}(e,a.$),l=function(e){if(K(e))return{path:e};if(ee(e)){if(!("path"in e))throw Le(19);return e}throw Le(20)}(n);t.textContent=o.t(...function(e){const{path:t,locale:a,args:n,choice:i,plural:o}=e,l={},s=n||{};K(a)&&(l.locale=a);F(i)&&(l.plural=i);F(o)&&(l.plural=o);return[t,s,l]}(l))};return{beforeMount:t,beforeUpdate:t}}function ot(e,t){e.locale=t.locale||e.locale,e.fallbackLocale=t.fallbackLocale||e.fallbackLocale,e.missing=t.missing||e.missing,e.silentTranslationWarn=t.silentTranslationWarn||e.silentFallbackWarn,e.silentFallbackWarn=t.silentFallbackWarn||e.silentFallbackWarn,e.formatFallbackMessages=t.formatFallbackMessages||e.formatFallbackMessages,e.postTranslation=t.postTranslation||e.postTranslation,e.warnHtmlInMessage=t.warnHtmlInMessage||e.warnHtmlInMessage,e.escapeParameterHtml=t.escapeParameterHtml||e.escapeParameterHtml,e.sync=t.sync||e.sync,e.__composer[ze](t.pluralizationRules||e.pluralizationRules);const a=qe(e.locale,{messages:t.messages,__i18n:t.__i18n});return Object.keys(a).forEach((t=>e.mergeLocaleMessage(t,a[t]))),t.datetimeFormats&&Object.keys(t.datetimeFormats).forEach((a=>e.mergeDateTimeFormat(a,t.datetimeFormats[a]))),t.numberFormats&&Object.keys(t.numberFormats).forEach((a=>e.mergeNumberFormat(a,t.numberFormats[a]))),e}function lt(t={}){const a=e.getCurrentInstance();if(null==a)throw Le(16);if(!a.appContext.app.__VUE_I18N_SYMBOL__)throw Le(17);const n=e.inject(a.appContext.app.__VUE_I18N_SYMBOL__);if(!n)throw Le(22);const i="composition"===n.mode?n.global:n.global.__composer,o=U(t)?"__i18n"in a.type?"local":"global":t.useScope?t.useScope:"local";if("global"===o){let e=Q(t.messages)?t.messages:{};"__i18nGlobal"in a.type&&(e=qe(i.locale.value,{messages:e,__i18n:a.type.__i18nGlobal}));const n=Object.keys(e);if(n.length&&n.forEach((t=>{i.mergeLocaleMessage(t,e[t])})),Q(t.datetimeFormats)){const e=Object.keys(t.datetimeFormats);e.length&&e.forEach((e=>{i.mergeDateTimeFormat(e,t.datetimeFormats[e])}))}if(Q(t.numberFormats)){const e=Object.keys(t.numberFormats);e.length&&e.forEach((e=>{i.mergeNumberFormat(e,t.numberFormats[e])}))}return i}if("parent"===o){let e=function(e,t,a=!1){let n=null;const i=t.root;let o=t.parent;for(;null!=o;){const t=e;if("composition"===e.mode)n=t.__getInstance(o);else{const e=t.__getInstance(o);null!=e&&(n=e.__composer),a&&n&&!n[je]&&(n=null)}if(null!=n)break;if(i===o)break;o=o.parent}return n}(n,a,t.__useComponent);return null==e&&(e=i),e}if("legacy"===n.mode)throw Le(18);const l=n;let s=l.__getInstance(a);if(null==s){const n=a.type,o=j({},t);n.__i18n&&(o.__i18n=n.__i18n),i&&(o.__root=i),s=Ke(o),function(t,a,n){e.onMounted((()=>{}),a),e.onUnmounted((()=>{t.__deleteInstance(a)}),a)}(l,a),l.__setInstance(a,s)}return s}const st=["locale","fallbackLocale","availableLocales"],rt=["t","rt","d","n","tm"];const ct=a(e.defineComponent({__name:"DateRangeFilter",props:{title:{},startDate:{},endDate:{}},emits:["update:startDate","update:endDate"],setup(t,{emit:a}){const{locale:n}=lt(),i=a,l=e=>{i("update:startDate",e)},s=e=>{i("update:endDate",e)};return(t,a)=>{const i=o(e.resolveDynamicComponent("uni-datetime-picker"),N);return e.openBlock(),e.createElementBlock("view",{class:"date-filter-block"},[t.title?(e.openBlock(),e.createElementBlock("view",{key:0,class:"f-section-title"},e.toDisplayString(t.title),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"f-row"},[e.createElementVNode("view",{class:"f-group half"},[(e.openBlock(),e.createBlock(i,{key:`start-${e.unref(n)}`,type:"date",value:t.startDate,onChange:l,border:!1},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["f-picker date",{placeholder:!t.startDate}])},e.toDisplayString(t.startDate?e.unref(x)(t.startDate):t.$t("common.from_date")),3)])),_:1},8,["value"]))]),e.createElementVNode("view",{class:"f-group half"},[(e.openBlock(),e.createBlock(i,{key:`end-${e.unref(n)}`,type:"date",value:t.endDate,onChange:s,border:!1},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["f-picker date",{placeholder:!t.endDate}])},e.toDisplayString(t.endDate?e.unref(x)(t.endDate):t.$t("common.to_date")),3)])),_:1},8,["value"]))])])])}}}),[["__scopeId","data-v-ef0b2da1"]]),dt=a(e.defineComponent({__name:"CustomerModal",props:{visible:{type:Boolean},customers:{},loading:{type:Boolean},managers:{},loadingMore:{type:Boolean}},emits:["close","select","filter","loadMore"],setup(t,{emit:a}){const{t:n}=lt(),i=t,o=a,l=e.ref(!1),s=e.reactive({name:"",phone:"",managerIndex:0,selectedMemberUID:"",startDate:"",endDate:""}),r=()=>{o("loadMore")},c=e.computed((()=>[n("customer_modal.manager_default"),...(i.managers||[]).map((e=>e.UserName||n("common.unknown_member")))])),d=()=>{l.value=!l.value},u=e=>{const t=parseInt(e.detail.value);if(s.managerIndex=t,0===t)s.selectedMemberUID="";else{const e=i.managers[t-1];e&&(s.selectedMemberUID=e.memberUID)}},m=()=>{s.name="",s.phone="",s.managerIndex=0,s.selectedMemberUID="",s.startDate="",s.endDate="",g()},g=()=>{o("filter",{name:s.name,phone:s.phone,managerUID:s.selectedMemberUID,startDate:s.startDate,endDate:s.endDate}),l.value=!1},f=()=>{o("close")},_=e=>{if(!e)return"";const t=new Date(e);return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`};return(t,a)=>t.visible?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal-overlay",onClick:e.withModifiers(f,["stop"])},[e.createElementVNode("view",{class:"modal-content",onClick:a[4]||(a[4]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(t.$t("customer_modal.title")),1),e.createElementVNode("view",{class:"header-actions"},[e.createElementVNode("view",{class:e.normalizeClass(["filter-toggle-btn",{active:l.value}]),onClick:d},[e.createElementVNode("image",{src:h,class:"filter-icon-img"})],2),e.createElementVNode("text",{class:"close-btn",onClick:f},"✕")])]),l.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"filter-section"},[e.createElementVNode("view",{class:"f-item"},[e.withDirectives(e.createElementVNode("input",{class:"f-input","onUpdate:modelValue":a[0]||(a[0]=e=>s.name=e),placeholder:t.$t("customer_modal.placeholder_name"),"placeholder-class":"ph-style"},null,8,["placeholder"]),[[e.vModelText,s.name]])]),e.createElementVNode("view",{class:"f-item"},[e.withDirectives(e.createElementVNode("input",{class:"f-input","onUpdate:modelValue":a[1]||(a[1]=e=>s.phone=e),type:"number",placeholder:t.$t("customer_modal.placeholder_phone"),"placeholder-class":"ph-style"},null,8,["placeholder"]),[[e.vModelText,s.phone]])]),e.createElementVNode("view",{class:"f-item"},[e.createVNode(T,{range:c.value,value:s.managerIndex,onChange:u,title:t.$t("customer_modal.manager_default")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"f-picker-box"},[e.createElementVNode("text",{class:e.normalizeClass(0===s.managerIndex?"text-ph":"text-val")},e.toDisplayString(c.value[s.managerIndex]),3),e.createElementVNode("text",{class:"arrow"},"▼")])])),_:1},8,["range","value","title"])]),e.createElementVNode("view",{class:"f-item"},[e.createVNode(ct,{startDate:s.startDate,endDate:s.endDate,"onUpdate:startDate":a[2]||(a[2]=e=>s.startDate=e),"onUpdate:endDate":a[3]||(a[3]=e=>s.endDate=e)},null,8,["startDate","endDate"])]),e.createElementVNode("view",{class:"f-actions"},[e.createElementVNode("button",{class:"btn-reset",onClick:m},e.toDisplayString(t.$t("common.reset")),1),e.createElementVNode("button",{class:"btn-submit",onClick:g},e.toDisplayString(t.$t("common.filter")),1)])])):e.createCommentVNode("",!0),t.loading?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-state"},e.toDisplayString(t.$t("common.loading")),1)):(e.openBlock(),e.createElementBlock("scroll-view",{key:2,"scroll-y":"",class:"customer-list",onScrolltolower:r,"lower-threshold":"50"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.customers,((a,n)=>(e.openBlock(),e.createElementBlock("view",{key:a.id,class:"customer-item",onClick:e=>(e=>{o("select",e),f()})(a)},[e.createVNode(p,{name:a.name,size:40,class:"mr-3"},null,8,["name"]),e.createElementVNode("view",{class:"info-column"},[e.createElementVNode("text",{class:"name-text"},e.toDisplayString(a.name||t.$t("customer_modal.no_name")),1),e.createElementVNode("text",{class:"phone-text"},e.toDisplayString(a.phone||t.$t("customer_modal.no_phone")),1)]),e.createElementVNode("view",{class:"date-column"},[e.createElementVNode("text",{class:"date-text"},e.toDisplayString(_(a.createAt)),1)])],8,["onClick"])))),128)),t.loadingMore?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-more-container"},[e.createElementVNode("text",{class:"loading-more-text"},e.toDisplayString(t.$t("customer_modal.loading_more")),1)])):e.createCommentVNode("",!0),0===t.customers.length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},e.toDisplayString(t.$t("common.no_data")),1)):e.createCommentVNode("",!0)],32))])])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-174425d4"]]);
/*!
   * pinia v2.1.7
   * (c) 2023 Eduardo San Martin Morote
   * @license MIT
   */
let ut;const mt=e=>ut=e,ht=Symbol();function pt(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var gt,ft;(ft=gt||(gt={})).direct="direct",ft.patchObject="patch object",ft.patchFunction="patch function";const _t="undefined"!=typeof window;function vt(){const t=e.effectScope(!0),a=t.run((()=>e.ref({})));let n=[],i=[];const o=e.markRaw({install(e){mt(o),o._a=e,e.provide(ht,o),e.config.globalProperties.$pinia=o,i.forEach((e=>n.push(e))),i=[]},use(e){return this._a?n.push(e):i.push(e),this},_p:n,_a:null,_e:t,_s:new Map,state:a});return o}const yt=()=>{};function kt(t,a,n,i=yt){t.push(a);const o=()=>{const e=t.indexOf(a);e>-1&&(t.splice(e,1),i())};return!n&&e.getCurrentScope()&&e.onScopeDispose(o),o}function bt(e,...t){e.slice().forEach((e=>{e(...t)}))}const wt=e=>e();function Dt(t,a){t instanceof Map&&a instanceof Map&&a.forEach(((e,a)=>t.set(a,e))),t instanceof Set&&a instanceof Set&&a.forEach(t.add,t);for(const n in a){if(!a.hasOwnProperty(n))continue;const i=a[n],o=t[n];pt(o)&&pt(i)&&t.hasOwnProperty(n)&&!e.isRef(i)&&!e.isReactive(i)?t[n]=Dt(o,i):t[n]=i}return t}const Ct=Symbol();const{assign:St}=Object;function Tt(t,a,n={},i,o,l){let s;const r=St({actions:{}},n),c={deep:!0};let d,u,m,h=[],p=[];const g=i.state.value[t];let f;function _(a){let n;d=u=!1,"function"==typeof a?(a(i.state.value[t]),n={type:gt.patchFunction,storeId:t,events:m}):(Dt(i.state.value[t],a),n={type:gt.patchObject,payload:a,storeId:t,events:m});const o=f=Symbol();e.nextTick().then((()=>{f===o&&(d=!0)})),u=!0,bt(h,n,i.state.value[t])}l||g||(i.state.value[t]={}),e.ref({});const v=l?function(){const{state:e}=n,t=e?e():{};this.$patch((e=>{St(e,t)}))}:yt;function y(e,a){return function(){mt(i);const n=Array.from(arguments),o=[],l=[];function s(e){o.push(e)}function r(e){l.push(e)}let c;bt(p,{args:n,name:e,store:b,after:s,onError:r});try{c=a.apply(this&&this.$id===t?this:b,n)}catch(d){throw bt(l,d),d}return c instanceof Promise?c.then((e=>(bt(o,e),e))).catch((e=>(bt(l,e),Promise.reject(e)))):(bt(o,c),c)}}const k={_p:i,$id:t,$onAction:kt.bind(null,p),$patch:_,$reset:v,$subscribe(a,n={}){const o=kt(h,a,n.detached,(()=>l())),l=s.run((()=>e.watch((()=>i.state.value[t]),(e=>{("sync"===n.flush?u:d)&&a({storeId:t,type:gt.direct,events:m},e)}),St({},c,n))));return o},$dispose:function(){s.stop(),h=[],p=[],i._s.delete(t)}},b=e.reactive(k);i._s.set(t,b);const w=(i._a&&i._a.runWithContext||wt)((()=>i._e.run((()=>(s=e.effectScope()).run(a)))));for(const S in w){const a=w[S];if(e.isRef(a)&&(C=a,!e.isRef(C)||!C.effect)||e.isReactive(a))l||(!g||pt(D=a)&&D.hasOwnProperty(Ct)||(e.isRef(a)?a.value=g[S]:Dt(a,g[S])),i.state.value[t][S]=a);else if("function"==typeof a){const e=y(S,a);w[S]=e,r.actions[S]=a}}var D,C;return St(b,w),St(e.toRaw(b),w),Object.defineProperty(b,"$state",{get:()=>i.state.value[t],set:e=>{_((t=>{St(t,e)}))}}),i._p.forEach((e=>{St(b,s.run((()=>e({store:b,app:i._a,pinia:i,options:r}))))})),g&&l&&n.hydrate&&n.hydrate(b.$state,g),d=!0,u=!0,b}function Nt(t,a,n){let i,o;const l="function"==typeof a;function s(t,n){const s=e.hasInjectionContext();(t=t||(s?e.inject(ht,null):null))&&mt(t),(t=ut)._s.has(i)||(l?Tt(i,a,o,t):function(t,a,n,i){const{state:o,actions:l,getters:s}=a,r=n.state.value[t];let c;c=Tt(t,(function(){r||(n.state.value[t]=o?o():{});const a=e.toRefs(n.state.value[t]);return St(a,l,Object.keys(s||{}).reduce(((a,i)=>(a[i]=e.markRaw(e.computed((()=>{mt(n);const e=n._s.get(t);return s[i].call(e,e)}))),a)),{}))}),a,n,0,!0)}(i,o,t));return t._s.get(i)}return"string"==typeof t?(i=t,o=l?n:a):(o=t,i=t.id),s.$id=i,s}let Et="Store";function xt(e,t){return Array.isArray(t)?t.reduce(((t,a)=>(t[a]=function(){return e(this.$pinia)[a]},t)),{}):Object.keys(t).reduce(((a,n)=>(a[n]=function(){const a=e(this.$pinia),i=t[n];return"function"==typeof i?i.call(this,a):a[i]},a)),{})}const Vt=xt;const $t=Object.freeze(Object.defineProperty({__proto__:null,get MutationType(){return gt},PiniaVuePlugin:function(e){e.mixin({beforeCreate(){const e=this.$options;if(e.pinia){const t=e.pinia;if(!this._provided){const e={};Object.defineProperty(this,"_provided",{get:()=>e,set:t=>Object.assign(e,t)})}this._provided[ht]=t,this.$pinia||(this.$pinia=t),t._a=this,_t&&mt(t)}else!this.$pinia&&e.parent&&e.parent.$pinia&&(this.$pinia=e.parent.$pinia)},destroyed(){delete this._pStores}})},acceptHMRUpdate:function(e,t){return()=>{}},createPinia:vt,defineStore:Nt,getActivePinia:()=>e.hasInjectionContext()&&e.inject(ht)||ut,mapActions:function(e,t){return Array.isArray(t)?t.reduce(((t,a)=>(t[a]=function(...t){return e(this.$pinia)[a](...t)},t)),{}):Object.keys(t).reduce(((a,n)=>(a[n]=function(...a){return e(this.$pinia)[t[n]](...a)},a)),{})},mapGetters:Vt,mapState:xt,mapStores:function(...e){return e.reduce(((e,t)=>(e[t.$id+Et]=function(){return t(this.$pinia)},e)),{})},mapWritableState:function(e,t){return Array.isArray(t)?t.reduce(((t,a)=>(t[a]={get(){return e(this.$pinia)[a]},set(t){return e(this.$pinia)[a]=t}},t)),{}):Object.keys(t).reduce(((a,n)=>(a[n]={get(){return e(this.$pinia)[t[n]]},set(a){return e(this.$pinia)[t[n]]=a}},a)),{})},setActivePinia:mt,setMapStoreSuffix:function(e){Et=e},skipHydrate:function(e){return Object.defineProperty(e,Ct,{})},storeToRefs:function(t){{t=e.toRaw(t);const a={};for(const n in t){const i=t[n];(e.isRef(i)||e.isReactive(i))&&(a[n]=e.toRef(t,n))}return a}}},Symbol.toStringTag,{value:"Module"})),Bt="CALL",Mt="CUSTOMER",It="CONVERSATION",Ot="CHAT_MESSAGE",Rt="Desktop-RTC",At="TODO",Lt="",Ft="",Pt="",Ut="",zt="",jt="",Ht="072836272322",Wt="https://api-sandbox-h01.vbot.vn/v1.0",qt=`${Wt}/api/module-crm`,Yt=`${Wt}/api/project`,Gt=`${Wt}/api/module-todo/todo`,Kt=(e,t)=>{const a=ia();return oa({url:`${qt}/token`,method:"GET",data:{projectCode:e,uid:t,type:"CRM",source:Rt},header:{Authorization:`Bearer ${a.rootToken}`}}).then((e=>e.token))},Jt=()=>{const e=ia(),{rootToken:t,projectCode:a}=e;return new Promise(((e,n)=>{uni.request({url:`${Yt}/getAllMember`,method:"GET",data:{projectCode:a,status:"all"},header:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},success:t=>{const a=t.data;1===a.status&&a.data?e(a.data):n(a.message||"Lỗi lấy danh sách thành viên")},fail:e=>{n(e)}})}))},Qt=Nt("notification",{state:()=>({visible:!1,message:"",type:"info",queue:[],timeoutId:null,isAnimating:!1}),actions:{show(e,t="info",a=7e3){this.queue.push({message:e,type:t,duration:a}),this.visible||this.isAnimating||this.processQueue()},processQueue(){if(0===this.queue.length)return;const e=this.queue.shift();e&&(this.message=e.message,this.type=e.type,this.visible=!0,this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{this.hide()}),e.duration))},hide(){this.visible&&(this.visible=!1,this.isAnimating=!0,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),setTimeout((()=>{this.isAnimating=!1,this.processQueue()}),450))}}}),Xt={common:{loading:"Đang tải dữ liệu...",no_data:"Chưa có dữ liệu",all:"Tất cả",reset:"Đặt lại",apply:"Áp dụng",delete:"Xóa",confirm:"Xác nhận",cancel:"Hủy",notification:"Thông báo",success_delete:"Đã xóa thành công",fail_delete:"Xóa thất bại",error_load:"Lỗi tải dữ liệu",save:"Lưu",saving:"Đang lưu...",cancel_action:"Hủy bỏ",search:"Tìm kiếm",filter:"Lọc",me:"tôi",system:"Hệ thống",unknown_member:"Thành viên ẩn danh",error_missing_data:"Thiếu dữ liệu gốc",error_connection:"Lỗi kết nối",error_update:"Cập nhật thất bại",error_send:"Gửi thất bại",page_unit:"trang",total:"Tổng",from_date:"Từ ngày",to_date:"Đến ngày",hidden_member:"Thành viên ẩn",hidden_user:"Người dùng ẩn",open_link:"Mở",copy_link:"Sao chép",edit_link:"Chỉnh sửa",time_just_now:"Vừa xong",time_minutes_ago:"{n} phút trước",time_hours_ago:"{n} giờ trước",failed:"Thất bại",processing:"Đang xử lý...",msg_completed:"Đã hoàn thành công việc!",network_lost:"Mất kết nối Internet",network_restored:"Đã khôi phục kết nối",no_internet:"Không có kết nối Internet",no_name:"(Không tên)"},todo:{todo_detail_title:"Chi tiết công việc",attached_links:"Liên kết đính kèm",page_title:"Công việc",create_page_title:"Tạo công việc",add_task:"Thêm công việc",created_at:"Tạo",expired_at:"Hết hạn",notify_at:"Thông báo",code_prefix:"Mã công việc",filter_title:"Bộ lọc tìm kiếm",search_placeholder:"Nhập từ khóa...",search_label:"Tiêu đề / Từ khóa",job_code_placeholder:"Ví dụ: TODO-08",status:"Trạng thái",creator:"Người tạo",customer:"Khách hàng",select_customer:"Chọn khách hàng",assignee:"Người được giao",source:"Nguồn",select_source:"Chọn nguồn",time_create:"Thời gian tạo",time_expired:"Thời gian hết hạn",time_notify:"Thời gian thông báo",confirm_delete_msg:'Bạn có chắc muốn xóa công việc "{title}"?',enter_task_name:"Nhập tên công việc... *",char_count:"{current}/{max}",due_date_label:"Hạn xử lý:",notify_date_label:"Ngày thông báo:",select_date:"Chọn ngày",date_text:"Ngày",time_text:"Giờ",validate_name:"Vui lòng nhập tên công việc",create_success:"Tạo thành công!",upload_processing:"Đang xử lý dữ liệu...",header_loading:"Đang tải tên công việc...",desc_section:"Mô tả",desc_placeholder:"Nhập mô tả công việc...",info_section:"Thông tin công việc",customer_section:"Thông tin khách hàng",loading_crm:"⏳ Đang tải thông tin từ CRM...",no_customer_attached:"(Công việc này chưa gắn với khách hàng nào)",customer_name_label:"Tên Khách hàng",customer_phone_label:"Số điện thoại",customer_manager_label:"Thành viên quản lý",manager_none:"(Chưa có)",comments_activities:"Bình luận và hoạt động",comment_placeholder_edit:"Đang chỉnh sửa...",comment_placeholder_reply:"Viết câu trả lời...",comment_placeholder_write:"Viết bình luận",editing_alert:"Đang chỉnh sửa bình luận của",replying_alert:"Đang trả lời bình luận của",loading_comments:"⏳ Đang tải bình luận...",no_comments:"Chưa có bình luận nào.",history_section:"Lịch sử tương tác khách hàng",loading_history:"⏳ Đang tải lịch sử...",no_history:"(Không tìm thấy dữ liệu)",reply_btn:"Trả lời",update_btn:"Cập nhật",cancel_edit_title:"Xác nhận hủy",cancel_edit_msg:"Bạn có chắc muốn hủy chỉnh sửa? Các thay đổi sẽ không được lưu.",continue_edit:"Tiếp tục sửa",cancel_reply_title:"Hủy trả lời",cancel_reply_msg:"Bạn có chắc muốn hủy trả lời? Nội dung đã nhập sẽ bị mất.",continue_reply:"Tiếp tục viết",delete_comment_title:"Xác nhận xóa",delete_comment_msg:"Bạn có chắc muốn xóa bình luận này không?",status_todo:"Chưa xử lý",status_progress:"Đang xử lý",status_done:"Hoàn thành",status_overdue:"Quá hạn",filter_activity_all:"Tất cả hoạt động",filter_activity_comment:"Bình luận",history_all:"Tất cả",history_todo:"Công việc",history_ticket:"Ticket",history_call:"Lịch sử gọi",history_customer:"Khách hàng",history_note:"Ghi chú",msg_update_success:"Cập nhật thành công",msg_update_error:"Lỗi cập nhật",msg_title_empty:"Tiêu đề không được để trống",msg_title_changed:"Đã đổi tiêu đề",msg_desc_saved:"Đã cập nhật mô tả",msg_reply_success:"Đã trả lời",msg_comment_success:"Đã gửi bình luận",msg_empty_content:"Vui lòng nhập nội dung",msg_assignee_changed:"Đã đổi người thực hiện",msg_status_changed:"Đã cập nhật trạng thái",action_comment:"đã thêm một bình luận",action_log:"đã cập nhật hoạt động",action_update:"cập nhật thông tin công việc",user_hidden:"Người dùng ẩn",unknown:"Chưa xác định",msg_deleted:"Đã xóa",msg_saved:"Đã lưu",interaction_other:"Tương tác khác",action_NEW_TODO:"đã tạo công việc",action_REOPEN_TODO:"đã mở lại công việc",action_NEW_SUB_TODO:"đã tạo việc con",action_UPDATE_TODO:"đã cập nhật công việc",action_UPLOAD_ATTACHMENT:"đã tải lên tài liệu",action_COMMENT:"thêm một bình luận",msg_notify_must_be_before_due:"Ngày thông báo phải nhỏ hơn hạn xử lý (không được trùng)!",error_load_member:"Không thể tải danh sách thành viên",quick_done_title:"Đánh dấu hoàn thành nhanh",msg_no_task_quick_done:"Không có công việc nào cần xử lý",done_action:"Hoàn thành",error_load_crm:"Lỗi tải dữ liệu CRM"},customer_modal:{title:"Chọn khách hàng",placeholder_name:"Nhập tên khách hàng",placeholder_phone:"Nhập số điện thoại",manager_default:"Thành viên quản lý",loading_more:"Đang tải thêm...",no_name:"(Không tên)",no_phone:"Không có SĐT"},editor:{placeholder:"Nhập nội dung mô tả...",link_modal_title:"Chèn Hyperlink (Text)",card_modal_title:"Chèn Thẻ Liên Kết (Web)",card_modal_desc:"Liên kết sẽ hiển thị dạng thẻ xem trước.",color_text:"Màu chữ",color_bg:"Màu nền",align_left:"Căn trái",align_center:"Căn giữa",align_right:"Căn phải",align_justify:"Căn đều",size_small:"Nhỏ",size_normal:"Bình thường",size_large:"Lớn",size_huge:"Rất lớn",img_camera:"Chụp ảnh mới",img_album:"Chọn từ thư viện"},source:{call:"Cuộc gọi",customer:"Khách hàng",conversation:"Hội thoại",message:"Tin nhắn"},uni:{showActionSheet:{cancel:"Hủy"}},"uni-datetime-picker":{selectDate:"Chọn ngày",selectTime:"Chọn giờ",selectDateTime:"Chọn ngày giờ",startDate:"Ngày bắt đầu",endDate:"Ngày kết thúc",ok:"OK",clear:"Xóa",cancel:"Hủy",year:"Năm",month:"Tháng"},"uni-calender":{confirm:"Xác nhận",SUN:"CN",MON:"T2",TUE:"T3",WED:"T4",THU:"T5",FRI:"T6",SAT:"T7",jan:"Tháng 1",feb:"Tháng 2",mar:"Tháng 3",apr:"Tháng 4",may:"Tháng 5",jun:"Tháng 6",jul:"Tháng 7",aug:"Tháng 8",sep:"Tháng 9",oct:"Tháng 10",nov:"Tháng 11",dec:"Tháng 12"},socket:{received_at:"Công việc <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b> sẽ hết hạn vào {date}. Vui lòng kiểm tra!",reassigned:"Công việc <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b> đã đổi người phụ trách: <b>{oldData}</b> ➝ <span class='highlight'>{newData}</span>",status_changed:"Công việc <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b> đã cập nhật trạng thái: <b>{oldData}</b> ➝ <span class='highlight'>{newData}</span>",task_assigned:"Bạn có công việc mới: <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b>",due_date_passed:"Công việc <span class='highlight'>{code}</span> | <b>{title}</b> ở nhóm <b>{group}</b> đã hết hạn vào {date}. Xử lý ngay!"},timeline:{HISTORY_CALL_IN:"Cuộc gọi đến",HISTORY_CALL_OUT:"Cuộc gọi đi",HISTORY_MISS_CALL:"Cuộc gọi nhỡ",NEW_TICKET:"Tạo mới ticket",REOPEN_TICKET:"Mở lại ticket",NEW_SUB_TICKET:"Tạo ticket con",UPDATE_STATUS_TICKET:"Cập nhật trạng thái ticket",UPDATE_ASSIGNEE_TICKET:"Đổi người xử lý ticket",NEW_TODO:"Tạo mới công việc",REOPEN_TODO:"Mở lại công việc",UPDATE_STATUS_TODO:"Cập nhật trạng thái công việc",UPDATE_ASSIGNEE_TODO:"Đổi người thực hiện công việc",CUSTOMER_UPDATE:"Cập nhật thông tin khách hàng",NOTE_INSERT:"Thêm ghi chú",NOTE_UPDATE:"Sửa ghi chú",NOTE_DELETE:"Xóa ghi chú"}},Zt={common:{loading:"Loading data...",no_data:"No data available",all:"All",reset:"Reset",apply:"Apply",delete:"Delete",confirm:"Confirm",cancel:"Cancel",notification:"Notification",success_delete:"Deleted successfully",fail_delete:"Delete failed",error_load:"Error loading data",save:"Save",saving:"Saving...",cancel_action:"Cancel",search:"Search",filter:"Filter",me:"me",system:"System",unknown_member:"Unknown Member",error_missing_data:"Original data missing",error_connection:"Connection error",error_update:"Update failed",error_send:"Send failed",page_unit:"page",total:"Total",from_date:"From Date",to_date:"To Date",hidden_member:"Hidden Member",hidden_user:"Hidden User",open_link:"Open",copy_link:"Copy",edit_link:"Edit",time_just_now:"Just now",time_minutes_ago:"{n} minutes ago",time_hours_ago:"{n} hours ago",failed:"Failed",processing:"Processing...",msg_completed:"Task completed!",network_lost:"Internet connection lost",network_restored:"Connection restored",no_internet:"No internet connection",no_name:"(No Name)"},todo:{todo_detail_title:"Todo Detail",attached_links:"Attached Links",page_title:"Todo",create_page_title:"Create Task",add_task:"Add Task",created_at:"Created",expired_at:"Due date",notify_at:"Notify",code_prefix:"Job Code",filter_title:"Search Filter",search_placeholder:"Enter keywords...",search_label:"Title / Keywords",job_code_placeholder:"Ex: TODO-08",status:"Status",creator:"Creator",customer:"Customer",select_customer:"Select Customer",assignee:"Assignee",source:"Source",select_source:"Select Source",time_create:"Created Time",time_expired:"Due Date Time",time_notify:"Notification Time",confirm_delete_msg:'Are you sure you want to delete "{title}"?',enter_task_name:"Enter task name... *",char_count:"{current}/{max}",due_date_label:"Due Date:",notify_date_label:"Notify Date:",select_date:"Select Date",date_text:"Date",time_text:"Time",validate_name:"Please enter task name",create_success:"Created successfully!",upload_processing:"Processing data...",header_loading:"Loading task title...",desc_section:"Description",desc_placeholder:"Enter task description...",info_section:"Task Information",customer_section:"Customer Information",loading_crm:"⏳ Loading CRM info...",no_customer_attached:"(No customer attached)",customer_name_label:"Customer name",customer_phone_label:"Phone number",customer_manager_label:"In charge",manager_none:"(None)",comments_activities:"Comments & Activities",comment_placeholder_edit:"Editing...",comment_placeholder_reply:"Write a reply...",comment_placeholder_write:"Write a comment",editing_alert:"Editing comment of",replying_alert:"Replying to comment of",loading_comments:"⏳ Loading comments...",no_comments:"No comments yet.",history_section:"Customer Interaction History",loading_history:"⏳ Loading history...",no_history:"(No data found)",reply_btn:"Reply",update_btn:"Update",cancel_edit_title:"Cancel Editing",cancel_edit_msg:"Are you sure you want to cancel? Changes will be lost.",continue_edit:"Keep Editing",cancel_reply_title:"Cancel Reply",cancel_reply_msg:"Are you sure? Draft content will be lost.",continue_reply:"Keep Writing",delete_comment_title:"Confirm Delete",delete_comment_msg:"Are you sure you want to delete this comment?",status_todo:"To Do",status_progress:"In Progress",status_done:"Done",status_overdue:"Overdue",filter_activity_all:"All Activities",filter_activity_comment:"Comments",history_all:"All",history_todo:"Tasks",history_ticket:"Tickets",history_call:"Calls",history_customer:"Customer",history_note:"Notes",msg_update_success:"Update successful",msg_update_error:"Update failed",msg_title_empty:"Title cannot be empty",msg_title_changed:"Title changed",msg_desc_saved:"Description updated",msg_reply_success:"Replied successfully",msg_comment_success:"Comment sent",msg_empty_content:"Please enter content",msg_assignee_changed:"Assignee changed",msg_status_changed:"Status updated",action_comment:"added a comment",action_log:"updated activity",action_update:"updated task info",user_hidden:"Hidden User",unknown:"Unknown",msg_deleted:"Deleted",msg_saved:"Saved",interaction_other:"Other interaction",action_NEW_TODO:"created the task",action_REOPEN_TODO:"reopened the task",action_NEW_SUB_TODO:"created a sub-task",action_UPDATE_TODO:"updated the task",action_UPLOAD_ATTACHMENT:"uploaded an attachment",action_COMMENT:"added a comment",msg_notify_must_be_before_due:"Notification time must be earlier than due date!",error_load_member:"Cannot load member list",quick_done_title:"Quick Mark Done",msg_no_task_quick_done:"No pending tasks",done_action:"Done",error_load_crm:"Failed to load CRM data"},customer_modal:{title:"Select Customer",placeholder_name:"Enter customer name",placeholder_phone:"Enter phone number",manager_default:"Manager Member",loading_more:"Loading more...",no_name:"(No Name)",no_phone:"No Phone"},editor:{placeholder:"Enter description...",link_modal_title:"Insert Hyperlink (Text)",card_modal_title:"Insert Link Card (Web)",card_modal_desc:"Link will be displayed as a preview card.",color_text:"Text Color",color_bg:"Background Color",align_left:"Align Left",align_center:"Align Center",align_right:"Align Right",align_justify:"Justify",size_small:"Small",size_normal:"Normal",size_large:"Large",size_huge:"Huge",img_camera:"Take Photo",img_album:"Choose from Album"},source:{call:"Call",customer:"Customer",conversation:"Conversation",message:"Message"},uni:{showActionSheet:{cancel:"Cancel"}},"uni-datetime-picker":{selectDate:"Select Date",selectTime:"Select Time",selectDateTime:"Select Date & Time",startDate:"Start Date",endDate:"End Date",ok:"OK",clear:"Clear",cancel:"Cancel",year:"Year",month:"Month"},"uni-calender":{confirm:"Confirm",SUN:"Sun",MON:"Mon",TUE:"Tue",WED:"Wed",THU:"Thu",FRI:"Fri",SAT:"Sat",jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"},socket:{received_at:"Task <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b> is due on {date}. Please check!",reassigned:"Task <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b> assignee changed: <b>{oldData}</b> ➝ <span class='highlight'>{newData}</span>",status_changed:"Task <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b> status updated: <b>{oldData}</b> ➝ <span class='highlight'>{newData}</span>",task_assigned:"New task assigned: <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b>",due_date_passed:"Task <span class='highlight'>{code}</span> | <b>{title}</b> in group <b>{group}</b> expired on {date}. Action required!"},timeline:{HISTORY_CALL_IN:"Incoming call",HISTORY_CALL_OUT:"Outgoing call",HISTORY_MISS_CALL:"Missed call",NEW_TICKET:"Ticket created",REOPEN_TICKET:"Ticket reopened",NEW_SUB_TICKET:"Sub-ticket created",UPDATE_STATUS_TICKET:"Ticket status updated",UPDATE_ASSIGNEE_TICKET:"Ticket assignee changed",NEW_TODO:"Task created",REOPEN_TODO:"Task reopened",UPDATE_STATUS_TODO:"Task status updated",UPDATE_ASSIGNEE_TODO:"Task assignee changed",CUSTOMER_UPDATE:"Customer info updated",NOTE_INSERT:"Note added",NOTE_UPDATE:"Note edited",NOTE_DELETE:"Note deleted"}},ea=(()=>{try{if("undefined"!=typeof plus&&plus.runtime&&plus.runtime.arguments)try{let e=plus.runtime.arguments,t=null;if("string"==typeof e?e.trim().startsWith("{")&&(t=JSON.parse(e)):"object"==typeof e&&(t=e),t&&t.language&&("en"===t.language||"vi"===t.language))return i("log","at locale/index.ts:22","🚀 [locale] Ưu tiên lấy ngôn ngữ từ Android:",t.language),uni.setStorageSync("CURRENT_LANG",t.language),t.language}catch(e){i("error","at locale/index.ts:27","Lỗi đọc language từ Android arguments:",e)}const t=uni.getStorageSync("CURRENT_LANG");if(t)return i("log","at locale/index.ts:32","💾 [locale] Lấy ngôn ngữ từ Storage:",t),t;const a=uni.getSystemInfoSync();let n=a.language?a.language.substring(0,2):"vi";return["vi","en"].includes(n)?n:"vi"}catch(e){return"vi"}})();i("log","at locale/index.ts:45","🌐 Ngôn ngữ khởi tạo i18n:",ea);const ta=function(t={}){const a=!J(t.legacy)||t.legacy,n=!!t.globalInjection,i=new Map,o=a?Je(t):Ke(t),l=A(""),s={get mode(){return a?"legacy":"composition"},async install(t,...i){t.__VUE_I18N_SYMBOL__=l,t.provide(t.__VUE_I18N_SYMBOL__,s),!a&&n&&function(t,a){const n=Object.create(null);st.forEach((t=>{const i=Object.getOwnPropertyDescriptor(a,t);if(!i)throw Le(22);const o=e.isRef(i.value)?{get:()=>i.value.value,set(e){i.value.value=e}}:{get:()=>i.get&&i.get()};Object.defineProperty(n,t,o)})),t.config.globalProperties.$i18n=n,rt.forEach((e=>{const n=Object.getOwnPropertyDescriptor(a,e);if(!n||!n.value)throw Le(22);Object.defineProperty(t.config.globalProperties,`$${e}`,n)}))}(t,s.global),function(e,t,...a){const n=ee(a[0])?a[0]:{},i=!!n.useI18nComponentName;(!J(n.globalInstall)||n.globalInstall)&&(e.component(i?"i18n":Xe.name,Xe),e.component(tt.name,tt),e.component(nt.name,nt)),e.directive("t",it(t))}(t,s,...i),a&&t.mixin(function(t,a,n){return{beforeCreate(){const i=e.getCurrentInstance();if(!i)throw Le(22);const o=this.$options;if(o.i18n){const e=o.i18n;o.__i18n&&(e.__i18n=o.__i18n),e.__root=a,this===this.$root?this.$i18n=ot(t,e):(e.__injectWithOption=!0,this.$i18n=Je(e))}else o.__i18n?this===this.$root?this.$i18n=ot(t,o):this.$i18n=Je({__i18n:o.__i18n,__injectWithOption:!0,__root:a}):this.$i18n=t;t.__onComponentInstanceCreated(this.$i18n),n.__setInstance(i,this.$i18n),this.$t=(...e)=>this.$i18n.t(...e),this.$rt=(...e)=>this.$i18n.rt(...e),this.$tc=(...e)=>this.$i18n.tc(...e),this.$te=(e,t)=>this.$i18n.te(e,t),this.$d=(...e)=>this.$i18n.d(...e),this.$n=(...e)=>this.$i18n.n(...e),this.$tm=e=>this.$i18n.tm(e)},mounted(){},beforeUnmount(){const t=e.getCurrentInstance();if(!t)throw Le(22);delete this.$t,delete this.$rt,delete this.$tc,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,n.__deleteInstance(t),delete this.$i18n}}}(o,o.__composer,s))},get global(){return o},__instances:i,__getInstance:e=>i.get(e)||null,__setInstance(e,t){i.set(e,t)},__deleteInstance(e){i.delete(e)}};return s}({locale:ea,fallbackLocale:"vi",messages:{vi:Xt,en:Zt},legacy:!1,globalInjection:!0}),aa=Nt("socket",{state:()=>({socketTask:null,isConnected:!1,isConnecting:!1,reconnectInterval:null,projectNamesCache:{},isManualClose:!1}),actions:{initWatcher(){const t=ia();e.watch((()=>t.sessionId),(e=>{e&&!this.isConnected&&(i("log","at stores/socket.ts:34","Socket: Phát hiện Session ID mới, đang kết nối..."),this.connect())}))},connect(){if(this.isConnected||this.isConnecting)return;const e=ia().sessionId;if(!e)return;this.isManualClose=!1,this.isConnecting=!0;const t=`wss://ws-sandbox-h01.vbot.vn/ws/call?session_id=${e}`;i("log","at stores/socket.ts:51","Socket: Connecting to...",t),this.socketTask=uni.connectSocket({url:t,success:()=>i("log","at stores/socket.ts:55","Socket: Init success"),fail:e=>{i("error","at stores/socket.ts:57","Socket: Init failed",e),this.isConnecting=!1}}),this.socketTask.onOpen((()=>{i("log","at stores/socket.ts:63","Socket: Connected!"),this.isConnected=!0,this.isConnecting=!1,this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=null)})),this.socketTask.onMessage((e=>{this.handleMessage(e.data)})),this.socketTask.onError((e=>{i("error","at stores/socket.ts:78","Socket Error:",e),this.isConnected=!1,this.isConnecting=!1})),this.socketTask.onClose((()=>{i("log","at stores/socket.ts:84","Socket: Closed"),this.isConnected=!1,this.isConnecting=!1,this.socketTask=null,this.isManualClose?i("log","at stores/socket.ts:96","Socket: Chủ động ngắt kết nối, không reconnect."):this.reconnectInterval||(this.reconnectInterval=setInterval((()=>{i("log","at stores/socket.ts:91","Socket: Reconnecting (Auto)..."),this.connect()}),5e3))}))},disconnect(){i("log","at stores/socket.ts:101","Socket: Đang thực hiện Cleanup..."),this.isManualClose=!0,this.reconnectInterval&&(clearInterval(this.reconnectInterval),this.reconnectInterval=null),this.socketTask&&(this.socketTask.close({}),this.socketTask=null),this.isConnected=!1,this.isConnecting=!1},async handleMessage(e){try{const t=JSON.parse(e);if("TODO"!==t.module)return;switch(i("log","at stores/socket.ts:124","Socket Received Event:",t.eventName,t),t.eventName){case"TODO_NOTIFICATION_RECEIVED_AT":await this.handleNotificationReceived(t.data);break;case"TODO_REASSIGNED":await this.handleReassigned(t.data);break;case"TODO_STATUS_CHANGED":await this.handleStatusChanged(t.data);break;case"TODO_TASK_ASSIGNED":await this.handleTaskAssigned(t.data);break;case"TODO_NOTIFICATION_DUE_DATE_PASSED":await this.handleDueDatePassed(t.data)}}catch(t){i("error","at stores/socket.ts:147","Socket: Parse message error",t)}},getNotificationContent(e,t){let a=ta.global.t(e);for(const[n,i]of Object.entries(t)){const e=new RegExp(`{${n}}`,"g");a=a.replace(e,String(i))}return a},async getGroupName(e){var t;if(!e)return"Nhóm không xác định";if(this.projectNamesCache[e])return this.projectNamesCache[e];try{const a=await(e=>{const t=ia();return new Promise(((a,n)=>{uni.request({url:`${Yt}/getByProjectCode`,method:"GET",data:{code:e},header:{Authorization:`Bearer ${t.rootToken}`,"Content-Type":"application/json"},success:e=>{const t=e.data;200===e.statusCode?a(t.data||t):n(t)},fail:e=>n(e)})}))})(e),n=(null==a?void 0:a.Name)||(null==(t=null==a?void 0:a.data)?void 0:t.Name)||e;return this.projectNamesCache[e]=n,n}catch(a){return i("error","at stores/socket.ts:175","Lỗi lấy tên nhóm:",a),e}},async handleNotificationReceived(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.received_at",{code:e.code||"N/A",title:e.title||"",group:t,date:e.dueDate||""});this.showNotificationAlert(a,"warning")},async handleReassigned(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.reassigned",{code:e.code||"N/A",title:e.title||"",group:t,oldData:e.oldData||"Unknown",newData:e.newData||"Unknown"});this.showNotificationAlert(a,"info")},async handleStatusChanged(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.status_changed",{code:e.code||"N/A",title:e.title||"",group:t,oldData:e.oldData||"Unknown",newData:e.newData||"Unknown"});this.showNotificationAlert(a,"success")},async handleTaskAssigned(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.task_assigned",{code:e.code||"N/A",title:e.title||"",group:t});this.showNotificationAlert(a,"info")},async handleDueDatePassed(e){const t=await this.getGroupName(e.projectCode),a=this.getNotificationContent("socket.due_date_passed",{code:e.code||"N/A",title:e.title||"",group:t,date:e.dueDate||""});this.showNotificationAlert(a,"error")},showNotificationAlert(e,t="info"){uni.vibrateShort({});Qt().show(e,t)}}}),na=t=>{e.isRef(ta.global.locale)?ta.global.locale.value=t:ta.global.locale=t,uni.setLocale(t),uni.setStorageSync("CURRENT_LANG",t),i("log","at utils/language.ts:13","🔀 Đã đổi ngôn ngữ sang:",t)},ia=Nt("auth",{state:()=>({rootToken:uni.getStorageSync("vbot_root_token")||"",rootLoginTime:uni.getStorageSync("vbot_root_login_time")||0,sessionId:uni.getStorageSync("vbot_session_id")||"",todoToken:uni.getStorageSync("todo_access_token")||"",crmToken:uni.getStorageSync("crm_access_token")||"",uid:uni.getStorageSync("vbot_uid")||"",projectCode:uni.getStorageSync("vbot_project_code")||"",refreshPromise:null,themeMode:uni.getStorageSync("app_theme_mode")||"auto",isActualDark:!1}),getters:{isLoggedIn:e=>!!e.todoToken&&!!e.crmToken&&!!e.sessionId,isDark:e=>e.isActualDark,isRootTokenValid:e=>{if(!e.rootToken)return!1;if(!e.rootLoginTime)return!0;return Date.now()-e.rootLoginTime<6048e5}},actions:{setAuthData(e){e.rootToken&&(this.rootToken=e.rootToken,uni.setStorageSync("vbot_root_token",e.rootToken),this.rootLoginTime=Date.now(),uni.setStorageSync("vbot_root_login_time",this.rootLoginTime)),e.sessionId&&(this.sessionId=e.sessionId,uni.setStorageSync("vbot_session_id",e.sessionId)),e.uid&&(this.uid=e.uid,uni.setStorageSync("vbot_uid",e.uid)),e.projectCode&&(this.projectCode=e.projectCode,uni.setStorageSync("vbot_project_code",e.projectCode)),e.todoToken&&(this.todoToken=e.todoToken,uni.setStorageSync("todo_access_token",e.todoToken)),e.crmToken&&(this.crmToken=e.crmToken,uni.setStorageSync("crm_access_token",e.crmToken))},applyTheme(e){if(this.themeMode=e,uni.setStorageSync("app_theme_mode",e),"dark"===e)this.isActualDark=!0;else if("light"===e)this.isActualDark=!1;else{const e=uni.getSystemInfoSync();this.isActualDark="dark"===e.osTheme||"dark"===e.hostTheme}i("log","at stores/auth.ts:76",`🎨 Theme applied: Mode=${e}, ActualDark=${this.isActualDark}`)},async initFromNative(e){if(i("log","at stores/auth.ts:79","Store: Nhận dữ liệu từ Native Android",e),e&&e.uid&&e.access_token){if(e.language&&(i("log","at stores/auth.ts:86","🌍 Native yêu cầu ngôn ngữ:",e.language),"en"!==e.language&&"vi"!==e.language||na(e.language)),e.themeMode&&this.applyTheme(e.themeMode),this.rootToken&&this.rootToken!==e.access_token){i("warn","at stores/auth.ts:95","Store: Phát hiện Token gốc thay đổi -> Đang dọn dẹp dữ liệu phiên cũ...");aa().disconnect(),this.todoToken="",this.crmToken="",this.sessionId="",uni.removeStorageSync("todo_access_token"),uni.removeStorageSync("crm_access_token"),uni.removeStorageSync("vbot_session_id")}this.setAuthData({uid:e.uid,rootToken:e.access_token,projectCode:e.projectCode,sessionId:e.session_id}),await this.fetchModuleTokens()}else i("error","at stores/auth.ts:82","Dữ liệu từ Native bị thiếu!")},async fetchModuleTokens(){try{if(!this.rootToken||!this.projectCode||!this.uid)return void i("error","at stores/auth.ts:117","Thiếu thông tin để lấy Module Token");i("log","at stores/auth.ts:121","Store: Đang lấy Token cho Todo và CRM...");const[n,o]=await Promise.all([(e=this.rootToken,t=this.projectCode,a=this.uid,new Promise(((n,i)=>{uni.request({url:`${qt}/token`,method:"GET",data:{projectCode:t,uid:a,type:At,source:Rt},header:{Authorization:`Bearer ${e}`},success:e=>{const t=e.data;t&&t.data&&t.data.token?n(t.data.token):i(t)},fail:e=>i(e)})}))),Kt(this.projectCode,this.uid)]);this.setAuthData({todoToken:n,crmToken:o}),i("log","at stores/auth.ts:133","Store: Đã lấy đủ Token (Todo & CRM).")}catch(n){throw i("error","at stores/auth.ts:135","Store: Lỗi lấy module tokens:",n),this.logout(),n}var e,t,a},async exchangeForTodoToken(){return this.refreshPromise||(this.refreshPromise=this.fetchModuleTokens().finally((()=>{this.refreshPromise=null}))),this.refreshPromise},logout(){i("log","at stores/auth.ts:151","Store: Đăng xuất...");aa().disconnect(),this.rootToken="",this.todoToken="",this.crmToken="",this.sessionId="",uni.clearStorageSync()}}}),oa=async e=>{const t=ia(),a=t.todoToken||t.rootToken,n={"Content-Type":"application/json",...e.header};return a&&(n.Authorization=`Bearer ${a}`),new Promise(((a,o)=>{uni.request({url:e.url,method:e.method||"GET",data:e.data||{},header:n,success:async n=>{const l=n.data;if(200!==n.statusCode)if(401!==n.statusCode)i("error","at utils/request.ts:66",`[API Error ${n.statusCode}]`,l),o(l);else{if(i("warn","at utils/request.ts:40",`API 401: Token hết hạn tại ${e.url}`),e._isRetry)return i("error","at utils/request.ts:43"," Refresh Token cũng thất bại -> Logout."),t.logout(),void o(l);try{await t.exchangeForTodoToken(),i("log","at utils/request.ts:51"," Đã Refresh Token -> Đang gọi lại API cũ...");const n=await oa({...e,_isRetry:!0});a(n)}catch(s){t.logout(),o(s)}}else a(l.data)},fail:e=>{i("error","at utils/request.ts:71","[Network Error]",e),o(e)}})}))},la="TO_DO",sa="IN_PROGRESS",ra="DONE",ca="OVERDUE",da={TO_DO:"Chưa xử lý",IN_PROGRESS:"Đang xử lý",DONE:"Hoàn thành",OVERDUE:"Quá hạn"},ua={TO_DO:"bg-gray",IN_PROGRESS:"bg-orange",DONE:"bg-green",OVERDUE:"bg-red"},ma={HISTORY_CALL_IN:"Cuộc gọi đến",HISTORY_CALL_OUT:"Cuộc gọi đi",HISTORY_MISS_CALL:"Cuộc gọi nhỡ",NEW_TICKET:"Tạo mới ticket",REOPEN_TICKET:"Mở lại ticket",NEW_SUB_TICKET:"Tạo ticket con",UPDATE_STATUS_TICKET:"Cập nhật trạng thái ticket",UPDATE_ASSIGNEE_TICKET:"Đổi người xử lý ticket",NEW_TODO:"Tạo mới công việc",REOPEN_TODO:"Mở lại công việc",UPDATE_STATUS_TODO:"Cập nhật trạng thái công việc",UPDATE_ASSIGNEE_TODO:"Đổi người thực hiện công việc",CUSTOMER_UPDATE:"Cập nhật thông tin khách hàng",NOTE_INSERT:"Thêm ghi chú",NOTE_UPDATE:"Sửa ghi chú",NOTE_DELETE:"Xóa ghi chú"},ha=e=>{if(!e||-1===e||0===e)return"";const t=new Date(e),a=t.getDate().toString().padStart(2,"0"),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getFullYear(),o=t.getHours().toString().padStart(2,"0"),l=t.getMinutes().toString().padStart(2,"0");return t.getSeconds().toString().padStart(2,"0"),`${a}/${n}/${i} ${o}:${l}`},pa=(e,t,a,n,i)=>{const o=e.createdTo||e.createdFrom,l=e.dueDateTo||e.dueDateFrom,s=e.notifyTo||e.notifyFrom;return{keySearch:e.title||"",code:e.jobCode||"",status:t||"",startDate:$(e.createdFrom),endDate:$(o),dueDateFrom:$(e.dueDateFrom),dueDateTo:$(l),notificationReceivedAtFrom:$(e.notifyFrom),notificationReceivedAtTo:$(s),createdBy:n||"",assigneeId:i||"",customerCode:e.customerCode||"",links:a||"",groupId:"",transId:"",pluginType:""}},ga=async e=>{const t=ia();i("log","at api/todo.ts:20","API getTodos đang dùng ProjectCode:",t.projectCode);const a=await oa({url:`${Gt}/getAll`,method:"GET",data:{projectCode:t.projectCode,pageNo:1,pageSize:15,...e}});return Array.isArray(a)?a.map((e=>(e=>{if(!e)return{};const t=e.status||la,a=e.title||"Không tên";return{...e,title:a,statusClass:ua[t]||"bg-orange",statusLabel:da[t]||t,avatarText:a.substring(0,2).toUpperCase(),createdAtFormatted:ha(e.createdAt),dueDateFormatted:ha(e.dueDate),notifyAtFormatted:ha(e.notificationReceivedAt)}})(e))):[]},fa=async e=>{const t=ia(),a=await oa({url:`${Gt}/countAll`,method:"GET",data:{projectCode:t.projectCode,...e}});return Number(a)||0},_a=e=>oa({url:`${Gt}/update`,method:"POST",data:e}),va=e=>oa({url:`${Wt}/api/module-todo/todoMessages/create`,method:"POST",data:e}),ya=(e,t)=>oa({url:`${Wt}/api/module-todo/todoMessages/getDetail`,method:"GET",data:{id:e,todoId:t}}),ka=e=>{const t=ia();return new Promise(((a,n)=>{uni.uploadFile({url:`${Wt}/api/module-todo/file/upload`,filePath:e,name:"file",header:{Authorization:`Bearer ${t.todoToken}`},success:e=>{try{const t=JSON.parse(e.data);200===t.status&&t.data?a(t.data):n(t.message||"Upload thất bại")}catch(t){n("Lỗi phân tích phản hồi từ server")}},fail:e=>{n(e)}})}))},ba=(e,t="success")=>{uni.$emit("app-toast-show",{message:e,type:t})},wa=e=>ba(e,"success"),Da=e=>ba(e,"error"),Ca=e=>ba(e,"info"),Sa=()=>uni.hideLoading(),Ta=()=>{const{t:t}=lt(),a=ia(),n=e.ref([]),o=e.ref(!1),l=e.ref(!1),s=e.ref(1),r=e.ref({}),c=e.ref(!1),d=async(e={},d=!1)=>{if(d){if(c.value||l.value)return;l.value=!0,s.value+=1}else o.value=!0,s.value=1,c.value=!1,r.value=e;try{const i=a.crmToken;if(!i)return;const m=await(u=i,oa({url:`${qt}/Customer/getAllFieldSearch`,method:"POST",data:{},header:{Authorization:`Bearer ${u}`}})),h=(e,t)=>{const a=m.find((t=>t.code===e));return a?a.id:t},p=h("create_at",-1),g=h("name",154),f=h("phone",155),_=h("member_no",156),v=d?r.value:e,y=(null==v?void 0:v.name)||"",k=(null==v?void 0:v.phone)||"",b=(null==v?void 0:v.managerUID)||"",w=B(null==v?void 0:v.startDate,null==v?void 0:v.endDate),D={page:s.value,size:15,fieldSearch:[{id:p,value:w,type:"RANGER",isSearch:!!w},{id:g,value:y,type:"CONTAIN",isSearch:!!y},{id:f,value:k,type:"CONTAIN",isSearch:!!k},{id:_,value:b,type:"EQUAL",isSearch:!!b}]},C=await((e,t)=>oa({url:`${qt}/Customer/getAll`,method:"POST",data:t,header:{Authorization:`Bearer ${e}`}}))(i,D),S=C.map((e=>{const a=e.customerFieldItems.find((e=>"name"===e.code)),n=e.customerFieldItems.find((e=>"phone"===e.code)),i=e.customerFieldItems.find((e=>"member_no"===e.code));return{id:e.id,uid:e.uid,createAt:e.createAt,name:a?a.value:t("common.no_name"),phone:n?n.value:"",code:e.code||"",managerUid:i?i.value:""}}));n.value=d?[...n.value,...S]:S,S.length<15&&(c.value=!0)}catch(m){i("error","at composables/useCustomerFilter.ts:94","Lỗi tải khách hàng:",m),Da(t("todo.error_load_crm")),d||(n.value=[])}finally{o.value=!1,l.value=!1}var u};return{customerList:n,loadingCustomer:o,loadingMore:l,fetchCustomers:d,loadMoreCustomers:()=>{d(null,!0)}}},Na=()=>{const{t:t}=lt(),a=e.ref([]),{pageNo:n,pageSize:o,totalCount:l,pageSizeOptions:r,resetPage:c,setTotal:d,changePage:m,changePageSize:h}=((t=15)=>{const a=e.ref(1),n=e.ref(t),i=e.ref(0),o=e.computed((()=>0===i.value?1:Math.ceil(i.value/n.value)));return{pageNo:a,pageSize:n,totalCount:i,pageSizeOptions:[5,10,15,20],totalPages:o,resetPage:()=>{a.value=1},setTotal:e=>{i.value=e},changePage:e=>{const t=a.value+e;return t>=1&&t<=o.value&&(a.value=t,!0)},changePageSize:e=>{n.value=e,a.value=1}}})(15),p=e.ref(!1),g=e.ref(!1);ia();const f=e.ref(!1),_=e.ref([]),v=e.ref(!1),y=e.ref(!1),k=e.ref(""),b=e.ref(!1),w=e.ref(null),D=e.computed((()=>[t("common.all"),t("todo.status_todo"),t("todo.status_progress"),t("todo.status_done"),t("todo.status_overdue")])),C=["",la,sa,ra,ca],S=e.ref(0),T=e.ref([]),N=e.computed((()=>{const e=T.value.map((e=>e.UserName||t("common.unknown_member")));return[t("common.all"),...e]})),E=e.ref(0),x=e.computed((()=>{const e=T.value.map((e=>e.UserName||t("common.hidden_member")));return[t("common.all"),...e]})),V=e.ref(0),$=e.computed((()=>[t("common.all"),t("source.call"),t("source.customer"),t("source.conversation"),t("source.message")])),B=["",Bt,Mt,It,Ot],M=e.ref(0),I=e.ref({title:"",jobCode:"",createdFrom:"",createdTo:"",dueDateFrom:"",dueDateTo:"",customerCode:"",notifyFrom:"",notifyTo:""}),O=async()=>{if(!(T.value.length>0))try{const e=await Jt();T.value=e}catch(e){i("error","at controllers/list_todo.ts:80","Lỗi lấy danh sách thành viên filter:",e)}},{customerList:R,loadingCustomer:A,loadingMore:L,fetchCustomers:F,loadMoreCustomers:P}=Ta(),U=async()=>{0===a.value.length&&(p.value=!0);try{let e="";if(E.value>0){e=T.value[E.value-1].UID||""}let t="";if(V.value>0){t=T.value[V.value-1].UID||""}const i=pa(I.value,C[S.value],B[M.value],e,t),[l,s]=await Promise.all([ga({...i,pageNo:n.value,pageSize:o.value}),fa(i)]);a.value=l||[],d(s||0)}catch(e){i("error","at controllers/list_todo.ts:265",e),Da(t("common.error_load")),0===a.value.length&&(a.value=[])}finally{p.value=!1,uni.stopPullDownRefresh()}};u((()=>{i("log","at controllers/list_todo.ts:276","Đang làm mới trang..."),c(),Promise.all([U(),F({})]).finally((()=>{uni.stopPullDownRefresh()}))}));const z=()=>{g.value=!1};s((()=>{U(),F({})}));return{todos:a,isLoading:p,isFilterOpen:g,filter:I,goToDetail:e=>{const t={id:e.id,title:e.title,code:e.code,status:e.status,dueDate:e.dueDate,notificationReceivedAt:e.notificationReceivedAt,assigneeId:e.assigneeId,links:e.links},a=encodeURIComponent(JSON.stringify(t));uni.navigateTo({url:`/pages/todo/todo_detail?id=${e.id}&preload=${a}`})},isConfirmDeleteOpen:b,itemToDelete:w,pageSizeOptions:r,statusOptions:D,statusIndex:S,onStatusChange:e=>{S.value=e.detail.value},creatorOptions:N,creatorIndex:E,onCreatorChange:e=>{E.value=e.detail.value},assigneeOptions:x,assigneeIndex:V,onAssigneeChange:e=>{V.value=e.detail.value},sourceOptions:$,sourceIndex:M,onSourceChange:e=>{M.value=e.detail.value},addNewTask:()=>{uni.navigateTo({url:"/pages/todo/create_todo"})},openFilter:()=>{g.value=!0,O()},closeFilter:z,resetFilter:()=>{I.value={title:"",jobCode:"",createdFrom:"",createdTo:"",dueDateFrom:"",dueDateTo:"",customerCode:"",notifyFrom:"",notifyTo:""},S.value=0,E.value=0,V.value=0,M.value=0,k.value="",c(),U(),z()},applyFilter:()=>{c(),(async()=>{0===a.value.length&&(p.value=!0);try{I.value,n.value,o.value;let e="";E.value>0&&(e=T.value[E.value-1].memberUID||"");let t="";V.value>0&&(t=T.value[V.value-1].memberUID||"");const i=pa(I.value,C[S.value],B[M.value],e,t),[l,s]=await Promise.all([ga({...i,pageNo:n.value,pageSize:o.value}),fa(i)]);a.value=l||[],d(s||0)}catch(e){i("error","at controllers/list_todo.ts:134",e),Da(t("common.error_load"))}finally{p.value=!1}})(),z()},showActionMenu:e=>{uni.showActionSheet({itemList:[t("common.delete")],itemColor:"#ff3b30",success:t=>{0===t.tapIndex&&(e=>{w.value=e,b.value=!0})(e)}})},cancelDelete:()=>{b.value=!1,w.value=null},confirmDelete:async()=>{var e;if(w.value)try{await(e=w.value.id,oa({url:`${Gt}/delete`,method:"POST",data:{id:e}})),wa(t("common.success_delete")),b.value=!1,w.value=null,U()}catch(a){i("error","at controllers/list_todo.ts:294","Delete Error:",a),Da(t("common.fail_delete"))}},showCustomerModal:y,loadingCustomer:A,customerList:R,selectedCustomerName:k,openCustomerPopup:()=>{y.value=!0,O(),0===R.value.length&&F({})},onCustomerSelect:e=>{I.value.customerCode=e.uid,k.value=e.name,y.value=!1},onFilterCustomerInModal:e=>{F(e)},pageNo:n,pageSize:o,totalCount:l,onChangePage:e=>{m(e)&&U()},onUpdatePageSize:e=>{h(e),U()},rawMemberList:T,fetchCustomers:F,loadingMore:L,loadMoreCustomers:P,isQuickCompleteOpen:f,quickTodos:_,isLoadingQuick:v,openQuickComplete:async()=>{f.value=!0,v.value=!0;try{const e=await ga({pageNo:1,pageSize:100,status:""});Array.isArray(e)?_.value=e.filter((e=>e.status!==ra)):_.value=[]}catch(e){i("error","at controllers/list_todo.ts:163","Lỗi lấy danh sách hoàn thành nhanh:",e),Da(t("common.error_load"))}finally{v.value=!1}},closeQuickComplete:()=>{f.value=!1},handleQuickMarkDone:async e=>{uni.showLoading({title:t("common.processing")});try{const a={...e,status:ra,preFixCode:"TODO",description:e.description||"",files:"",tagCodes:""};await _a(a)&&(wa(t("common.msg_completed")),_.value=_.value.filter((t=>t.id!==e.id)),U())}catch(a){i("error","at controllers/list_todo.ts:194","Lỗi quick complete:",a),Da(t("common.error_update"))}finally{uni.hideLoading()}}}},Ea=a(e.defineComponent({__name:"StatusBadge",props:{status:{}},setup(t){const{t:a}=lt(),n=t,i=e.computed((()=>{switch(n.status){case la:return a("todo.status_todo");case sa:return a("todo.status_progress");case ra:return a("todo.status_done");case ca:return a("todo.status_overdue");default:return n.status||"Unknown"}})),o=e.computed((()=>{switch(n.status){case la:return"status-new";case sa:return"status-progress";case ra:return"status-done";case ca:return"status-overdue";default:return"status-default"}}));return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["badge-base",o.value])},e.toDisplayString(i.value),3))}}),[["__scopeId","data-v-b5726964"]]),xa=a(e.defineComponent({__name:"AppButton",props:{label:{default:""},type:{default:"primary"},size:{default:"normal"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["click"],setup(t,{emit:a}){const n=t,i=a,o=e=>{n.disabled||n.loading||i("click",e)};return(t,a)=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(["app-btn",[`btn-${t.type}`,"small"===t.size?"btn-sm":"",{"is-disabled":t.disabled||t.loading}]]),disabled:t.disabled||t.loading,onClick:o,"hover-class":"btn-hover"},[t.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-spinner"})):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("text",{class:"btn-text"},e.toDisplayString(t.label),1)]),!0)],10,["disabled"]))}}),[["__scopeId","data-v-dbda53df"]]),Va=a(e.defineComponent({__name:"GlobalMessage",setup(t){const{t:a}=lt(),n=ia(),i=e.computed((()=>n.isDark)),o=e.ref(!1),l=e.ref(""),s=e.ref("success"),r=e.ref(0);let c=null;const d={success:"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%23047857%22%3E%3Cpath%20d%3D%22M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm-2%2015l-5-5%201.41-1.41L10%2014.17l7.59-7.59L19%208l-9%209z%22%2F%3E%3C%2Fsvg%3E",error:"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%23b91c1c%22%3E%3Cpath%20d%3D%22M12%202C6.47%202%202%206.47%202%2012s4.47%2010%2010%2010%2010-4.47%2010-10S17.53%202%2012%202zm5%2013.59L15.59%2017%2012%2013.41%208.41%2017%207%2015.59%2010.59%2012%207%208.41%208.41%207%2012%2010.59%2015.59%207%2017%208.41%2013.41%2012%2017%2015.59z%22%2F%3E%3C%2Fsvg%3E",info:"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%231d4ed8%22%3E%3Cpath%20d%3D%22M12%202C6.48%202%202%206.48%202%2012s4.48%2010%2010%2010%2010-4.48%2010-10S17.52%202%2012%202zm1%2015h-2v-6h2v6zm0-8h-2V7h2v2z%22%2F%3E%3C%2Fsvg%3E",warning:"data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22%23b45309%22%3E%3Cpath%20d%3D%22M1%2021h22L12%202%201%2021zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z%22%2F%3E%3C%2Fsvg%3E"},u=e.computed((()=>d[s.value]||d.info)),m=e=>{c&&(clearTimeout(c),o.value=!1),l.value=e.message,s.value=e.type||"success",setTimeout((()=>{o.value=!0}),50),c=setTimeout((()=>{o.value=!1}),3e3)};return e.onMounted((()=>{var e;const t=uni.getSystemInfoSync();r.value=(null==(e=t.safeAreaInsets)?void 0:e.bottom)||0,uni.$on("app-toast-show",m),uni.onNetworkStatusChange((e=>{e.isConnected?m({message:a("common.network_restored"),type:"success"}):m({message:a("common.network_lost"),type:"error"})}))})),uni.getNetworkType({success:e=>{"none"===e.networkType&&m({message:a("common.no_internet"),type:"error"})}}),e.onUnmounted((()=>{uni.$off("app-toast-show",m)})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["global-message-container",{show:o.value,"theme-dark":i.value}]),style:e.normalizeStyle({paddingBottom:r.value+20+"px"})},[e.createElementVNode("view",{class:e.normalizeClass(["message-content",s.value])},[e.createElementVNode("image",{src:u.value,class:"msg-icon",mode:"aspectFit"},null,8,["src"]),e.createElementVNode("text",{class:"msg-text"},e.toDisplayString(l.value),1)],2)],6))}}),[["__scopeId","data-v-a4e7cc9b"]]),$a=a(e.defineComponent({__name:"ConfirmModal",props:{visible:{type:Boolean},title:{default:"Thông báo"},message:{default:""},cancelLabel:{default:"Hủy"},confirmLabel:{default:"Xác nhận"},confirmType:{default:"primary"}},emits:["update:visible","confirm","cancel"],setup(t,{emit:a}){const n=a,i=ia(),o=e.computed((()=>i.isDark)),l=()=>{n("update:visible",!1),n("cancel")},s=()=>{n("confirm")};return(t,a)=>t.visible?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["modal-overlay",{"theme-dark":o.value}]),onClick:l},[e.createElementVNode("view",{class:"modal-container",onClick:a[0]||(a[0]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"modal-header"},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(t.title),1)]),e.createElementVNode("view",{class:"modal-body"},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("text",null,e.toDisplayString(t.message),1)]),!0)]),e.createElementVNode("view",{class:"modal-footer"},[e.createVNode(xa,{type:"secondary",label:t.cancelLabel,class:"flex-1",onClick:l},null,8,["label"]),e.createVNode(xa,{type:t.confirmType,label:t.confirmLabel,class:"flex-1",onClick:s},null,8,["type","label"])])])],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-1b9f3e20"]]),Ba=a(e.defineComponent({__name:"Pagination",props:{pageNo:{},pageSize:{},total:{},pageSizeOptions:{},showTotal:{type:Boolean}},emits:["changePage","update:pageSize"],setup(t,{emit:a}){const n=t,i=a,o=e.computed((()=>n.pageSize&&0!==n.pageSize&&Math.ceil(n.total/n.pageSize)||1)),l=e.computed((()=>n.pageSizeOptions?n.pageSizeOptions.map((e=>String(e))):[])),s=e.computed((()=>{if(!n.pageSizeOptions)return 0;const e=n.pageSizeOptions.indexOf(n.pageSize);return-1!==e?e:0})),r=e=>{const t=e.detail.value;if(n.pageSizeOptions&&n.pageSizeOptions[t]){const e=n.pageSizeOptions[t];i("update:pageSize",e)}},c=()=>{n.pageNo>1&&i("changePage",-1)},d=()=>{n.pageNo<o.value&&i("changePage",1)};return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"pagination-footer"},[e.createVNode(T,{range:l.value,value:s.value,onChange:r,title:t.$t("common.page_unit")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"page-size-selector"},[e.createElementVNode("text",{class:"size-text"},e.toDisplayString(t.pageSize)+" / "+e.toDisplayString(t.$t("common.page_unit")),1),e.createElementVNode("text",{class:"dropdown-arrow"},"▼")])])),_:1},8,["range","value","title"]),t.showTotal?(e.openBlock(),e.createElementBlock("text",{key:0,class:"total-text"},e.toDisplayString(t.$t("common.total"))+": "+e.toDisplayString(t.total),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"pagination-controls"},[e.createElementVNode("view",{class:e.normalizeClass(["page-arrow",{disabled:t.pageNo<=1}]),onClick:c},"‹",2),e.createElementVNode("view",{class:"page-box active"},e.toDisplayString(t.pageNo),1),e.createElementVNode("view",{class:e.normalizeClass(["page-arrow",{disabled:t.pageNo>=o.value}]),onClick:d},"›",2)]),t.$slots.action?(e.openBlock(),e.createElementBlock("view",{key:1,class:"add-btn-wrapper"},[e.renderSlot(t.$slots,"action",{},void 0,!0)])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-7e2fc0a4"]]),Ma=a(e.defineComponent({__name:"GlobalNotification",setup(t){const a=Qt(),n=ia(),o=e.computed((()=>n.isDark)),l=e.ref(0);uni.getSystemInfo({success:e=>{l.value=(e.statusBarHeight||0)+10}});const s=e.computed((()=>`<div style="font-size: 14px; line-height: 1.4; color: var(--text-primary);">${a.message}</div>`)),r=()=>{a.hide()},c=()=>{i("log","at components/GlobalNotification.vue:51","Click vào thông báo"),r()};return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["notification-wrapper",{show:e.unref(a).visible,"theme-dark":o.value}]),style:e.normalizeStyle({paddingTop:l.value+"px"})},[e.createElementVNode("view",{class:e.normalizeClass(["notification-card",e.unref(a).type]),onClick:c},[e.createElementVNode("view",{class:"icon-box"},["success"===e.unref(a).type?(e.openBlock(),e.createElementBlock("text",{key:0,class:"icon"},"✅")):"warning"===e.unref(a).type?(e.openBlock(),e.createElementBlock("text",{key:1,class:"icon"},"⚠️")):"error"===e.unref(a).type?(e.openBlock(),e.createElementBlock("text",{key:2,class:"icon"},"⛔")):(e.openBlock(),e.createElementBlock("text",{key:3,class:"icon"},"🔔"))]),e.createElementVNode("view",{class:"content-box"},[e.createElementVNode("rich-text",{nodes:s.value},null,8,["nodes"])]),e.createElementVNode("view",{class:"close-btn",onClick:e.withModifiers(r,["stop"])},"✕")],2)],6))}}),[["__scopeId","data-v-18263937"]]),Ia=a(e.defineComponent({__name:"list_todo",setup(t){const a=ia(),i=e.computed((()=>a.isDark)),l=()=>{getCurrentPages().length>1?uni.navigateBack({delta:1}):plus.runtime.quit()},s=e.ref(20);e.onMounted((()=>{const e=uni.getSystemInfoSync();e.statusBarHeight&&(s.value=e.statusBarHeight),r()}));const r=()=>{i.value?uni.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:"#000000"}):uni.setNavigationBarColor({frontColor:"#000000",backgroundColor:"#ffffff"})};e.watch(i,(()=>{r()}));const{todos:c,isLoading:d,isFilterOpen:u,filter:p,isConfirmDeleteOpen:g,itemToDelete:f,pageSizeOptions:_,pageSizeIndex:v,currentPage:y,totalPages:k,onPageSizeChange:b,changePage:w,statusOptions:D,statusIndex:C,onStatusChange:S,creatorOptions:N,creatorIndex:E,onCreatorChange:x,customerOptions:V,customerIndex:$,onCustomerChange:B,assigneeOptions:M,assigneeIndex:I,onAssigneeChange:O,sourceOptions:R,sourceIndex:A,onSourceChange:L,addNewTask:F,openFilter:P,closeFilter:U,resetFilter:z,applyFilter:j,showActionMenu:H,cancelDelete:W,confirmDelete:q,goToDetail:Y,showCustomerModal:G,loadingCustomer:K,customerList:J,selectedCustomerName:Q,openCustomerPopup:X,onCustomerSelect:Z,onFilterCustomerInModal:ee,pageNo:te,pageSize:ae,totalCount:ne,onChangePage:ie,onUpdatePageSize:oe,rawMemberList:le,loadingMore:se,loadMoreCustomers:re,isQuickCompleteOpen:ce,quickTodos:de,isLoadingQuick:ue,openQuickComplete:me,closeQuickComplete:he,handleQuickMarkDone:pe}=Na(),ge=e.ref(!1),fe=e.ref(null);return(t,a)=>{const r=o(e.resolveDynamicComponent("uni-icons"),n);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["container",{"theme-dark":i.value}])},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"status-bar-spacer",style:e.normalizeStyle({height:s.value+"px"})},null,4),e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"header-left",onClick:l},[e.createVNode(r,{type:"left",size:"24",color:i.value?"#ffffff":"#333333"},null,8,["color"])]),e.createElementVNode("text",{class:"header-title"},e.toDisplayString(t.$t("todo.page_title")),1),e.createElementVNode("view",{class:"header-right"},[e.createElementVNode("view",{class:"icon-btn",onClick:a[0]||(a[0]=(...t)=>e.unref(me)&&e.unref(me)(...t)),style:{"margin-right":"15px"}},[e.createElementVNode("image",{src:m,class:"filter-icon",mode:"aspectFit"})]),e.createElementVNode("view",{class:"icon-btn",onClick:a[1]||(a[1]=(...t)=>e.unref(P)&&e.unref(P)(...t))},[e.createElementVNode("image",{src:h,class:"filter-icon"})])])])]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"list-container"},[e.unref(d)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-state"},[e.createElementVNode("text",null,e.toDisplayString(t.$t("common.loading")),1)])):0===e.unref(c).length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("image",{src:"/static/empty-box.png",mode:"aspectFit",class:"empty-icon"}),e.createElementVNode("text",{class:"empty-text"},e.toDisplayString(t.$t("common.no_data")),1)])):(e.openBlock(),e.createElementBlock("scroll-view",{key:2,"scroll-y":"",class:"list-view"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),((a,n)=>(e.openBlock(),e.createElementBlock("view",{key:a.id||n,class:"card-item",onClick:t=>e.unref(Y)(a)},[e.createElementVNode("view",{class:e.normalizeClass(["status-bar",a.statusClass])},null,2),e.createElementVNode("view",{class:"card-body"},[e.createElementVNode("view",{class:"card-row top-row"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString(a.title),1),e.createElementVNode("view",{class:"action-btn",onClick:e.withModifiers((e=>(e=>{fe.value=e,ge.value=!0})(a)),["stop"])},[e.createElementVNode("text",{class:"dots"},"•••")],8,["onClick"])]),e.createElementVNode("view",{class:"card-info-row"},[e.createElementVNode("image",{src:"/static/create-time.png",class:"icon-small"}),e.createElementVNode("text",{class:"card-date"},e.toDisplayString(t.$t("todo.created_at"))+": "+e.toDisplayString(a.createdAtFormatted),1)]),a.dueDateFormatted?(e.openBlock(),e.createElementBlock("view",{key:0,class:"card-info-row"},[e.createElementVNode("image",{src:"/static/due-time.png",class:"icon-small"}),e.createElementVNode("text",{class:"card-date text-danger"},e.toDisplayString(t.$t("todo.expired_at"))+": "+e.toDisplayString(a.dueDateFormatted),1)])):e.createCommentVNode("",!0),a.notifyAtFormatted?(e.openBlock(),e.createElementBlock("view",{key:1,class:"card-info-row"},[e.createElementVNode("image",{src:"/static/notify-time.png",class:"icon-small"}),e.createElementVNode("text",{class:"card-date text-primary"},e.toDisplayString(t.$t("todo.notify_at"))+": "+e.toDisplayString(a.notifyAtFormatted),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"card-row bot-row"},[e.createElementVNode("view",{class:"code-tag"},"#"+e.toDisplayString(a.code),1),e.createVNode(Ea,{status:a.status},null,8,["status"])])])],8,["onClick"])))),128)),e.createElementVNode("view",{style:{height:"20px"}})]))]),e.createVNode(Ba,{pageNo:e.unref(te),pageSize:e.unref(ae),total:e.unref(ne),pageSizeOptions:e.unref(_),onChangePage:e.unref(ie),"onUpdate:pageSize":e.unref(oe)},{action:e.withCtx((()=>[e.createElementVNode("view",{class:"add-task-simple",onClick:a[2]||(a[2]=(...t)=>e.unref(F)&&e.unref(F)(...t))},[e.createElementVNode("text",{class:"plus-icon"},"+"),e.createElementVNode("text",{class:"add-text"},e.toDisplayString(t.$t("todo.add_task")),1)])])),_:1},8,["pageNo","pageSize","total","pageSizeOptions","onChangePage","onUpdate:pageSize"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"filter-overlay",onClick:a[14]||(a[14]=e.withModifiers(((...t)=>e.unref(U)&&e.unref(U)(...t)),["stop"]))},[e.createElementVNode("view",{class:"filter-panel",onClick:a[13]||(a[13]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"filter-header"},[e.createElementVNode("text",{class:"filter-title"},e.toDisplayString(t.$t("todo.filter_title")),1),e.createElementVNode("text",{class:"close-btn",onClick:a[3]||(a[3]=(...t)=>e.unref(U)&&e.unref(U)(...t))},"✕")]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"filter-body"},[e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(t.$t("todo.search_label")),1),e.withDirectives(e.createElementVNode("input",{class:"f-input","onUpdate:modelValue":a[4]||(a[4]=t=>e.unref(p).title=t),placeholder:t.$t("todo.search_placeholder"),"placeholder-class":"input-placeholder"},null,8,["placeholder"]),[[e.vModelText,e.unref(p).title]])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(t.$t("todo.code_prefix")),1),e.withDirectives(e.createElementVNode("input",{class:"f-input","onUpdate:modelValue":a[5]||(a[5]=t=>e.unref(p).jobCode=t),placeholder:t.$t("todo.job_code_placeholder"),"placeholder-class":"input-placeholder"},null,8,["placeholder"]),[[e.vModelText,e.unref(p).jobCode]])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(t.$t("todo.status")),1),e.createVNode(T,{range:e.unref(D),value:e.unref(C),onChange:e.unref(S),title:t.$t("todo.status")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"f-picker"},[e.createTextVNode(e.toDisplayString(e.unref(D)[e.unref(C)])+" ",1),e.createElementVNode("text",{class:"arrow"},"▼")])])),_:1},8,["range","value","onChange","title"])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(t.$t("todo.creator")),1),e.createVNode(T,{range:e.unref(N),value:e.unref(E),onChange:e.unref(x),title:t.$t("todo.creator")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"f-picker"},[e.createTextVNode(e.toDisplayString(e.unref(N)[e.unref(E)])+" ",1),e.createElementVNode("text",{class:"arrow"},"▼")])])),_:1},8,["range","value","onChange","title"])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(t.$t("todo.customer")),1),e.createElementVNode("view",{class:"f-input",onClick:a[6]||(a[6]=(...t)=>e.unref(X)&&e.unref(X)(...t)),style:{"justify-content":"space-between"}},[e.createElementVNode("text",{class:e.normalizeClass(e.unref(Q)?"text-filled":"text-empty")},e.toDisplayString(e.unref(Q)||t.$t("todo.select_customer")),3),e.createElementVNode("text",{class:"arrow"},"›")])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(t.$t("todo.assignee")),1),e.createVNode(T,{range:e.unref(M),value:e.unref(I),onChange:e.unref(O),title:t.$t("todo.assignee")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"f-picker"},[e.createTextVNode(e.toDisplayString(e.unref(M)[e.unref(I)])+" ",1),e.createElementVNode("text",{class:"arrow"},"▼")])])),_:1},8,["range","value","onChange","title"])]),e.createElementVNode("view",{class:"f-group"},[e.createElementVNode("text",{class:"f-label"},e.toDisplayString(t.$t("todo.source")),1),e.createVNode(T,{range:e.unref(R),value:e.unref(A),onChange:e.unref(L),title:t.$t("todo.source")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"f-picker"},[e.createTextVNode(e.toDisplayString(e.unref(R)[e.unref(A)])+" ",1),e.createElementVNode("text",{class:"arrow"},"▼")])])),_:1},8,["range","value","onChange","title"])]),e.createVNode(ct,{title:t.$t("todo.time_create"),startDate:e.unref(p).createdFrom,"onUpdate:startDate":a[7]||(a[7]=t=>e.unref(p).createdFrom=t),endDate:e.unref(p).createdTo,"onUpdate:endDate":a[8]||(a[8]=t=>e.unref(p).createdTo=t)},null,8,["title","startDate","endDate"]),e.createVNode(ct,{title:t.$t("todo.time_expired"),startDate:e.unref(p).dueDateFrom,"onUpdate:startDate":a[9]||(a[9]=t=>e.unref(p).dueDateFrom=t),endDate:e.unref(p).dueDateTo,"onUpdate:endDate":a[10]||(a[10]=t=>e.unref(p).dueDateTo=t)},null,8,["title","startDate","endDate"]),e.createVNode(ct,{title:t.$t("todo.time_notify"),startDate:e.unref(p).notifyFrom,"onUpdate:startDate":a[11]||(a[11]=t=>e.unref(p).notifyFrom=t),endDate:e.unref(p).notifyTo,"onUpdate:endDate":a[12]||(a[12]=t=>e.unref(p).notifyTo=t)},null,8,["title","startDate","endDate"]),e.createElementVNode("view",{style:{height:"20px"}})]),e.createElementVNode("view",{class:"filter-footer"},[e.createVNode(xa,{type:"secondary",label:t.$t("common.reset"),onClick:e.unref(z)},null,8,["label","onClick"]),e.createVNode(xa,{type:"primary",label:t.$t("common.apply"),onClick:e.unref(j)},null,8,["label","onClick"])])])])):e.createCommentVNode("",!0),e.unref(ce)?(e.openBlock(),e.createElementBlock("view",{key:1,class:"filter-overlay",onClick:a[17]||(a[17]=e.withModifiers(((...t)=>e.unref(he)&&e.unref(he)(...t)),["stop"]))},[e.createElementVNode("view",{class:"filter-panel quick-panel",onClick:a[16]||(a[16]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"filter-header"},[e.createElementVNode("text",{class:"filter-title"},e.toDisplayString(t.$t("todo.quick_done_title")),1),e.createElementVNode("text",{class:"close-btn",onClick:a[15]||(a[15]=(...t)=>e.unref(he)&&e.unref(he)(...t))},"✕")]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"filter-body"},[e.unref(ue)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-state",style:{height:"200px"}},[e.createElementVNode("text",null,e.toDisplayString(t.$t("common.loading")),1)])):0===e.unref(de).length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state",style:{height:"200px"}},[e.createElementVNode("text",{class:"empty-text"},e.toDisplayString(t.$t("todo.msg_no_task_quick_done")),1)])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"quick-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(de),(a=>(e.openBlock(),e.createElementBlock("view",{key:a.id,class:"quick-item"},[e.createElementVNode("view",{class:"quick-info"},[e.createElementVNode("view",{class:"quick-code"},"#"+e.toDisplayString(a.code),1),e.createElementVNode("view",{class:"quick-title"},e.toDisplayString(a.title),1)]),e.createElementVNode("view",{class:"quick-action"},[e.createElementVNode("button",{class:"btn-complete",onClick:e.withModifiers((t=>e.unref(pe)(a)),["stop"])},[e.createElementVNode("text",null,e.toDisplayString(t.$t("todo.done_action")),1)],8,["onClick"])])])))),128)),e.createElementVNode("view",{style:{height:"40px"}})]))])])])):e.createCommentVNode("",!0),e.createVNode(dt,{visible:e.unref(G),loading:e.unref(K),loadingMore:e.unref(se),customers:e.unref(J),managers:e.unref(le),onClose:a[18]||(a[18]=e=>G.value=!1),onSelect:e.unref(Z),onFilter:e.unref(ee),onLoadMore:e.unref(re)},null,8,["visible","loading","loadingMore","customers","managers","onSelect","onFilter","onLoadMore"]),e.createVNode($a,{visible:e.unref(g),"onUpdate:visible":a[19]||(a[19]=t=>e.isRef(g)?g.value=t:null),title:t.$t("common.notification"),message:e.unref(f)?t.$t("todo.confirm_delete_msg").replace("{title}",e.unref(f).title):"","confirm-type":"danger","cancel-label":t.$t("common.cancel"),"confirm-label":t.$t("common.delete"),onConfirm:e.unref(q),onCancel:e.unref(W)},null,8,["visible","title","message","cancel-label","confirm-label","onConfirm","onCancel"]),e.createElementVNode("view",{class:e.normalizeClass(["custom-sheet-mask",{show:ge.value}]),onClick:a[23]||(a[23]=e=>ge.value=!1)},[e.createElementVNode("view",{class:"custom-sheet-panel",onClick:a[22]||(a[22]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"sheet-item delete",onClick:a[20]||(a[20]=e=>{return t="delete",ge.value=!1,void("delete"===t&&(f.value=fe.value,g.value=!0));var t})},[e.createElementVNode("text",null,e.toDisplayString(t.$t("common.delete")),1)]),e.createElementVNode("view",{class:"sheet-gap"}),e.createElementVNode("view",{class:"sheet-item cancel",onClick:a[21]||(a[21]=e=>ge.value=!1)},[e.createElementVNode("text",null,e.toDisplayString(t.$t("common.cancel")),1)])])],2),e.createVNode(Va),e.createVNode(Ma)],2)}}}),[["__scopeId","data-v-68c938e6"]]),Oa="/static/expand-arrow.png",Ra=e=>{if(!e)return 0;const t=e.replace(/-/g,"/"),a=new Date(t);return isNaN(a.getTime())?0:a.getTime()},Aa=()=>{const{t:t}=lt(),a=ia(),n=e=>e.toString().padStart(2,"0"),o=(()=>{const e=new Date;return`${e.getFullYear()}-${n(e.getMonth()+1)}-${n(e.getDate())} ${n(e.getHours())}:${n(e.getMinutes())}:00`})(),{customerList:l,loadingCustomer:s,loadingMore:r,fetchCustomers:c,loadMoreCustomers:d}=Ta(),u=e.ref(!1),m=e.ref({name:"",desc:"",customer:"",customerUid:"",assignee:"",dueDate:o,notifyAt:o});e.watch((()=>m.value.dueDate),(e=>{})),e.watch((()=>m.value.notifyAt),(e=>{}));const h=e.computed((()=>[t("source.call"),t("source.customer"),t("source.conversation")])),p=[Bt,Mt,It],g=e.ref(-1),f=e.ref([]),_=e.ref([]),v=e.ref(-1),y=e.ref(!1);e.ref("");const k=e.computed((()=>v.value>-1&&_.value.length>0?_.value[v.value]:""));return e.onMounted((()=>{(async()=>{try{const e=await Jt();f.value=e,_.value=e.map((e=>e.UserName||t("common.unknown_member")))}catch(e){i("error","at controllers/create_todo.ts:87","Lỗi lấy thành viên:",e),Da(t("todo.error_load_member"))}})(),c({})})),{loading:u,form:m,memberOptions:_,onMemberChange:e=>{const t=e.detail.value;v.value=t;const a=f.value[t];a&&(m.value.assignee=a.memberUID)},currentAssigneeName:k,showCustomerModal:y,loadingCustomer:s,customerList:l,openCustomerPopup:()=>{y.value=!0,0===l.value.length&&c({})},onCustomerSelect:e=>{if(m.value.customer=`${e.name} - ${e.phone}`,m.value.customerUid=e.uid,e.managerUid){const t=f.value.findIndex((t=>t.memberUID===e.managerUid));-1!==t&&(v.value=t,m.value.assignee=e.managerUid,i("log","at controllers/create_todo.ts:111",`Đã tự động chọn quản lý: ${f.value[t].UserName}`))}y.value=!1},goBack:()=>uni.navigateBack(),submitForm:async()=>{if(!m.value.name||!m.value.name.trim())return void Ca(t("todo.validate_name"));if(!I(m.value.dueDate,m.value.notifyAt))return void Da(t("todo.msg_notify_must_be_before_due"));let e="CALL";g.value>=0&&(e=p[g.value]),u.value=!0,((e="Đang xử lý...")=>{uni.showLoading({title:e,mask:!0})})(t("todo.upload_processing"));try{const{newContent:o,fileUrls:l}=await(async e=>{if(!e)return{newContent:"",fileUrls:[]};const t=/<img[^>]+src="([^">]+)"/g;let a;const n=[],o=[],l=[];for(;null!==(a=t.exec(e));){const e=a[1];if(!e.startsWith("http")&&!e.startsWith("https")){const t=ka(e).then((t=>{o.push({oldSrc:e,newSrc:t}),l.push(t)})).catch((t=>{i("error","at controllers/create_todo.ts:153",`Upload ảnh ${e} lỗi:`,t)}));n.push(t)}}n.length>0&&await Promise.all(n);let s=e;return o.forEach((e=>{s=s.split(e.oldSrc).join(e.newSrc)})),{newContent:s,fileUrls:l}})(m.value.desc);m.value.desc=o;const s=((e,t)=>(i("log","at models/create_todo.ts:16","Check date values:",{dueDate:e.dueDate,notifyAt:e.notifyAt}),{title:e.name,description:e.desc||Lt,projectCode:t.projectCode,createdBy:t.uid,status:la,links:t.link||Bt,pluginType:Ft,customerCode:e.customerUid||jt,assigneeId:e.assignee||zt,groupId:Pt,transId:Ut,tagCodes:"test1",groupMemberUid:"test1",files:t.uploadedFiles||Lt,phone:Ht,dueDate:Ra(e.dueDate),notificationReceivedAt:Ra(e.notifyAt)}))(m.value,{projectCode:a.projectCode,uid:a.uid,link:e,uploadedFiles:l.length>0?l[0]:""});i("log","at controllers/create_todo.ts:200","Payload Submit:",s),await(n=s,oa({url:`${Gt}/create`,method:"POST",data:n})),Sa(),wa(t("todo.create_success")),setTimeout((()=>{uni.navigateBack()}),1500)}catch(o){Sa(),i("error","at controllers/create_todo.ts:209","Create Error:",o);const e=(null==o?void 0:o.message)||("string"==typeof o?o:t("common.failed"));Da(t("common.error_load")+": "+e)}finally{u.value=!1}var n},sourceOptions:h,sourceIndex:g,onSourceChange:e=>{g.value=parseInt(e.detail.value)},memberList:f,onCustomerFilter:e=>{c(e)},loadingMore:r,loadMoreCustomers:d}},La="/static/link.png",Fa=e=>{if(!e)return"";let t=e.trim();/^https?:\/\//i.test(t)||(t="http://"+t);try{return new URL(t).hostname}catch(a){const e=t.match(/^(?:https?:\/\/)?(?:www\.)?([^:\/\n?]+)/im);return e?e[1]:""}},Pa=e=>{if(!e)return{cleanHtml:"",links:[]};const t=[];return{cleanHtml:e.replace(/<iframe[^>]+src="([^">]+)"[^>]*><\/iframe>/g,((e,a)=>(a&&t.push(a),""))),links:t}},Ua=(e,t)=>{let a=e;return t.forEach((e=>{a+=`<iframe class="ql-video" frameborder="0" allowfullscreen="true" src="${e}"></iframe>`})),a},za=e=>{if(!e)return;let t=e.trim();t.startsWith("http")||(t="https://"+t),plus.runtime.openURL(t)},ja=a(e.defineComponent({__name:"LinkCard",props:{url:{type:String,required:!0,default:""},removable:{type:Boolean,default:!1}},emits:["remove"],setup(t,{emit:a}){const n=t,i=e.ref(!1),o=e.computed((()=>(e=>{let t=Fa(e);if(!t)return"Liên kết ngoài";try{t=t.replace(/^www\./,"");const e=t.split(".");let a=e[0];if(e.length>2){const t=e[e.length-1],n=e[e.length-2];2===t.length&&["com","net","org","gov","edu"].includes(n)?e.length>=3&&(a=e[e.length-3]):a=e[e.length-2]}else 2===e.length&&(a=e[0]);return a.charAt(0).toUpperCase()+a.slice(1)}catch(a){return t||"Liên kết ngoài"}})(n.url))),l=e.computed((()=>(e=>{const t=Fa(e);return t?`https://www.google.com/s2/favicons?domain=${t}&sz=64`:""})(n.url)));e.watch((()=>n.url),(()=>{i.value=!1}));const s=e=>{i.value=!0},r=()=>{za(n.url)};return(a,n)=>t.url?(e.openBlock(),e.createElementBlock("view",{key:0,class:"link-card",onClick:e.withModifiers(r,["stop"])},[e.createElementVNode("view",{class:"link-card-icon"},[!i.value&&l.value?(e.openBlock(),e.createElementBlock("image",{key:0,src:l.value,class:"card-icon-img",mode:"aspectFit",onError:s},null,40,["src"])):(e.openBlock(),e.createElementBlock("image",{key:1,src:"https://img.icons8.com/ios-filled/50/007aff/internet.png",class:"card-icon-img"}))]),e.createElementVNode("view",{class:"link-card-content"},[e.createElementVNode("text",{class:"link-domain"},e.toDisplayString(o.value),1),e.createElementVNode("text",{class:"link-url"},e.toDisplayString(t.url),1)]),t.removable?(e.openBlock(),e.createElementBlock("view",{key:0,class:"link-card-remove",onClick:n[0]||(n[0]=e.withModifiers((e=>a.$emit("remove")),["stop"]))},[e.createElementVNode("text",{class:"remove-btn"},"✕")])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-7fbf6fd0"]]),Ha=a(e.defineComponent({__name:"TodoEditor",props:{modelValue:String,placeholder:{type:String,default:""},readOnly:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:a}){const{t:n}=lt(),o=t,l=a,s=[{name:"header",iconText:"H",style:"font-weight:bold",action:"header-menu"},{name:"fontSize",iconText:"A",style:"font-weight:bold; font-size:16px",action:"fontsize-menu"},{name:"bold",iconText:"B",style:"font-weight:900"},{name:"italic",iconText:"I",style:"font-style:italic"},{name:"underline",iconText:"U",style:"text-decoration:underline"},{name:"color",iconImg:"/static/text_color.png",action:"color-picker"},{name:"backgroundColor",iconImg:"/static/background_color.png",action:"bgcolor-picker"},{name:"strike",iconText:"S",style:"text-decoration:line-through"},{name:"align",iconImg:"/static/align-left.png",action:"align-menu"},{name:"list",value:"ordered",iconImg:"/static/numbered-list.png"},{name:"list",value:"bullet",iconImg:"/static/list.png"}],r=["#000000","#333333","#888888","#aaaaaa","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#880088","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5"],c=e.ref(`editor-${Math.random().toString(36).substr(2,5)}`),d=e.ref(null),u=e.ref({}),m=e.getCurrentInstance(),h=e.ref(!1),p=e.ref(""),g=e.ref(!1),f=e.ref(!1),_=e.ref(""),v=e.ref(!1),y=e.ref(""),k=e.ref(!1),b=e.ref("color"),w=e.ref([]),D=e.ref(!1),C=()=>{D.value=!D.value},S=e.ref(!1),T=e.ref([]),N=e.ref(!1),E=e.ref(""),x=e.ref(0);e.ref(0);const V=e.ref("top"),$=e.computed((()=>"fixed"===V.value?{}:{top:`${x.value}px`})),B=()=>{E.value&&(plus.runtime.openURL(E.value),N.value=!1)},M=()=>{E.value&&uni.setClipboardData({data:E.value,success:()=>{uni.showToast({title:"Đã sao chép link",icon:"none"}),N.value=!1}})},I=()=>{E.value&&(_.value=E.value,N.value=!1,f.value=!0)},O=()=>{y.value="",v.value=!0},R=()=>{if(y.value){let e=y.value.trim();e.startsWith("http")||(e="https://"+e),w.value.push(e),A()}v.value=!1},A=()=>{d.value&&d.value.getContents({success:e=>{const t=e.html;p.value=t;const a=Ua(t,w.value);l("update:modelValue",a)}})},L=e=>{const t=u.value[e.name];return"header-menu"===e.action?t?`H${t}`:"H":"fontsize-menu"===e.action?"small"===t?"Sm":"large"===t?"Lg":"huge"===t?"Hg":"A":e.iconText},F=e=>{if("align-menu"===e.action){switch(u.value.align||"left"){case"center":return"/static/align-center.png";case"right":return"/static/align-right.png";case"justify":return"/static/align-justify.png";default:return"/static/align-left.png"}}return e.iconImg},P=e=>{const t=u.value[e.name];return"header-menu"===e.action||"fontsize-menu"===e.action?!!t:"align-menu"===e.action?!!t&&"left"!==t:"color"===e.name?!!u.value.color:"backgroundColor"===e.name?!!u.value.backgroundColor:e.value?t===e.value:!!t},U=()=>{S.value=!1},z=()=>{T.value=[{text:n("editor.align_left"),handler:()=>J("align","left")},{text:n("editor.align_center"),handler:()=>J("align","center")},{text:n("editor.align_right"),handler:()=>J("align","right")},{text:n("editor.align_justify"),handler:()=>J("align","justify")}],S.value=!0},j=()=>{T.value=[{text:n("editor.size_small"),handler:()=>J("fontSize","12px")},{text:n("editor.size_normal"),handler:()=>J("fontSize","16px")},{text:n("editor.size_large"),handler:()=>J("fontSize","24px")},{text:n("editor.size_huge"),handler:()=>J("fontSize","32px")}],S.value=!0},H=()=>{T.value=[{text:"Heading 1",handler:()=>J("header",1)},{text:"Heading 2",handler:()=>J("header",2)},{text:"Heading 3",handler:()=>J("header",3)},{text:"Heading 4",handler:()=>J("header",4)},{text:n("editor.size_normal"),handler:()=>J("header",null)}],S.value=!0},W=()=>{T.value=[{text:n("editor.img_camera"),handler:()=>{uni.chooseImage({count:1,sourceType:["camera"],success:e=>q(e)})}},{text:n("editor.img_album"),handler:()=>{uni.chooseImage({count:1,sourceType:["album"],success:e=>q(e)})}}],S.value=!0},q=e=>{const t=e.tempFilePaths[0];setTimeout((()=>{d.value&&d.value.insertImage({src:t,width:"80%",alt:"image",success:function(){i("log","at components/Todo/TodoEditor.vue:473","Chèn ảnh thành công")},fail:function(e){i("error","at components/Todo/TodoEditor.vue:476","Chèn ảnh thất bại",e)}})}),200)},Y=()=>{uni.createSelectorQuery().in(m).select(`#${c.value}`).context((e=>{if(e&&e.context&&(d.value=e.context,o.modelValue)){const{cleanHtml:e,links:t}=Pa(o.modelValue);w.value=t,d.value.setContents({html:e}),p.value=e}})).exec()},G=e=>{N.value=!1,g.value=!0;const t=e.detail.html;p.value=t;const a=Ua(t,w.value);l("update:modelValue",a)},K=e=>{u.value=e.detail,h.value=!!e.detail.link,e.detail.link?(E.value=e.detail.link,N.value=!0,d.value&&("function"==typeof d.value.getSelectionRect?d.value.getSelectionRect({success:e=>{e&&void 0!==e.bottom?(V.value="bottom",x.value=e.bottom+8):V.value="fixed"},fail:()=>{V.value="fixed"}}):V.value="fixed")):N.value=!1},J=(e,t=null)=>{d.value&&d.value.format(e,t)},Q=e=>{J(b.value,e||null),k.value=!1},X=()=>{k.value=!1},Z=()=>{h.value?(d.value.format("link",null),N.value=!1):(_.value="",f.value=!0)},ee=()=>{_.value&&d.value.format("link",_.value),f.value=!1},te=()=>{d.value.removeFormat()};return e.watch((()=>o.modelValue),(e=>{if(d.value){if(g.value)return void(g.value=!1);const{cleanHtml:t,links:a}=Pa(e||"");t!==p.value&&(d.value.setContents({html:t}),p.value=t),JSON.stringify(a)!==JSON.stringify(w.value)&&(w.value=a)}})),(a,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["editor-container",{"is-readonly":t.readOnly}])},[e.createElementVNode("view",{class:"editor-wrapper"},[e.createElementVNode("editor",{id:c.value,class:"ql-container",placeholder:t.readOnly?"":t.placeholder||a.$t("editor.placeholder"),"read-only":t.readOnly,"show-img-size":"","show-img-toolbar":"","show-img-resize":"",onReady:Y,onInput:G,onStatuschange:K},null,40,["id","placeholder","read-only"]),N.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["link-tooltip",{"is-fixed":"fixed"===V.value}]),style:e.normalizeStyle($.value),onClick:n[0]||(n[0]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"tooltip-content"},[e.createElementVNode("text",{class:"tooltip-url"},e.toDisplayString(E.value),1)]),e.createElementVNode("view",{class:"tooltip-actions"},[e.createElementVNode("view",{class:"t-btn",onClick:B},e.toDisplayString(a.$t("common.open_link")||"Mở"),1),e.createElementVNode("view",{class:"t-divider"}),e.createElementVNode("view",{class:"t-btn",onClick:M},e.toDisplayString(a.$t("common.copy_link")||"Copy"),1),e.createElementVNode("view",{class:"t-divider"}),e.createElementVNode("view",{class:"t-btn",onClick:I},e.toDisplayString(a.$t("common.edit_link")||"Sửa"),1)]),"fixed"!==V.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["tooltip-arrow",V.value])},null,2)):e.createCommentVNode("",!0)],6)):e.createCommentVNode("",!0)]),w.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"link-section-frame"},[e.createElementVNode("view",{class:"link-section-header",onClick:C},[e.createElementVNode("view",{class:"header-left"},[e.createElementVNode("image",{src:La,class:"header-icon"}),e.createElementVNode("text",{class:"header-title"},e.toDisplayString(a.$t("todo.attached_links"))+" ("+e.toDisplayString(w.value.length)+")",1)]),e.createElementVNode("image",{src:"https://img.icons8.com/ios-glyphs/30/666666/expand-arrow--v1.png",class:e.normalizeClass(["toggle-arrow",{open:D.value}])},null,2)]),D.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"link-list-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.value,((t,a)=>(e.openBlock(),e.createBlock(ja,{key:a,url:t,removable:!0,onRemove:e=>(e=>{w.value.splice(e,1),A()})(a)},null,8,["url","onRemove"])))),128))])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),t.readOnly?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"toolbar"},[e.createElementVNode("view",{class:"tool-list"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(s,((t,a)=>e.createElementVNode("view",{key:a,class:e.normalizeClass(["tool-item",{active:P(t)}]),onTouchend:e.withModifiers((e=>(e=>"header-menu"===e.action?H():"fontsize-menu"===e.action?j():"align-menu"===e.action?z():"color-picker"===e.action?(b.value="color",void(k.value=!0)):"bgcolor-picker"===e.action?(b.value="backgroundColor",void(k.value=!0)):void J(e.name,e.value))(t)),["prevent"])},[t.iconText?(e.openBlock(),e.createElementBlock("text",{key:0,style:e.normalizeStyle(t.style),class:e.normalizeClass(["txt-icon",{"txt-dynamic":t.action}])},e.toDisplayString(L(t)),7)):(e.openBlock(),e.createElementBlock("image",{key:1,src:F(t),class:"img-icon"},null,8,["src"]))],42,["onTouchend"]))),64)),e.createElementVNode("view",{class:"tool-divider"}),e.createElementVNode("view",{class:"tool-item",onTouchend:e.withModifiers(W,["prevent"])},[e.createElementVNode("image",{src:"/static/choseImage.png",class:"img-icon"})],32),e.createElementVNode("view",{class:e.normalizeClass(["tool-item",{active:h.value}]),onTouchend:e.withModifiers(Z,["prevent"])},[e.createElementVNode("image",{src:La,class:"img-icon"})],34),e.createElementVNode("view",{class:"tool-item",onTouchend:e.withModifiers(O,["prevent"])},[e.createElementVNode("image",{src:"/static/add-link.png",class:"img-icon"})],32),e.createElementVNode("view",{class:"tool-item",onTouchend:e.withModifiers(te,["prevent"])},[e.createElementVNode("text",{class:"txt-icon",style:{"font-size":"12px"}},"Clear")],32)])])),f.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal-overlay",onClick:n[4]||(n[4]=e=>f.value=!1)},[e.createElementVNode("view",{class:"modal-box",onClick:n[3]||(n[3]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(a.$t("editor.link_modal_title")),1),e.withDirectives(e.createElementVNode("input",{class:"modal-input","onUpdate:modelValue":n[1]||(n[1]=e=>_.value=e),placeholder:"https://example.com",focus:f.value},null,8,["focus"]),[[e.vModelText,_.value]]),e.createElementVNode("view",{class:"modal-actions"},[e.createElementVNode("button",{class:"btn-cancel",onClick:n[2]||(n[2]=e=>f.value=!1)},e.toDisplayString(a.$t("common.cancel")),1),e.createElementVNode("button",{class:"btn-confirm",onClick:ee},e.toDisplayString(a.$t("common.confirm")),1)])])])):e.createCommentVNode("",!0),v.value?(e.openBlock(),e.createElementBlock("view",{key:3,class:"modal-overlay",onClick:n[8]||(n[8]=e=>v.value=!1)},[e.createElementVNode("view",{class:"modal-box",onClick:n[7]||(n[7]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("text",{class:"modal-title"},e.toDisplayString(a.$t("editor.card_modal_title")),1),e.createElementVNode("text",{class:"modal-desc"},e.toDisplayString(a.$t("editor.card_modal_desc")),1),e.withDirectives(e.createElementVNode("input",{class:"modal-input","onUpdate:modelValue":n[5]||(n[5]=e=>y.value=e),placeholder:"https://youtube.com/...",focus:v.value},null,8,["focus"]),[[e.vModelText,y.value]]),e.createElementVNode("view",{class:"modal-actions"},[e.createElementVNode("button",{class:"btn-cancel",onClick:n[6]||(n[6]=e=>v.value=!1)},e.toDisplayString(a.$t("common.cancel")),1),e.createElementVNode("button",{class:"btn-confirm",onClick:R},e.toDisplayString(a.$t("common.confirm")),1)])])])):e.createCommentVNode("",!0),k.value?(e.openBlock(),e.createElementBlock("view",{key:4,class:"modal-overlay",onClick:X},[e.createElementVNode("view",{class:"modal-box color-box",onClick:n[12]||(n[12]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"color-tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["color-tab",{active:"color"===b.value}]),onClick:n[9]||(n[9]=e=>b.value="color")},e.toDisplayString(a.$t("editor.color_text")),3),e.createElementVNode("view",{class:e.normalizeClass(["color-tab",{active:"backgroundColor"===b.value}]),onClick:n[10]||(n[10]=e=>b.value="backgroundColor")},e.toDisplayString(a.$t("editor.color_bg")),3)]),e.createElementVNode("view",{class:"color-grid"},[e.createElementVNode("view",{class:"color-circle no-color",onClick:n[11]||(n[11]=e=>Q(""))},[e.createElementVNode("text",{class:"x-mark"},"✕")]),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(r,((t,a)=>{return e.createElementVNode("view",{key:a,class:e.normalizeClass(["color-circle",{selected:(n=t,u.value[b.value]===n)}]),style:e.normalizeStyle({backgroundColor:t}),onClick:e=>Q(t)},null,14,["onClick"]);var n})),64))])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["custom-sheet-mask",{show:S.value}]),onClick:U},[e.createElementVNode("view",{class:"custom-sheet-panel",onClick:n[13]||(n[13]=e.withModifiers((()=>{}),["stop"]))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(T.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"sheet-item",onClick:e=>(e=>{e.handler(),U()})(t)},[e.createElementVNode("text",null,e.toDisplayString(t.text),1)],8,["onClick"])))),128)),e.createElementVNode("view",{class:"sheet-gap"}),e.createElementVNode("view",{class:"sheet-item cancel",onClick:U},[e.createElementVNode("text",null,e.toDisplayString(a.$t("common.cancel")),1)])])],2)],2))}}),[["__scopeId","data-v-e779cdfa"]]),Wa=a(e.defineComponent({__name:"TodoDatePicker",props:{dueDate:{},notifyAt:{}},emits:["update:dueDate","update:notifyAt","change"],setup(t,{emit:a}){const n=a;lt();const i=e=>{n("update:dueDate",e),n("change",{field:"dueDate",value:e})},l=e=>{n("update:notifyAt",e),n("change",{field:"notifyAt",value:e})},s=e=>{if(!e)return"";try{const t=new Date(e.replace(/-/g,"/"));if(isNaN(t.getTime()))return e;const a=t.getDate().toString().padStart(2,"0"),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getFullYear(),o=t.getHours().toString().padStart(2,"0");return`${a}/${n}/${i} ${o}:${t.getMinutes().toString().padStart(2,"0")}`}catch(t){return e}};return(t,a)=>{const n=o(e.resolveDynamicComponent("uni-datetime-picker"),N);return e.openBlock(),e.createElementBlock("view",{class:"flat-item date-compound-block"},[e.createElementVNode("view",{class:"item-left icon-top-aligned"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/clock--v1.png",class:"item-icon"})]),e.createElementVNode("view",{class:"right-column"},[e.createElementVNode("view",{class:"date-row"},[e.createVNode(n,{type:"datetime",value:t.dueDate,"hide-second":!0,border:!1,onChange:i,class:"full-width-picker"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["item-picker",{"placeholder-color":!t.dueDate}])},[e.createElementVNode("text",{class:"picker-label"},e.toDisplayString(t.$t("todo.due_date_label")),1),e.createElementVNode("text",{class:"picker-value"},e.toDisplayString(t.dueDate?s(t.dueDate):t.$t("todo.select_date")),1)],2)])),_:1},8,["value"])]),e.createElementVNode("view",{class:"inner-divider"}),e.createElementVNode("view",{class:"date-row"},[e.createVNode(n,{type:"datetime",value:t.notifyAt,"hide-second":!0,border:!1,onChange:l,class:"full-width-picker"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["item-picker",{"placeholder-color":!t.notifyAt}])},[e.createElementVNode("text",{class:"picker-label"},e.toDisplayString(t.$t("todo.notify_date_label")),1),e.createElementVNode("text",{class:"picker-value"},e.toDisplayString(t.notifyAt?s(t.notifyAt):t.$t("todo.select_date")),1)],2)])),_:1},8,["value"])])])])}}}),[["__scopeId","data-v-a1d1474f"]]),qa=a(e.defineComponent({__name:"create_todo",setup(t){const a=ia(),n=e.computed((()=>a.isDark)),{loading:i,form:o,goBack:l,submitForm:s,memberOptions:r,onMemberChange:c,currentAssigneeName:d,showCustomerModal:u,loadingCustomer:m,customerList:h,openCustomerPopup:p,onCustomerSelect:g,sourceOptions:f,sourceIndex:_,onSourceChange:v,memberList:y,onCustomerFilter:k,loadingMore:b,loadMoreCustomers:w}=Aa(),D=e.computed((()=>{if(!o.value.assignee||!y.value.length)return 0;const e=y.value.findIndex((e=>e.memberUID===o.value.assignee));return-1!==e?e:0}));return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["container",{"theme-dark":n.value}])},[e.createElementVNode("view",{class:"custom-header"},[e.createElementVNode("view",{onClick:a[0]||(a[0]=(...t)=>e.unref(l)&&e.unref(l)(...t)),class:"back-btn"},[e.createElementVNode("image",{src:Oa,class:"back-icon"})]),e.createElementVNode("text",{class:"header-title"},e.toDisplayString(t.$t("todo.create_page_title")),1),e.createElementVNode("view",{class:"header-right"})]),e.createElementVNode("view",{class:"content-body"},[e.createElementVNode("view",{class:"flat-item title-input-group"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/edit--v1.png",class:"item-icon"})]),e.withDirectives(e.createElementVNode("textarea",{class:"item-input title-textarea","onUpdate:modelValue":a[1]||(a[1]=t=>e.unref(o).name=t),placeholder:t.$t("todo.enter_task_name"),maxlength:"256","auto-height":"","placeholder-class":"input-placeholder"},null,8,["placeholder"]),[[e.vModelText,e.unref(o).name]]),e.createElementVNode("text",{class:"char-count"},e.toDisplayString(t.$t("todo.char_count").replace("{current}",String(e.unref(o).name?e.unref(o).name.length:0)).replace("{max}","256")),1)]),e.createVNode(Ha,{modelValue:e.unref(o).desc,"onUpdate:modelValue":a[2]||(a[2]=t=>e.unref(o).desc=t),placeholder:t.$t("editor.placeholder")},null,8,["modelValue","placeholder"]),e.createElementVNode("view",{class:"flat-item",onClick:a[3]||(a[3]=(...t)=>e.unref(p)&&e.unref(p)(...t))},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/price-tag.png",class:"item-icon"})]),e.createElementVNode("view",{class:e.normalizeClass(["input-trigger",{placeholder:!e.unref(o).customer}])},e.toDisplayString(e.unref(o).customer||t.$t("todo.select_customer")),3),e.createElementVNode("text",{class:"arrow-icon"},"›")]),e.createVNode(dt,{visible:e.unref(u),loading:e.unref(m),loadingMore:e.unref(b),customers:e.unref(h),managers:e.unref(y),onClose:a[4]||(a[4]=e=>u.value=!1),onSelect:e.unref(g),onFilter:e.unref(k),onLoadMore:e.unref(w)},null,8,["visible","loading","loadingMore","customers","managers","onSelect","onFilter","onLoadMore"]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/internet.png",class:"item-icon"})]),e.createVNode(T,{range:e.unref(f),value:e.unref(_)>-1?e.unref(_):0,onChange:e.unref(v),class:"full-width-picker",title:t.$t("todo.source")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["picker-display",{"placeholder-color":-1===e.unref(_)}])},e.toDisplayString(e.unref(_)>-1?e.unref(f)[e.unref(_)]:t.$t("todo.select_source")),3)])),_:1},8,["range","value","onChange","title"]),e.createElementVNode("text",{class:"arrow-icon"},"›")]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"https://img.icons8.com/ios/50/666666/user.png",class:"item-icon"})]),e.createVNode(T,{range:e.unref(r),value:D.value,onChange:e.unref(c),class:"full-width-picker",title:t.$t("todo.assignee")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["picker-display",{"placeholder-color":!e.unref(d)}])},e.toDisplayString(e.unref(d)?e.unref(d):t.$t("todo.assignee")),3)])),_:1},8,["range","value","onChange","title"]),e.createElementVNode("text",{class:"arrow-icon"},"›")]),e.createVNode(Wa,{class:e.normalizeClass({"theme-dark":n.value}),dueDate:e.unref(o).dueDate,"onUpdate:dueDate":a[5]||(a[5]=t=>e.unref(o).dueDate=t),notifyAt:e.unref(o).notifyAt,"onUpdate:notifyAt":a[6]||(a[6]=t=>e.unref(o).notifyAt=t)},null,8,["class","dueDate","notifyAt"]),e.createElementVNode("view",{class:"footer-action"},[e.createElementVNode("view",{style:{width:"35%"}},[e.createVNode(xa,{type:"secondary",label:t.$t("common.cancel_action"),onClick:e.unref(l)},null,8,["label","onClick"])]),e.createElementVNode("view",{style:{width:"60%"}},[e.createVNode(xa,{type:"primary",label:e.unref(i)?t.$t("common.saving"):t.$t("common.save"),loading:e.unref(i),onClick:e.unref(s)},null,8,["label","loading","onClick"])])])]),e.createVNode(Va),e.createVNode(Ma)],2))}}),[["__scopeId","data-v-4217af84"]]),Ya=e=>{if(!e||e<=0)return"";try{const t=new Date(e),a=t.getFullYear(),n=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0"),o=t.getHours().toString().padStart(2,"0"),l=t.getMinutes().toString().padStart(2,"0");return`${a}-${n}-${i} ${o}:${l}:${"00"}`}catch{return""}},Ga=e=>{if(!e)return null;let t=[la,sa,ra].indexOf(e.status);-1===t&&(t=0);let a=[Bt,Mt,It,Ot].indexOf(e.links);return-1===a&&(a=0),e.notificationReceivedAt,{id:e.id,title:e.title||"",code:e.code||"",desc:e.description||"",statusIndex:t,sourceIndex:a,assigneeIndex:0,assigneeId:e.assigneeId||"",dueDate:Ya(e.dueDate),notifyAt:Ya(e.notificationReceivedAt),customerCode:e.customerCode||"",customerName:"",customerNameLabel:"Tên khách hàng",customerPhone:"",customerPhoneLabel:"Số điện thoại",customerManagerName:"",raw:e}},Ka=()=>{const{t:t}=lt(),a=ia(),n=e.computed((()=>a.uid)),o=e.ref(!1),l=e.ref(!1),s=e.ref(!1),r=e.ref([]),c=e.ref(!1),m=e.ref([]),h=e.ref(!1),p=e.ref(!1),g=e.ref(""),f=e.ref(!1),_=e.ref(!1),v=e.ref(null),y=e.ref(!1),k=e.ref(""),b=e.ref(!1),w=e.ref(!1),D=e.ref(!1),C=e.ref(null),S=e.ref(""),T=e.ref(!1),N=e.ref(null),x=e.ref(0),V=e.computed((()=>[t("todo.filter_activity_all"),t("todo.filter_activity_comment")])),$=["","COMMENT"],B=e.ref(!1),M=e.ref(""),R=e.computed((()=>G.value.raw&&"DONE"===G.value.raw.status)),A=e.computed((()=>!G.value.raw||"DONE"===G.value.raw.status)),L=e=>{if(!e)return!0;if(e.includes("<img")||e.includes("<iframe"))return!1;let t=e.replace(/&nbsp;/gi," ");return t=t.replace(/<[^>]+>/g,""),0===t.trim().length},F=async e=>{if(!e)return{cleanMessage:"",fileUrl:""};const t=/<img[^>]+src="([^">]+)"[^>]*>/g;let a,n="",o=e;const l=[];for(;null!==(a=t.exec(e));){const e=a[0],t=a[1];if(o=o.replace(e,""),t.startsWith("http")||t.startsWith("https"))n=t;else{const e=ka(t).then((e=>e)).catch((e=>(i("error","at controllers/todo_detail.ts:215","Upload ảnh bình luận lỗi:",e),"")));l.push(e)}}if(l.length>0){const e=(await Promise.all(l)).find((e=>""!==e));e&&(n=e)}return o=o.trim(),{cleanMessage:o,fileUrl:n}},P=()=>{D.value=!1,z()},U=()=>{const e=String(a.uid),t=J.value.find((t=>String(t.UID)===e));return t?t.memberUID:e},z=()=>{w.value=!1,C.value=null,M.value="",S.value="",g.value=""},j=()=>{T.value=!1,N.value=null},H=e.ref(null),W=e.ref(0),q=e.computed((()=>[t("todo.history_all"),t("todo.history_todo"),t("todo.history_ticket"),t("todo.history_call"),t("todo.history_customer"),t("todo.history_note")])),Y=["ALL","TODO","TICKET","HISTORY_CALL","CUSTOMER","NOTE"],G=e.ref({id:"",title:"",code:t("common.loading"),desc:"",statusIndex:0,sourceIndex:0,assigneeIndex:0,assigneeId:"",dueDate:"",notifyAt:"",customerCode:"",customerName:"",customerNameLabel:"",customerPhone:"",customerPhoneLabel:"",customerManagerName:"",customerManagerLabel:"",raw:void 0}),K=e.computed((()=>[t("source.call"),t("source.customer"),t("source.conversation"),t("source.message")])),J=e.ref([]),Q=e.ref([]),X=e.computed((()=>{const e=[{label:t("todo.status_todo"),value:"TO_DO"},{label:t("todo.status_progress"),value:"IN_PROGRESS"},{label:t("todo.status_done"),value:"DONE"}];return G.value.raw&&"IN_PROGRESS"===G.value.raw.status?e.filter((e=>"TO_DO"!==e.value)):e})),Z=e.computed((()=>X.value.map((e=>e.label)))),ee=()=>{y.value=!1,H.value=null,g.value="",k.value=""};d((async e=>{if(te(),e){if(e.preload)try{const t=JSON.parse(decodeURIComponent(e.preload));i("log","at controllers/todo_detail.ts:841","Preload Data:",t);const a=Ga(t);if(a){G.value={...G.value,...a,id:t.id};const e=a.raw.status,n=X.value.findIndex((t=>t.value===e));-1!==n&&(G.value.statusIndex=n)}}catch(t){i("error","at controllers/todo_detail.ts:862","Lỗi parse preload:",t)}e.id&&(G.value.id||(G.value.id=e.id),ae(e.id))}}));const te=async()=>{try{const e=await Jt();if(J.value=e,Q.value=e.map((e=>e.UserName||t("common.unknown_member"))),G.value.assigneeId){const e=J.value.findIndex((e=>e.memberUID===G.value.assigneeId));-1!==e&&(G.value.assigneeIndex=e)}}catch(e){i("error","at controllers/todo_detail.ts:887","Lỗi lấy members",e)}};u((()=>{i("log","at controllers/todo_detail.ts:908","Refreshing detail..."),(async()=>{if(G.value.id)try{await Promise.all([ae(G.value.id)])}catch(e){i("error","at controllers/todo_detail.ts:901",e)}finally{uni.stopPullDownRefresh()}else uni.stopPullDownRefresh()})()}));const ae=async e=>{G.value.title,o.value=!0,p.value=!0;try{const t=await(e=>{const t=ia();return oa({url:`${Gt}/getDetail`,method:"GET",data:{id:e,projectCode:t.projectCode}})})(e),a=t&&t.data&&!t.id?t.data:t,n=Ga(a);if(n){G.value=n;const t=n.raw.status,a=X.value.findIndex((e=>e.value===t));if(-1!==a&&(G.value.statusIndex=a),G.value.assigneeId&&J.value.length>0){const e=J.value.findIndex((e=>e.memberUID===G.value.assigneeId));-1!==e&&(G.value.assigneeIndex=e)}ie(e),G.value.customerCode&&(oe(G.value.customerCode),le(G.value.customerCode))}}catch(a){i("error","at controllers/todo_detail.ts:956","Lỗi lấy chi tiết:",a),Da(t("common.error_connection"))}finally{o.value=!1,p.value=!1,uni.hideNavigationBarLoading()}},ne=e=>{var n;let i=t("todo.user_hidden"),o="?",l="#e3f2fd",s=!1;const r=String(a.uid);if(e.senderId){const t=String(e.senderId),a=J.value.find((e=>String(e.UID)===t||String(e.memberUID)===t));a?(i=a.UserName,a.AvatarColor&&(l=a.AvatarColor),String(a.UID)===r&&(s=!0)):t===r&&(s=!0)}o=i.charAt(0).toUpperCase();let c="";switch(e.type){case"NEW_TODO":c=t("todo.action_NEW_TODO");break;case"REOPEN_TODO":c=t("todo.action_REOPEN_TODO");break;case"NEW_SUB_TODO":c=t("todo.action_NEW_SUB_TODO");break;case"UPDATE_TODO":c=t("todo.action_UPDATE_TODO");break;case"UPLOAD_ATTACHMENT":c=t("todo.action_UPLOAD_ATTACHMENT");break;case"COMMENT":c=t("todo.action_COMMENT");break;default:c=""}const d=(null==(n=e.reactions)?void 0:n.details)||[];return{id:e.id,senderId:e.senderId,senderName:i,senderAvatarChar:o,senderAvatarColor:l,message:e.message||"",files:e.files||"",timeDisplay:E(e.createdAt,t),actionText:c,isEdited:!!e.updatedAt,type:e.type,reactions:d,children:[],isMe:s}},ie=async e=>{h.value=!0;try{const t=$[x.value],a=await((e,t="")=>oa({url:`${Wt}/api/module-todo/todoMessages/getAllNoPageWithReact`,method:"GET",data:{todoId:e,keySearch:t}}))(e,t);Array.isArray(a)?m.value=a.map((e=>{const t=ne(e);return e.replies&&e.replies.length>0&&(t.children=e.replies.map((t=>{const a=ne(t);return a.rootParentId=e.id,a}))),t})):m.value=[]}catch(t){i("error","at controllers/todo_detail.ts:1061","Lỗi lấy bình luận:",t)}finally{h.value=!1}},oe=async e=>{var n;l.value=!0;try{const i=a.todoToken;if(!i)return;const o=await((e,t)=>oa({url:`${qt}/Customer/getDetail`,method:"GET",data:{uid:t},header:{Authorization:`Bearer ${e}`}}))(i,e),s=o.fields||(null==(n=o.data)?void 0:n.fields)||[],r=s.find((e=>"name"===e.code)),c=s.find((e=>"phone"===e.code)),d=s.find((e=>"member_no"===e.code));if(r&&(G.value.customerName=r.value,G.value.customerNameLabel=r.name||t("todo.customer_name_label")),c&&(G.value.customerPhone=c.value,G.value.customerPhoneLabel=c.name),d){G.value.customerManagerLabel=d.name||t("todo.customer_manager_label");const e=d.value,a=J.value.find((t=>t.memberUID===e));G.value.customerManagerName=a?a.UserName:t("todo.unknown")}}catch(o){i("error","at controllers/todo_detail.ts:1119","Lỗi CRM:",o)}finally{l.value=!1}},le=async e=>{s.value=!0;try{const n=Y[W.value],o=a.todoToken;if(!o)return void i("error","at controllers/todo_detail.ts:1131","Chưa có Token CRM/Todo");const l=await((e,t,a="ALL")=>oa({url:`${qt}/ActionTimeline/getAll?from=-1&to=-1&customerUid=${t}&type=${a}&page=1&size=10&memberUid=&projectCode=`,method:"GET",header:{Authorization:`Bearer ${e}`}}))(o,e,n);Array.isArray(l)&&(r.value=l.map((e=>{const a=new Date(e.createAt),n=`${a.getDate().toString().padStart(2,"0")}/${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getFullYear()}`;let i=t("common.system");if(e.memberUid){const t=J.value.find((t=>t.memberUID===e.memberUid));t&&(i=t.UserName)}let o="";if(e.typeSub){const a=`timeline.${e.typeSub}`;o=t(a),o===a&&(o=ma[e.typeSub]||e.typeSub)}else o=t("todo.interaction_other");return{id:e.id,timeStr:n,content:o,actorName:i,originalType:e.typeSub}})))}catch(n){i("error","at controllers/todo_detail.ts:1178","Lỗi lấy lịch sử:",n)}finally{s.value=!1}};return{isLoading:o,isLoadingCustomer:l,isLoadingHistory:s,historyList:r,form:G,statusOptions:Z,sourceOptions:K,assigneeOptions:Q,onStatusChange:async e=>{const a=parseInt(e.detail.value),n=X.value[a];if(!n)return;G.value.statusIndex=a;const l=n.value;if(G.value.raw){o.value=!0;try{const e={...G.value.raw,status:l,preFixCode:"TODO",description:G.value.desc,files:"",tagCodes:"",title:G.value.title||G.value.raw.title};i("log","at controllers/todo_detail.ts:1225","Payload Update Status:",e);if(await _a(e)){wa(t("todo.msg_status_changed")),G.value.raw.status=l;const e=X.value.findIndex((e=>e.value===l));G.value.statusIndex=-1!==e?e:0,G.value.customerCode&&await le(G.value.customerCode),await ie(G.value.id)}}catch(s){i("error","at controllers/todo_detail.ts:1241","Lỗi cập nhật trạng thái:",s),Da(t("todo.msg_update_error"))}finally{o.value=!1}}},onSourceChange:e=>{G.value.sourceIndex=e.detail.value},onAssigneeChange:async e=>{const a=parseInt(e.detail.value);if(!J.value[a])return;const n=J.value[a].memberUID;if(G.value.assigneeIndex=a,G.value.assigneeId=n,G.value.raw){o.value=!0;try{const e={...G.value.raw,assigneeId:n,preFixCode:"TODO",description:G.value.desc,files:"",tagCodes:"",title:G.value.title||G.value.raw.title};i("log","at controllers/todo_detail.ts:1285","Payload Update Assignee:",e);await _a(e)&&(wa(t("todo.msg_assignee_changed")),G.value.raw.assigneeId=n,G.value.customerCode&&await le(G.value.customerCode),await ie(G.value.id))}catch(l){i("error","at controllers/todo_detail.ts:1303","Lỗi cập nhật người giao:",l),Da(t("todo.msg_update_error"))}finally{o.value=!1}}else Da(t("common.error_missing_data"))},goBack:()=>{uni.navigateBack()},saveTodo:()=>{i("log","at controllers/todo_detail.ts:1312","Lưu:",G.value),wa(t("todo.msg_saved"))},historyFilterOptions:q,historyFilterIndex:W,onHistoryFilterChange:e=>{W.value=e.detail.value,G.value.customerCode&&le(G.value.customerCode)},comments:m,isLoadingComments:h,newCommentText:g,isSubmittingComment:f,submitComment:async()=>{if(L(g.value))Ca(t("todo.msg_empty_content"));else{f.value=!0;try{const{cleanMessage:e,fileUrl:a}=await F(g.value),n=G.value.id,i={todoId:n,senderId:U(),message:e,files:a,parentId:-1},o=await va(i);if(o){wa(t("todo.msg_comment_success")),g.value="";const e=await ya(o,n);if(e){const t=ne(e);m.value.unshift(t)}}}catch(e){i("error","at controllers/todo_detail.ts:826","Lỗi gửi bình luận:",e),Da(t("common.error_send"))}finally{f.value=!1}}},isConfirmDeleteCommentOpen:_,onRequestDeleteComment:e=>{v.value=e,_.value=!0},confirmDeleteComment:async()=>{if(!v.value)return;const e=v.value;_.value=!1;try{await(a=e,oa({url:`${Wt}/api/module-todo/todoMessages/delete`,method:"POST",data:{id:a}})),wa(t("todo.msg_deleted"));const n=m.value.findIndex((t=>t.id===e));if(-1!==n)m.value.splice(n,1);else for(const t of m.value)if(t.children&&t.children.length>0){const a=t.children.findIndex((t=>t.id===e));if(-1!==a){t.children.splice(a,1);break}}}catch(n){i("error","at controllers/todo_detail.ts:778","Lỗi xóa bình luận:",n),Da(t("common.fail_delete"))}finally{v.value=null}var a},cancelDeleteComment:()=>{_.value=!1,v.value=null},currentUserId:n,isEditingComment:y,onRequestEditComment:async a=>{const n=G.value.id;if(n){w.value=!1,C.value=null,S.value="",M.value="";try{const l=await ya(a,n);if(i("log","at controllers/todo_detail.ts:637","API Response Detail:",l),l){const a=l.data||l;H.value={id:a.id,todoId:a.todoId,senderId:a.senderId};const n=a.senderId,o=J.value.find((e=>e.UID===n));k.value=o?o.UserName:t("common.me");const s=a.message||"";i("log","at controllers/todo_detail.ts:654","Nội dung edit:",s),y.value=!0,await e.nextTick(),g.value=s}}catch(l){i("error","at controllers/todo_detail.ts:660","Lỗi lấy chi tiết bình luận:",l),Da(t("common.error_load"))}finally{o.value=!1}}},submitUpdateComment:async()=>{if(H.value)if(L(g.value))Ca(t("todo.msg_empty_content"));else{f.value=!0;try{const{cleanMessage:a,fileUrl:n}=await F(g.value),i={id:H.value.id,todoId:H.value.todoId,senderId:H.value.senderId,message:a,files:n},o=await(e=i,oa({url:`${Wt}/api/module-todo/todoMessages/update`,method:"POST",data:e}));if(o){wa(t("todo.msg_update_success"));const e=m.value.findIndex((e=>e.id===o.id));if(-1!==e)m.value[e].message=o.message,m.value[e].files=o.files,m.value[e].isEdited=!0;else for(const t of m.value)if(t.children){const e=t.children.findIndex((e=>e.id===o.id));if(-1!==e){t.children[e].message=o.message,t.children[e].files=o.files,t.children[e].isEdited=!0;break}}ee()}}catch(a){i("error","at controllers/todo_detail.ts:718","Lỗi cập nhật:",a),Da(t("common.error_update"))}finally{f.value=!1}var e}},onCancelEditComment:()=>{b.value=!0},isConfirmCancelEditOpen:b,continueEditing:()=>{b.value=!1},confirmCancelEdit:async()=>{b.value=!1,ee()},editingMemberName:k,isEmojiPickerOpen:T,emojiList:["👍","👎","😍","😆","😱","😭","😤"],onToggleEmojiPicker:e=>{N.value=e,T.value=!0},closeEmojiPicker:j,selectEmoji:async e=>{if(!N.value)return;const n=N.value.id;j();const o=G.value.id,l=a.uid,s={todoId:Number(o),senderId:l,todoMessageId:Number(n),codeEmoji:e};try{if(await(r=s,oa({url:`${Wt}/api/module-todo/todoMessages/reaction`,method:"POST",data:r}))){let t=null;const a=m.value.findIndex((e=>e.id===n));if(-1!==a)t=m.value[a];else for(const e of m.value)if(e.children){const a=e.children.find((e=>e.id===n));if(a){t=a;break}}if(t){t.reactions||(t.reactions=[]);const a=t.reactions.findIndex((e=>e.senderId===l));if(-1!==a){t.reactions[a].codeEmoji===e?i("log","at controllers/todo_detail.ts:550","User thả trùng emoji cũ"):t.reactions[a].codeEmoji=e}else t.reactions.push({codeEmoji:e,senderId:l});t.reactions=[...t.reactions]}}}catch(c){i("error","at controllers/todo_detail.ts:568","Lỗi thả cảm xúc:",c),Da(t("common.error_connection"))}var r},isReplying:w,isConfirmCancelReplyOpen:D,replyingCommentData:C,replyingMemberName:S,onRequestReply:async a=>{y.value=!1,H.value=null,g.value="",C.value=a;const n=a.message||"",{cleanHtml:i}=Pa(n);M.value=i,w.value=!0;const o=a.senderId,l=J.value.find((e=>e.memberUID===o));S.value=l?l.UserName:t("todo.user_hidden"),await e.nextTick()},onCancelReply:()=>{g.value.trim()?D.value=!0:P()},confirmCancelReply:P,continueReplying:()=>{D.value=!1},submitReply:async()=>{if(L(g.value))Ca(t("todo.msg_empty_content"));else if(C.value){f.value=!0;try{const{cleanMessage:e,fileUrl:a}=await F(g.value),n=G.value.id,i=U();let o=C.value.id;C.value.rootParentId&&(o=C.value.rootParentId);const l={todoId:n,senderId:i,message:e,files:a,parentId:o},s=await va(l);if(s){wa(t("todo.msg_reply_success"));const e=await ya(s,G.value.id),a=ne(e),n=C.value.rootParentId||C.value.id,i=m.value.find((e=>e.id===n));i&&(i.children||(i.children=[]),a.rootParentId=n,i.children.push(a)),z()}}catch(e){i("error","at controllers/todo_detail.ts:472","Lỗi gửi trả lời:",e),Da(t("common.error_send"))}finally{f.value=!1}}},commentFilterIndex:x,commentFilterOptions:V,onCommentFilterChange:e=>{const t=e.detail.value;x.value!==t&&(x.value=t,G.value.id&&ie(G.value.id))},isSavingDescription:B,onSaveDescription:async()=>{if(!R.value)if(G.value.raw){B.value=!0;try{const{newContent:e,fileUrls:a}=await(async e=>{if(!e)return{newContent:"",fileUrls:[]};const t=/<img[^>]+src="([^">]+)"/g;let a;const n=[],o=[],l=[];for(;null!==(a=t.exec(e));){const e=a[1];if(!e.startsWith("http")&&!e.startsWith("https")){const t=ka(e).then((t=>{o.push({oldSrc:e,newSrc:t}),l.push(t)})).catch((e=>{i("error","at controllers/todo_detail.ts:255","Upload ảnh detail lỗi:",e)}));n.push(t)}}n.length>0&&await Promise.all(n);let s=e;return o.forEach((e=>{s=s.split(e.oldSrc).join(e.newSrc)})),{newContent:s,fileUrls:l}})(G.value.desc);G.value.desc=e;const n=a.length>0?a.join(","):"",o={...G.value.raw,preFixCode:"TODO",description:G.value.desc,files:n,tagCodes:"",title:G.value.title||G.value.raw.title};i("log","at controllers/todo_detail.ts:300","Payload Update Description:",o);await _a(o)&&(wa(t("todo.msg_desc_saved")),G.value.raw.description=G.value.desc,n&&(G.value.raw.files=n),await ie(G.value.id))}catch(e){i("error","at controllers/todo_detail.ts:315","Lỗi cập nhật công việc:",e),Da(t("common.error_update"))}finally{B.value=!1}}else Da(t("common.error_missing_data"))},onDateUpdate:async e=>{if(R.value)return;if(!G.value.raw)return;let a=G.value.dueDate,n=G.value.notifyAt;"dueDate"===e.field?a=e.value:"notifyAt"===e.field&&(n=e.value);if(!I(a,n))return Ca(t("todo.msg_notify_must_be_before_due")),"dueDate"===e.field?G.value.dueDate:G.value.notifyAt,void("dueDate"===e.field?G.value.dueDate=G.value.raw.dueDate?O(G.value.raw.dueDate):"":G.value.notifyAt=G.value.raw.notificationReceivedAt?O(G.value.raw.notificationReceivedAt):"");o.value=!0;try{const a={...G.value.raw,preFixCode:"TODO",description:G.value.desc,files:"",tagCodes:"",title:G.value.title||G.value.raw.title},n=(e=>{if(!e)return 0;try{const t=e.replace(/-/g,"/");return new Date(t).getTime()}catch{return 0}})(e.value);"dueDate"===e.field?a.dueDate=n:"notifyAt"===e.field&&(a.notificationReceivedAt=n),i("log","at controllers/todo_detail.ts:149",`Payload Update ${e.field}:`,a);await _a(a)&&(wa(t("todo.msg_update_success")),"dueDate"===e.field?(G.value.raw.dueDate=a.dueDate,G.value.dueDate=e.value):(G.value.raw.notificationReceivedAt=a.notificationReceivedAt,G.value.notifyAt=e.value),G.value.customerCode&&await le(G.value.customerCode),await ie(G.value.id))}catch(l){i("error","at controllers/todo_detail.ts:167","Lỗi cập nhật ngày:",l),Da(t("todo.msg_update_error")),"dueDate"===e.field?G.value.dueDate=O(G.value.raw.dueDate):G.value.notifyAt=O(G.value.raw.notificationReceivedAt)}finally{o.value=!1}},isStatusDisabled:A,dynamicStatusOptions:X,onSaveTitle:async()=>{if(R.value)return;if(!G.value.raw)return;const e=G.value.title?G.value.title.trim():"",a=G.value.raw.title;if(!e)return Ca(t("todo.msg_title_empty")),void(G.value.title=a);if(e!==a){o.value=!0;try{const a={...G.value.raw,title:e,preFixCode:"TODO",description:G.value.raw.description,files:G.value.raw.files||"",tagCodes:G.value.raw.tagCodes||""};i("log","at controllers/todo_detail.ts:350","Payload Update Title:",a);await _a(a)&&(wa(t("todo.msg_title_changed")),G.value.raw.title=e,G.value.customerCode&&await le(G.value.customerCode),await ie(G.value.id))}catch(n){i("error","at controllers/todo_detail.ts:365","Lỗi cập nhật tiêu đề:",n),Da(t("todo.msg_update_error")),G.value.title=a}finally{o.value=!1}}},replyingMessagePreview:M,isHistoryOpen:c,toggleHistory:()=>{c.value=!c.value},isDone:R}},Ja=e=>{(e.$wxs||(e.$wxs=[])).push("handler"),(e.$wxsModules||(e.$wxsModules={})).handler="37368788"},Qa={name:"node",options:{},data:()=>({ctrl:{},nodes:[]}),props:{name:String,attrs:{type:Object,default:()=>({})},childs:Array,opts:Array},watch:{childs:{handler(e){for(;this.nodes.length>e.length;)e.push({});this.nodes=e},immediate:!0}},components:{},mounted(){if(this.$nextTick((()=>{for(this.root=this.$parent;"mp-html"!==this.root.$options.name;this.root=this.root.$parent);})),this.opts[0]){let e;for(e=this.childs.length;e--&&"img"!==this.childs[e].name;);-1!==e&&(this.observer=uni.createIntersectionObserver(this).relativeToViewport({top:500,bottom:500}),this.observer.observe("._img",(e=>{e.intersectionRatio&&(this.$set(this.ctrl,"load",1),this.observer.disconnect())})))}},beforeDestroy(){this.observer&&this.observer.disconnect()},methods:{play(e){const t=e.currentTarget.dataset.i,a=this.childs[t];this.root.$emit("play",{source:a.name,attrs:{...a.attrs,src:a.src[this.ctrl[t]||0]}})},mediaEvent(e){const t=e.currentTarget.dataset.i,a=this.childs[t];this.root.$emit(e.type,{...e.detail,source:a.name,attrs:{...a.attrs,src:a.src[this.ctrl[t]||0]}})},imgTap(e){const t=this.childs[e.currentTarget.dataset.i];t.a?this.linkTap(t.a):t.attrs.ignore||(t.attrs.src=t.attrs.src||t.attrs["data-src"],this.root.$emit("imgtap",t.attrs),this.root.previewImg&&uni.previewImage({current:parseInt(t.attrs.i),urls:this.root.imgList}))},imgLongTap(e){const t=this.childs[e.currentTarget.dataset.i].attrs;this.opts[3]&&!t.ignore&&uni.showActionSheet({itemList:["保存图片"],success:()=>{const e=e=>{uni.saveImageToPhotosAlbum({filePath:e,success(){uni.showToast({title:"保存成功"})}})};this.root.imgList[t.i].startsWith("http")?uni.downloadFile({url:this.root.imgList[t.i],success:t=>e(t.tempFilePath)}):e(this.root.imgList[t.i])}})},imgLoad(e){const t=e.currentTarget.dataset.i;this.childs[t].w?(this.opts[1]&&!this.ctrl[t]||-1===this.ctrl[t])&&this.$set(this.ctrl,t,1):this.$set(this.ctrl,t,e.detail.width),this.checkReady()},checkReady(){this.root&&!this.root.lazyLoad&&(this.root._unloadimgs-=1,this.root._unloadimgs||setTimeout((()=>{this.root.getRect().then((e=>{this.root.$emit("ready",e)})).catch((()=>{this.root.$emit("ready",{})}))}),350))},linkTap(e){const t=e.currentTarget?this.childs[e.currentTarget.dataset.i]:{},a=t.attrs||e,n=a.href;this.root.$emit("linktap",Object.assign({innerText:this.root.getText(t.children||[])},a)),n&&("#"===n[0]?this.root.navigateTo(n.substring(1)).catch((()=>{})):n.split("?")[0].includes("://")?this.root.copyLink&&plus.runtime.openWeb(n):uni.navigateTo({url:n,fail(){uni.switchTab({url:n,fail(){}})}}))},mediaError(e){const t=e.currentTarget.dataset.i,a=this.childs[t];if("video"===a.name||"audio"===a.name){let e=(this.ctrl[t]||0)+1;if(e>a.src.length&&(e=0),e<a.src.length)return void this.$set(this.ctrl,t,e)}else"img"===a.name&&(this.opts[2]&&this.$set(this.ctrl,t,-1),this.checkReady());this.root&&this.root.$emit("error",{source:a.name,attrs:a.attrs,errMsg:e.detail.errMsg})}}};Ja(Qa);const Xa=a(Qa,[["render",function(t,a,n,i,o,l){const s=e.resolveComponent("node",!0);return e.openBlock(),e.createElementBlock("view",{id:n.attrs.id,class:e.normalizeClass("_block _"+n.name+" "+n.attrs.class),style:e.normalizeStyle(n.attrs.style)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.nodes,((t,i)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},["img"===t.name&&!t.t&&(n.opts[1]&&!o.ctrl[i]||o.ctrl[i]<0)?(e.openBlock(),e.createElementBlock("image",{key:0,class:"_img",style:e.normalizeStyle(t.attrs.style),src:o.ctrl[i]<0?n.opts[2]:n.opts[1],mode:"widthFix"},null,12,["src"])):e.createCommentVNode("",!0),"img"===t.name&&t.t?(e.openBlock(),e.createElementBlock("rich-text",{key:1,style:e.normalizeStyle("display:"+t.t),nodes:[{attrs:{style:t.attrs.style||"",src:t.attrs.src},name:"img"}],"data-i":i,onClick:a[0]||(a[0]=e.withModifiers(((...e)=>l.imgTap&&l.imgTap(...e)),["stop"]))},null,12,["nodes","data-i"])):"img"===t.name?(e.openBlock(),e.createElementBlock("image",{key:2,id:t.attrs.id,class:e.normalizeClass("_img "+t.attrs.class),style:e.normalizeStyle((-1===o.ctrl[i]?"display:none;":"")+"width:"+(o.ctrl[i]||1)+"px;"+t.attrs.style),src:t.attrs.src||(o.ctrl.load?t.attrs["data-src"]:""),mode:t.h?t.w?t.m||"":"heightFix":"widthFix","data-i":i,onLoad:a[1]||(a[1]=(...e)=>l.imgLoad&&l.imgLoad(...e)),onError:a[2]||(a[2]=(...e)=>l.mediaError&&l.mediaError(...e)),onClick:a[3]||(a[3]=e.withModifiers(((...e)=>l.imgTap&&l.imgTap(...e)),["stop"])),onLongpress:a[4]||(a[4]=(...e)=>l.imgLongTap&&l.imgLongTap(...e))},null,46,["id","src","mode","data-i"])):t.text?(e.openBlock(),e.createElementBlock("text",{key:3,decode:""},e.toDisplayString(t.text),1)):"br"===t.name?(e.openBlock(),e.createElementBlock("text",{key:4},e.toDisplayString("\n"))):"a"===t.name?(e.openBlock(),e.createElementBlock("view",{key:5,id:t.attrs.id,class:e.normalizeClass((t.attrs.href?"_a ":"")+t.attrs.class),"hover-class":"_hover",style:e.normalizeStyle("display:inline;"+t.attrs.style),"data-i":i,onClick:a[5]||(a[5]=e.withModifiers(((...e)=>l.linkTap&&l.linkTap(...e)),["stop"]))},[e.createVNode(s,{name:"span",childs:t.children,opts:n.opts,style:{display:"inherit"}},null,8,["childs","opts"])],14,["id","data-i"])):t.html?(e.openBlock(),e.createElementBlock("view",{key:6,id:t.attrs.id,class:e.normalizeClass("_video "+t.attrs.class),style:e.normalizeStyle(t.attrs.style),innerHTML:t.html,"data-i":i,onVplay:a[6]||(a[6]=e.withModifiers(((...e)=>l.play&&l.play(...e)),["stop"]))},null,46,["id","innerHTML","data-i"])):"iframe"===t.name?(e.openBlock(),e.createElementBlock("iframe",{key:7,style:e.normalizeStyle(t.attrs.style),allowfullscreen:t.attrs.allowfullscreen,frameborder:t.attrs.frameborder,src:t.attrs.src},null,12,["allowfullscreen","frameborder","src"])):"embed"===t.name?(e.openBlock(),e.createElementBlock("embed",{key:8,style:e.normalizeStyle(t.attrs.style),src:t.attrs.src},null,12,["src"])):"table"===t.name&&t.c||"li"===t.name?(e.openBlock(),e.createElementBlock("view",{key:9,id:t.attrs.id,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},["li"===t.name?(e.openBlock(),e.createBlock(s,{key:0,childs:t.children,opts:n.opts},null,8,["childs","opts"])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(t.children,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},["td"===t.name||"th"===t.name?(e.openBlock(),e.createBlock(s,{key:0,childs:t.children,opts:n.opts},null,8,["childs","opts"])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(t.children,((t,a)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:a},["td"===t.name||"th"===t.name?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},[e.createVNode(s,{childs:t.children,opts:n.opts},null,8,["childs","opts"])],6)):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.children,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass("_"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.attrs.style)},[e.createVNode(s,{childs:t.children,opts:n.opts},null,8,["childs","opts"])],6)))),128))],6))],64)))),128))],6)))),128))],14,["id"])):t.c?2===t.c?(e.openBlock(),e.createElementBlock("view",{key:11,id:t.attrs.id,class:e.normalizeClass("_block _"+t.name+" "+t.attrs.class),style:e.normalizeStyle(t.f+";"+t.attrs.style)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.children,((t,a)=>(e.openBlock(),e.createBlock(s,{key:a,style:e.normalizeStyle(t.f),name:t.name,attrs:t.attrs,childs:t.children,opts:n.opts},null,8,["style","name","attrs","childs","opts"])))),128))],14,["id"])):(e.openBlock(),e.createBlock(s,{key:12,style:e.normalizeStyle(t.f),name:t.name,attrs:t.attrs,childs:t.children,opts:n.opts},null,8,["style","name","attrs","childs","opts"])):(e.openBlock(),e.createElementBlock("rich-text",{key:10,id:t.attrs.id,style:e.normalizeStyle("display:inline;"+t.f),preview:!1,selectable:n.opts[4],"user-select":n.opts[4],nodes:[t]},null,12,["id","selectable","user-select","nodes"]))],64)))),128))],14,["id"])}],["__scopeId","data-v-749ddec3"]]),Za={trustTags:ln("a,abbr,ad,audio,b,blockquote,br,code,col,colgroup,dd,del,dl,dt,div,em,fieldset,h1,h2,h3,h4,h5,h6,hr,i,img,ins,label,legend,li,ol,p,q,ruby,rt,source,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,title,ul,video"),blockTags:ln("address,article,aside,body,caption,center,cite,footer,header,html,nav,pre,section"),inlineTags:ln("abbr,b,big,code,del,em,i,ins,label,q,small,span,strong,sub,sup"),ignoreTags:ln("area,base,canvas,embed,frame,head,iframe,input,link,map,meta,param,rp,script,source,style,textarea,title,track,wbr"),voidTags:ln("area,base,br,col,circle,ellipse,embed,frame,hr,img,input,line,link,meta,param,path,polygon,rect,source,track,use,wbr"),entities:{lt:"<",gt:">",quot:'"',apos:"'",ensp:" ",emsp:" ",nbsp:" ",semi:";",ndash:"–",mdash:"—",middot:"·",lsquo:"‘",rsquo:"’",ldquo:"“",rdquo:"”",bull:"•",hellip:"…",larr:"←",uarr:"↑",rarr:"→",darr:"↓"},tagStyle:{address:"font-style:italic",big:"display:inline;font-size:1.2em",caption:"display:table-caption;text-align:center",center:"text-align:center",cite:"font-style:italic",dd:"margin-left:40px",mark:"background-color:yellow",pre:"font-family:monospace;white-space:pre",s:"text-decoration:line-through",small:"display:inline;font-size:0.8em",strike:"text-decoration:line-through",u:"text-decoration:underline"},svgDict:{animatetransform:"animateTransform",lineargradient:"linearGradient",viewbox:"viewBox",attributename:"attributeName",repeatcount:"repeatCount",repeatdur:"repeatDur",foreignobject:"foreignObject"}},en={};let tn;const an=uni.getSystemInfoSync();tn=an.windowWidth;const nn=ln(" ,\r,\n,\t,\f");let on=0;function ln(e){const t=Object.create(null),a=e.split(",");for(let n=a.length;n--;)t[a[n]]=!0;return t}function sn(e,t){let a=e.indexOf("&");for(;-1!==a;){const n=e.indexOf(";",a+3);let i;if(-1===n)break;"#"===e[a+1]?(i=parseInt(("x"===e[a+2]?"0":"")+e.substring(a+2,n)),isNaN(i)||(e=e.substr(0,a)+String.fromCharCode(i)+e.substr(n+1))):(i=e.substring(a+1,n),(Za.entities[i]||"amp"===i&&t)&&(e=e.substr(0,a)+(Za.entities[i]||"&")+e.substr(n+1))),a=e.indexOf("&",a+1)}return e}function rn(e){let t=e.length-1;for(let a=t;a>=-1;a--)(-1===a||e[a].c||!e[a].name||"div"!==e[a].name&&"p"!==e[a].name&&"h"!==e[a].name[0]||(e[a].attrs.style||"").includes("inline"))&&(t-a>=5&&e.splice(a+1,t-a,{name:"div",attrs:{},children:e.slice(a+1,t+1)}),t=a-1)}function cn(e){this.options=e||{},this.tagStyle=Object.assign({},Za.tagStyle,this.options.tagStyle),this.imgList=e.imgList||[],this.imgList._unloadimgs=0,this.plugins=e.plugins||[],this.attrs=Object.create(null),this.stack=[],this.nodes=[],this.pre=(this.options.containerStyle||"").includes("white-space")&&this.options.containerStyle.includes("pre")?2:0}function dn(e){this.handler=e}Za.ignoreTags.iframe=void 0,Za.trustTags.iframe=!0,Za.ignoreTags.embed=void 0,Za.trustTags.embed=!0,cn.prototype.parse=function(e){for(let t=this.plugins.length;t--;)this.plugins[t].onUpdate&&(e=this.plugins[t].onUpdate(e,Za)||e);for(new dn(this).parse(e);this.stack.length;)this.popNode();return this.nodes.length>50&&rn(this.nodes),this.nodes},cn.prototype.expose=function(){for(let e=this.stack.length;e--;){const t=this.stack[e];if(t.c||"a"===t.name||"video"===t.name||"audio"===t.name)return;t.c=1}},cn.prototype.hook=function(e){for(let t=this.plugins.length;t--;)if(this.plugins[t].onParse&&!1===this.plugins[t].onParse(e,this))return!1;return!0},cn.prototype.getUrl=function(e){const t=this.options.domain;return"/"===e[0]?e="/"===e[1]?(t?t.split("://")[0]:"http")+":"+e:t?t+e:plus.io.convertLocalFileSystemURL(e):e.includes("data:")||e.includes("://")||(e=t?t+"/"+e:plus.io.convertLocalFileSystemURL(e)),e},cn.prototype.parseStyle=function(e){const t=e.attrs,a=(this.tagStyle[e.name]||"").split(";").concat((t.style||"").split(";")),n={};let i="";t.id&&!this.xml&&(this.options.useAnchor?this.expose():"img"!==e.name&&"a"!==e.name&&"video"!==e.name&&"audio"!==e.name&&(t.id=void 0)),t.width&&(n.width=parseFloat(t.width)+(t.width.includes("%")?"%":"px"),t.width=void 0),t.height&&(n.height=parseFloat(t.height)+(t.height.includes("%")?"%":"px"),t.height=void 0);for(let o=0,l=a.length;o<l;o++){const e=a[o].split(":");if(e.length<2)continue;const t=e.shift().trim().toLowerCase();let l=e.join(":").trim();if("-"===l[0]&&l.lastIndexOf("-")>0||l.includes("safe"))i+=`;${t}:${l}`;else if(!n[t]||l.includes("import")||!n[t].includes("import")){if(l.includes("url")){let e=l.indexOf("(")+1;if(e){for(;'"'===l[e]||"'"===l[e]||nn[l[e]];)e++;l=l.substr(0,e)+this.getUrl(l.substr(e))}}else l.includes("rpx")&&(l=l.replace(/[0-9.]+\s*rpx/g,(e=>parseFloat(e)*tn/750+"px")));n[t]=l}}return e.attrs.style=i,n},cn.prototype.onTagName=function(e){this.tagName=this.xml?e:e.toLowerCase(),"svg"===this.tagName&&(this.xml=(this.xml||0)+1,Za.ignoreTags.style=void 0)},cn.prototype.onAttrName=function(e){(e=this.xml?e:e.toLowerCase()).includes("?")||e.includes(";")?this.attrName=void 0:"data-"===e.substr(0,5)?"data-src"!==e||this.attrs.src?"img"===this.tagName||"a"===this.tagName?this.attrName=e:this.attrName=void 0:this.attrName="src":(this.attrName=e,this.attrs[e]="T")},cn.prototype.onAttrVal=function(e){const t=this.attrName||"";"style"===t||"href"===t?this.attrs[t]=sn(e,!0):t.includes("src")?this.attrs[t]=this.getUrl(sn(e,!0)):t&&(this.attrs[t]=e)},cn.prototype.onOpenTag=function(e){const t=Object.create(null);t.name=this.tagName,t.attrs=this.attrs,this.options.nodes.length&&(t.type="node"),this.attrs=Object.create(null);const a=t.attrs,n=this.stack[this.stack.length-1],i=n?n.children:this.nodes,o=this.xml?e:Za.voidTags[t.name];if(en[t.name]&&(a.class=en[t.name]+(a.class?" "+a.class:"")),"embed"===t.name&&this.expose(),"video"!==t.name&&"audio"!==t.name||("video"!==t.name||a.id||(a.id="v"+on++),a.controls||a.autoplay||(a.controls="T"),t.src=[],a.src&&(t.src.push(a.src),a.src=void 0),this.expose()),o){if(!this.hook(t)||Za.ignoreTags[t.name])return void("base"!==t.name||this.options.domain?"source"===t.name&&n&&("video"===n.name||"audio"===n.name)&&a.src&&n.src.push(a.src):this.options.domain=a.href);const e=this.parseStyle(t);if("img"===t.name){if(a.src&&(a.src.includes("webp")&&(t.webp="T"),a.src.includes("data:")&&"all"!==this.options.previewImg&&!a["original-src"]&&(a.ignore="T"),!a.ignore||t.webp||a.src.includes("cloud://"))){for(let i=this.stack.length;i--;){const n=this.stack[i];"a"===n.name&&(t.a=n.attrs),"table"!==n.name||t.webp||a.src.includes("cloud://")||(!e.display||e.display.includes("inline")?t.t="inline-block":t.t=e.display,e.display=void 0),n.c=1}a.i=this.imgList.length.toString();let n=a["original-src"]||a.src;this.imgList.push(n),t.t||(this.imgList._unloadimgs+=1),this.options.lazyLoad&&(a["data-src"]=a.src,a.src=void 0)}"inline"===e.display&&(e.display=""),a.ignore&&(e["max-width"]=e["max-width"]||"100%",a.style+=";-webkit-touch-callout:none"),parseInt(e.width)>tn&&(e.height=void 0),isNaN(parseInt(e.width))||(t.w="T"),!isNaN(parseInt(e.height))&&(!e.height.includes("%")||n&&(n.attrs.style||"").includes("height"))&&(t.h="T"),t.w&&t.h&&e["object-fit"]&&("contain"===e["object-fit"]?t.m="aspectFit":"cover"===e["object-fit"]&&(t.m="aspectFill"))}else if("svg"===t.name)return i.push(t),this.stack.push(t),void this.popNode();for(const t in e)e[t]&&(a.style+=`;${t}:${e[t].replace(" !important","")}`);a.style=a.style.substr(1)||void 0}else("pre"===t.name||(a.style||"").includes("white-space")&&a.style.includes("pre"))&&2!==this.pre&&(this.pre=t.pre=1),t.children=[],this.stack.push(t);i.push(t)},cn.prototype.onCloseTag=function(e){let t;for(e=this.xml?e:e.toLowerCase(),t=this.stack.length;t--&&this.stack[t].name!==e;);if(-1!==t)for(;this.stack.length>t;)this.popNode();else if("p"===e||"br"===e){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push({name:e,attrs:{class:en[e]||"",style:this.tagStyle[e]||""}})}},cn.prototype.popNode=function(){const e=this.stack.pop();let t=e.attrs;const a=e.children,n=this.stack[this.stack.length-1],i=n?n.children:this.nodes;if(!this.hook(e)||Za.ignoreTags[e.name])return"title"===e.name&&a.length&&"text"===a[0].type&&this.options.setTitle&&uni.setNavigationBarTitle({title:a[0].text}),void i.pop();if(e.pre&&2!==this.pre){this.pre=e.pre=void 0;for(let e=this.stack.length;e--;)this.stack[e].pre&&(this.pre=1)}const o={};if("svg"===e.name){if(this.xml>1)return void this.xml--;let a="";const n=t.style;return t.style="",t.xmlns="http://www.w3.org/2000/svg",function e(t){if("text"===t.type)return void(a+=t.text);const n=Za.svgDict[t.name]||t.name;if("foreignObject"===n)for(const a of t.children||[])if(a.attrs&&!a.attrs.xmlns){a.attrs.xmlns="http://www.w3.org/1999/xhtml";break}a+="<"+n;for(const i in t.attrs){const e=t.attrs[i];e&&(a+=` ${Za.svgDict[i]||i}="${e.replace(/"/g,"")}"`)}if(t.children){a+=">";for(let a=0;a<t.children.length;a++)e(t.children[a]);a+="</"+n+">"}else a+="/>"}(e),e.name="img",e.attrs={src:"data:image/svg+xml;utf8,"+a.replace(/#/g,"%23"),style:n,ignore:"T"},e.children=void 0,this.xml=!1,void(Za.ignoreTags.style=!0)}if(t.align&&("table"===e.name?"center"===t.align?o["margin-inline-start"]=o["margin-inline-end"]="auto":o.float=t.align:o["text-align"]=t.align,t.align=void 0),t.dir&&(o.direction=t.dir,t.dir=void 0),"font"===e.name&&(t.color&&(o.color=t.color,t.color=void 0),t.face&&(o["font-family"]=t.face,t.face=void 0),t.size)){let e=parseInt(t.size);isNaN(e)||(e<1?e=1:e>7&&(e=7),o["font-size"]=["x-small","small","medium","large","x-large","xx-large","xxx-large"][e-1]),t.size=void 0}if((t.class||"").includes("align-center")&&(o["text-align"]="center"),Object.assign(o,this.parseStyle(e)),"table"!==e.name&&parseInt(o.width)>tn&&(o["max-width"]="100%",o["box-sizing"]="border-box"),Za.blockTags[e.name]?e.name="div":Za.trustTags[e.name]||this.xml||(e.name="span"),"a"===e.name||"ad"===e.name||"iframe"===e.name)this.expose();else if("video"===e.name){(o.height||"").includes("auto")&&(o.height=void 0);let a='<video style="width:100%;height:100%"';for(const e in t)t[e]&&(a+=" "+e+'="'+t[e]+'"');this.options.pauseVideo&&(a+=" onplay=\"this.dispatchEvent(new CustomEvent('vplay',{bubbles:!0}));for(var e=document.getElementsByTagName('video'),t=0;t<e.length;t++)e[t]!=this&&e[t].pause()\""),a+=">";for(let t=0;t<e.src.length;t++)a+='<source src="'+e.src[t]+'">';a+="</video>",e.html=a}else if("ul"!==e.name&&"ol"!==e.name||!e.c)if("table"===e.name){let n=parseFloat(t.cellpadding),i=parseFloat(t.cellspacing);const l=parseFloat(t.border),s=o["border-color"],r=o["border-style"];if(e.c&&(isNaN(n)&&(n=2),isNaN(i)&&(i=2)),l&&(t.style+=`;border:${l}px ${r||"solid"} ${s||"gray"}`),e.flag&&e.c){o.display="grid","collapse"===o["border-collapse"]&&(o["border-collapse"]=void 0,i=0),i?(o["grid-gap"]=i+"px",o.padding=i+"px"):l&&(t.style+=";border-left:0;border-top:0");const c=[],d=[],u=[],m={};!function e(t){for(let a=0;a<t.length;a++)if("tr"===t[a].name)d.push(t[a]);else if("colgroup"===t[a].name){let e=1;for(const n of t[a].children||[])if("col"===n.name){const t=n.attrs.style||"",a=t.indexOf("width")?t.indexOf(";width"):0;if(-1!==a){let n=t.indexOf(";",a+6);-1===n&&(n=t.length),c[e]=t.substring(a?a+7:6,n)}e+=1}}else e(t[a].children||[])}(a);for(let e=1;e<=d.length;e++){let t=1;for(let a=0;a<d[e-1].children.length;a++){const o=d[e-1].children[a];if("td"===o.name||"th"===o.name){for(;m[e+"."+t];)t++;let a=o.attrs.style||"",d=a.indexOf("width")?a.indexOf(";width"):0;if(-1!==d){let e=a.indexOf(";",d+6);-1===e&&(e=a.length),o.attrs.colspan||(c[t]=a.substring(d?d+7:6,e)),a=a.substr(0,d)+a.substr(e)}if(a+=";display:flex",d=a.indexOf("vertical-align"),-1!==d){const e=a.substr(d+15,10);e.includes("middle")?a+=";align-items:center":e.includes("bottom")&&(a+=";align-items:flex-end")}else a+=";align-items:center";if(d=a.indexOf("text-align"),-1!==d){const e=a.substr(d+11,10);e.includes("center")?a+=";justify-content: center":e.includes("right")&&(a+=";justify-content: right")}if(a=(l?`;border:${l}px ${r||"solid"} ${s||"gray"}`+(i?"":";border-right:0;border-bottom:0"):"")+(n?`;padding:${n}px`:"")+";"+a,o.attrs.colspan&&(a+=`;grid-column-start:${t};grid-column-end:${t+parseInt(o.attrs.colspan)}`,o.attrs.rowspan||(a+=`;grid-row-start:${e};grid-row-end:${e+1}`),t+=parseInt(o.attrs.colspan)-1),o.attrs.rowspan){a+=`;grid-row-start:${e};grid-row-end:${e+parseInt(o.attrs.rowspan)}`,o.attrs.colspan||(a+=`;grid-column-start:${t};grid-column-end:${t+1}`);for(let a=1;a<o.attrs.rowspan;a++)for(let n=0;n<(o.attrs.colspan||1);n++)m[e+a+"."+(t-n)]=1}a&&(o.attrs.style=a),u.push(o),t++}}if(1===e){let e="";for(let a=1;a<t;a++)e+=(c[a]?c[a]:"auto")+" ";o["grid-template-columns"]=e}}e.children=u}else e.c&&(o.display="table"),isNaN(i)||(o["border-spacing"]=i+"px"),(l||n)&&function e(t){for(let a=0;a<t.length;a++){const i=t[a];"th"===i.name||"td"===i.name?(l&&(i.attrs.style=`border:${l}px ${r||"solid"} ${s||"gray"};${i.attrs.style||""}`),n&&(i.attrs.style=`padding:${n}px;${i.attrs.style||""}`)):i.children&&e(i.children)}}(a);if(this.options.scrollTable&&!(t.style||"").includes("inline")){const a=Object.assign({},e);e.name="div",e.attrs={style:"overflow:auto"},e.children=[a],t=a.attrs}}else if(("tbody"===e.name||"tr"===e.name)&&e.flag&&e.c)e.flag=void 0,function e(t){for(let a=0;a<t.length;a++)if("td"===t[a].name)for(const e of["color","background","background-color"])o[e]&&(t[a].attrs.style=e+":"+o[e]+";"+(t[a].attrs.style||""));else e(t[a].children||[])}(a);else if("td"!==e.name&&"th"!==e.name||!t.colspan&&!t.rowspan)if("ruby"===e.name){e.name="span";for(let e=0;e<a.length-1;e++)"text"===a[e].type&&"rt"===a[e+1].name&&(a[e]={name:"div",attrs:{style:"display:inline-block;text-align:center"},children:[{name:"div",attrs:{style:"font-size:50%;"+(a[e+1].attrs.style||"")},children:a[e+1].children},a[e]]},a.splice(e+1,1))}else e.c&&function e(t){t.c=2;for(let a=t.children.length;a--;){const n=t.children[a];n.name&&(Za.inlineTags[n.name]||(n.attrs.style||"").includes("inline")&&n.children)&&!n.c&&e(n),n.c&&"table"!==n.name||(t.c=1)}}(e);else for(let s=this.stack.length;s--;)"table"!==this.stack[s].name&&"tbody"!==this.stack[s].name&&"tr"!==this.stack[s].name||(this.stack[s].flag=1);else{const e={a:"lower-alpha",A:"upper-alpha",i:"lower-roman",I:"upper-roman"};e[t.type]&&(t.style+=";list-style-type:"+e[t.type],t.type=void 0);for(let t=a.length;t--;)"li"===a[t].name&&(a[t].c=1)}if((o.display||"").includes("flex")&&!e.c)for(let s=a.length;s--;){const e=a[s];e.f&&(e.attrs.style=(e.attrs.style||"")+e.f,e.f=void 0)}const l=n&&((n.attrs.style||"").includes("flex")||(n.attrs.style||"").includes("grid"))&&!e.c;l&&(e.f=";max-width:100%"),a.length>=50&&e.c&&!(o.display||"").includes("flex")&&rn(a);for(const s in o)if(o[s]){const a=`;${s}:${o[s].replace(" !important","")}`;l&&(s.includes("flex")&&"flex-direction"!==s||"align-self"===s||s.includes("grid")||"-"===o[s][0]||s.includes("width")&&a.includes("%"))?(e.f+=a,"width"===s&&(t.style+=";width:100%")):t.style+=a}t.style=t.style.substr(1)||void 0},cn.prototype.onText=function(e){if(!this.pre){let t,a="";for(let n=0,i=e.length;n<i;n++)nn[e[n]]?(" "!==a[a.length-1]&&(a+=" "),"\n"!==e[n]||t||(t=!0)):a+=e[n];if(" "===a){if(t)return;{const e=this.stack[this.stack.length-1];if(e&&"t"===e.name[0])return}}e=a}const t=Object.create(null);if(t.type="text",t.text=sn(e),this.hook(t)){(this.stack.length?this.stack[this.stack.length-1].children:this.nodes).push(t)}},dn.prototype.parse=function(e){this.content=e||"",this.i=0,this.start=0,this.state=this.text;for(let t=this.content.length;-1!==this.i&&this.i<t;)this.state()},dn.prototype.checkClose=function(e){const t="/"===this.content[this.i];return!!(">"===this.content[this.i]||t&&">"===this.content[this.i+1])&&(e&&this.handler[e](this.content.substring(this.start,this.i)),this.i+=t?2:1,this.start=this.i,this.handler.onOpenTag(t),"script"===this.handler.tagName?(this.i=this.content.indexOf("</",this.i),-1!==this.i&&(this.i+=2,this.start=this.i),this.state=this.endTag):this.state=this.text,!0)},dn.prototype.text=function(){if(this.i=this.content.indexOf("<",this.i),-1===this.i)return void(this.start<this.content.length&&this.handler.onText(this.content.substring(this.start,this.content.length)));const e=this.content[this.i+1];if(e>="a"&&e<="z"||e>="A"&&e<="Z")this.start!==this.i&&this.handler.onText(this.content.substring(this.start,this.i)),this.start=++this.i,this.state=this.tagName;else if("/"===e||"!"===e||"?"===e){this.start!==this.i&&this.handler.onText(this.content.substring(this.start,this.i));const t=this.content[this.i+2];if("/"===e&&(t>="a"&&t<="z"||t>="A"&&t<="Z"))return this.i+=2,this.start=this.i,void(this.state=this.endTag);let a="--\x3e";"!"===e&&"-"===this.content[this.i+2]&&"-"===this.content[this.i+3]||(a=">"),this.i=this.content.indexOf(a,this.i),-1!==this.i&&(this.i+=a.length,this.start=this.i)}else this.i++},dn.prototype.tagName=function(){if(nn[this.content[this.i]]){for(this.handler.onTagName(this.content.substring(this.start,this.i));nn[this.content[++this.i]];);this.i<this.content.length&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)}else this.checkClose("onTagName")||this.i++},dn.prototype.attrName=function(){let e=this.content[this.i];if(nn[e]||"="===e){this.handler.onAttrName(this.content.substring(this.start,this.i));let t="="===e;const a=this.content.length;for(;++this.i<a;)if(e=this.content[this.i],!nn[e]){if(this.checkClose())return;if(t)return this.start=this.i,void(this.state=this.attrVal);if("="!==this.content[this.i])return this.start=this.i,void(this.state=this.attrName);t=!0}}else this.checkClose("onAttrName")||this.i++},dn.prototype.attrVal=function(){const e=this.content[this.i],t=this.content.length;if('"'===e||"'"===e){if(this.start=++this.i,this.i=this.content.indexOf(e,this.i),-1===this.i)return;this.handler.onAttrVal(this.content.substring(this.start,this.i))}else for(;this.i<t;this.i++){if(nn[this.content[this.i]]){this.handler.onAttrVal(this.content.substring(this.start,this.i));break}if(this.checkClose("onAttrVal"))return}for(;nn[this.content[++this.i]];);this.i<t&&!this.checkClose()&&(this.start=this.i,this.state=this.attrName)},dn.prototype.endTag=function(){const e=this.content[this.i];if(nn[e]||">"===e||"/"===e){if(this.handler.onCloseTag(this.content.substring(this.start,this.i)),">"!==e&&(this.i=this.content.indexOf(">",this.i),-1===this.i))return;this.start=++this.i,this.state=this.text}else this.i++};const un=[];const mn=a({name:"mp-html",data:()=>({nodes:[]}),props:{containerStyle:{type:String,default:""},content:{type:String,default:""},copyLink:{type:[Boolean,String],default:!0},domain:String,errorImg:{type:String,default:""},lazyLoad:{type:[Boolean,String],default:!1},loadingImg:{type:String,default:""},pauseVideo:{type:[Boolean,String],default:!0},previewImg:{type:[Boolean,String],default:!0},scrollTable:[Boolean,String],selectable:[Boolean,String],setTitle:{type:[Boolean,String],default:!0},showImgMenu:{type:[Boolean,String],default:!0},tagStyle:Object,useAnchor:[Boolean,Number]},emits:["load","ready","imgtap","linktap","play","error"],components:{node:Xa},watch:{content(e){this.setContent(e)}},created(){this.plugins=[];for(let e=un.length;e--;)this.plugins.push(new un[e](this))},mounted(){this.content&&!this.nodes.length&&this.setContent(this.content)},beforeDestroy(){this._hook("onDetached")},methods:{in(e,t,a){e&&t&&a&&(this._in={page:e,selector:t,scrollTop:a})},navigateTo(e,t){return new Promise(((a,n)=>{if(!this.useAnchor)return void n(Error("Anchor is disabled"));t=t||parseInt(this.useAnchor)||0;const i=uni.createSelectorQuery().in(this._in?this._in.page:this).select((this._in?this._in.selector:"._root")+(e?` #${e}`:"")).boundingClientRect();this._in?i.select(this._in.selector).scrollOffset().select(this._in.selector).boundingClientRect():i.selectViewport().scrollOffset(),i.exec((e=>{if(!e[0])return void n(Error("Label not found"));const i=e[1].scrollTop+e[0].top-(e[2]?e[2].top:0)+t;this._in?this._in.page[this._in.scrollTop]=i:uni.pageScrollTo({scrollTop:i,duration:300}),a()}))}))},getText(e){let t="";return function e(a){for(let n=0;n<a.length;n++){const i=a[n];if("text"===i.type)t+=i.text.replace(/&amp;/g,"&");else if("br"===i.name)t+="\n";else{const a="p"===i.name||"div"===i.name||"tr"===i.name||"li"===i.name||"h"===i.name[0]&&i.name[1]>"0"&&i.name[1]<"7";a&&t&&"\n"!==t[t.length-1]&&(t+="\n"),i.children&&e(i.children),a&&"\n"!==t[t.length-1]?t+="\n":"td"!==i.name&&"th"!==i.name||(t+="\t")}}}(e||this.nodes),t},getRect(){return new Promise(((e,t)=>{uni.createSelectorQuery().in(this).select("#_root").boundingClientRect().exec((a=>a[0]?e(a[0]):t(Error("Root label not found"))))}))},pauseMedia(){for(let t=(this._videos||[]).length;t--;)this._videos[t].pause();let e=this.$parent;for(;!e.$scope;)e=e.$parent;e.$scope.$getAppWebview().evalJS('for(var e=document.getElementsByTagName("video"),i=e.length;i--;)e[i].pause()')},setPlaybackRate(e){this.playbackRate=e;for(let n=(this._videos||[]).length;n--;)this._videos[n].playbackRate(e);const t='for(var e=document.getElementsByTagName("video"),i=e.length;i--;)e[i].playbackRate='+e;let a=this.$parent;for(;!a.$scope;)a=a.$parent;a.$scope.$getAppWebview().evalJS(t)},setContent(e,t){t&&this.imgList||(this.imgList=[]);const a=new cn(this).parse(e);if(this.$set(this,"nodes",t?(this.nodes||[]).concat(a):a),this._videos=[],this.$nextTick((()=>{this._hook("onLoad"),this.$emit("load")})),this.lazyLoad||this.imgList._unloadimgs<this.imgList.length/2){let e=0;const t=a=>{a&&a.height||(a={}),a.height===e?this.$emit("ready",a):(e=a.height,setTimeout((()=>{this.getRect().then(t).catch(t)}),350))};this.getRect().then(t).catch(t)}else this.imgList._unloadimgs||this.getRect().then((e=>{this.$emit("ready",e)})).catch((()=>{this.$emit("ready",{})}))},_hook(e){for(let t=un.length;t--;)this.plugins[t][e]&&this.plugins[t][e]()}}},[["render",function(t,a,n,i,o,l){const s=e.resolveComponent("node");return e.openBlock(),e.createElementBlock("view",{id:"_root",class:e.normalizeClass((n.selectable?"_select ":"")+"_root"),style:e.normalizeStyle(n.containerStyle)},[o.nodes[0]?(e.openBlock(),e.createBlock(s,{key:1,childs:o.nodes,opts:[n.lazyLoad,n.loadingImg,n.errorImg,n.showImgMenu,n.selectable],name:"span"},null,8,["childs","opts"])):e.renderSlot(t.$slots,"default",{key:0},void 0,!0)],6)}],["__scopeId","data-v-59277af2"]]),hn=a(e.defineComponent({__name:"CommentItem",props:{data:{},isReply:{type:Boolean}},emits:["react","reply","edit","delete"],setup(t,{emit:a}){const n=t;ia();const o=e.computed((()=>!0===n.data.isMe)),l={p:"font-size: 14px; line-height: 1.5; color: var(--text-primary); margin: 0; margin-bottom: 2px;",div:"font-size: 14px; line-height: 1.5; color: var(--text-primary);",span:"font-size: 14px; line-height: 1.5; color: var(--text-primary);",a:"color: #007aff; text-decoration: none; font-size: 14px;",img:"max-width: 100%; border-radius: 6px; margin-top: 4px;"},s=e=>{const t=e.href||e["data-src"]||e.src;t&&(i("log","at components/Todo/CommentItem.vue:134","Mở link:",t),za(t))},r=e.computed((()=>{const e=n.data.message||"";if("UPDATE_TODO"===n.data.type&&e.includes("->")){const t=e.lastIndexOf("->");if(-1!==t){const a=e.substring(0,t).trim(),n=e.substring(t+2).trim(),i=a.match(/^<p>(- .*?:)/)||a.match(/^(- .*?:)/);let o="",l=a;return i&&(o=i[1].replace(/<p>|:$/g,"").trim()+":",l=a.replace(i[0],"").trim(),l.startsWith("</p>")&&(l=l.substring(4))),{isUpdate:!0,label:o,oldRaw:l,newRaw:n}}}return{isUpdate:!1}}));return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"comment-thread"},[e.createElementVNode("view",{class:"flex gap-3 mb-4 items-start"},[e.createVNode(p,{name:t.data.senderName,"avatar-color":t.data.senderAvatarColor,size:t.isReply?30:40,class:e.normalizeClass(["shrink-0",t.isReply?"mr-2":"mr-3"])},null,8,["name","avatar-color","size","class"]),e.createElementVNode("view",{class:"flex-1 overflow-hidden"},[e.createElementVNode("view",{class:"comment-bubble rounded-2xl p-3 rounded-tl-none relative"},[e.createElementVNode("view",{class:"flex flex-col items-start mb-2"},[e.createElementVNode("view",{class:"flex flex-wrap items-center gap-1"},[e.createElementVNode("text",{class:"font-bold text-sm sender-name"},e.toDisplayString(t.data.senderName),1),t.data.actionText?(e.openBlock(),e.createElementBlock("text",{key:0,class:"text-xs action-text font-normal"},e.toDisplayString(t.data.actionText),1)):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"flex items-center mt-1"},[e.createElementVNode("text",{class:"text-xs time-text"},e.toDisplayString(t.data.timeDisplay),1),t.data.isEdited?(e.openBlock(),e.createElementBlock("text",{key:0,class:"text-xs time-text italic ml-1"}," • Đã sửa ")):e.createCommentVNode("",!0)])]),r.value.isUpdate?(e.openBlock(),e.createElementBlock("view",{key:0,class:"content-body"},[e.createElementVNode("text",{class:"font-bold text-sm log-label block mb-1"},e.toDisplayString(r.value.label),1),e.createElementVNode("view",{class:"change-flow"},[e.createElementVNode("view",{class:"part-container"},[e.createVNode(mn,{content:r.value.oldRaw,"copy-link":!1,"tag-style":l,"container-style":"font-size: 14px; color: var(--text-primary); line-height: 1.5;",onLinktap:s},null,8,["content"])]),e.createElementVNode("view",{class:"arrow-container"},[e.createElementVNode("text",{class:"arrow-text"},"→")]),e.createElementVNode("view",{class:"part-container"},[e.createVNode(mn,{content:r.value.newRaw,"copy-link":!1,"tag-style":l,"container-style":"font-size: 14px; color: var(--text-primary); line-height: 1.5;",onLinktap:s},null,8,["content"])])])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"content-body"},[e.createVNode(mn,{content:t.data.message,"copy-link":!1,"tag-style":l,"container-style":"font-size: 14px; color: var(--text-primary); line-height: 1.5;",onLinktap:s},null,8,["content"]),t.data.files?(e.openBlock(),e.createElementBlock("view",{key:0,class:"mt-2"},[e.createElementVNode("image",{src:t.data.files,mode:"widthFix",class:"comment-attachment-img",onClick:a[0]||(a[0]=e.withModifiers((e=>{var a;(a=t.data.files)&&uni.previewImage({urls:[a],current:0})}),["stop"]))},null,8,["src"])])):e.createCommentVNode("",!0)]))]),e.createElementVNode("view",{class:"c-footer-actions"},[e.createElementVNode("view",{class:"reaction-row"},[t.data.reactions&&t.data.reactions.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"flex gap-1 mt-1"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data.reactions,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"emoji-tag"},e.toDisplayString(t.codeEmoji),1)))),128))])):e.createCommentVNode("",!0)]),"COMMENT"===t.data.type?(e.openBlock(),e.createElementBlock("view",{key:0,class:"action-buttons-container"},[e.createElementVNode("view",{class:"btn-icon-action",onClick:a[1]||(a[1]=e=>t.$emit("react",t.data))},[e.createElementVNode("image",{src:"/static/reaction.png",class:"icon-action"})]),e.createElementVNode("view",{class:"btn-icon-action",onClick:a[2]||(a[2]=e=>t.$emit("reply",t.data))},[e.createElementVNode("image",{src:"/static/reply_comment.png",class:"icon-action"})]),o.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("view",{class:"btn-icon-action",onClick:a[3]||(a[3]=e=>t.$emit("edit",t.data))},[e.createElementVNode("image",{src:"/static/edit_comment.png",class:"icon-action"})]),e.createElementVNode("view",{class:"btn-icon-action",onClick:a[4]||(a[4]=e=>t.$emit("delete",t.data.id))},[e.createElementVNode("image",{src:"/static/delete.png",class:"icon-action"})])],64)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)])])]),t.data.children&&t.data.children.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"pl-12 mt-2 replies-wrapper"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data.children,(n=>(e.openBlock(),e.createBlock(hn,{key:n.id,data:n,"is-reply":!0,onReact:a[5]||(a[5]=e=>t.$emit("react",e)),onReply:a[6]||(a[6]=e=>t.$emit("reply",e)),onEdit:a[7]||(a[7]=e=>t.$emit("edit",e)),onDelete:a[8]||(a[8]=e=>t.$emit("delete",e))},null,8,["data"])))),128))])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-92f9a061"]]),pn=a(e.defineComponent({__name:"todo_detail",setup(t){const a=ia(),n=e.computed((()=>a.isDark)),{isLoading:i,isLoadingCustomer:o,isLoadingHistory:l,historyList:s,form:r,statusOptions:c,sourceOptions:d,assigneeOptions:u,onStatusChange:h,onSourceChange:p,onAssigneeChange:g,saveTodo:f,historyFilterOptions:_,historyFilterIndex:v,onHistoryFilterChange:y,comments:k,isLoadingComments:b,newCommentText:w,isSubmittingComment:D,submitComment:C,isConfirmDeleteCommentOpen:S,onRequestDeleteComment:N,confirmDeleteComment:E,cancelDeleteComment:x,currentUserId:V,isEditingComment:$,onRequestEditComment:B,submitUpdateComment:M,onCancelEditComment:I,isConfirmCancelEditOpen:O,continueEditing:R,confirmCancelEdit:A,editingMemberName:L,isEmojiPickerOpen:F,emojiList:P,onToggleEmojiPicker:U,closeEmojiPicker:z,selectEmoji:j,isReplying:H,replyingMemberName:W,replyingCommentData:q,onRequestReply:Y,onCancelReply:G,submitReply:K,isConfirmCancelReplyOpen:J,continueReplying:Q,confirmCancelReply:X,commentFilterIndex:Z,commentFilterOptions:ee,onCommentFilterChange:te,isSavingDescription:ae,onSaveDescription:ne,onDateUpdate:ie,isStatusDisabled:oe,onSaveTitle:le,replyingMessagePreview:se,isHistoryOpen:re,toggleHistory:ce,goBack:de,isDone:ue}=Ka(),me=e.ref(!1);e.ref("");const he=()=>{me.value=!me.value},pe=e.ref(null),ge=()=>{me.value||(me.value=!0),setTimeout((()=>{uni.createSelectorQuery().select("#comment-input-anchor").boundingClientRect((e=>{e&&uni.createSelectorQuery().selectViewport().scrollOffset((t=>{if(t){let a=t.scrollTop+e.top-100;uni.pageScrollTo({scrollTop:a,duration:300})}})).exec()})).exec()}),150)};return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["container",{"theme-dark":n.value}])},[e.unref(i)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-bar"})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"custom-header"},[e.createElementVNode("view",{onClick:a[0]||(a[0]=(...t)=>e.unref(de)&&e.unref(de)(...t)),class:"back-btn"},[e.createElementVNode("image",{src:Oa,class:"back-icon"})]),e.createElementVNode("text",{class:"header-title"},e.toDisplayString(t.$t("todo.todo_detail_title")),1),e.createElementVNode("view",{class:"header-right"})]),e.createElementVNode("view",{class:"detail-header-content"},[e.createElementVNode("view",{class:"header-top"},[e.createElementVNode("text",{class:"header-code"},"#"+e.toDisplayString(e.unref(r).code||"..."),1)]),e.withDirectives(e.createElementVNode("textarea",{class:"header-title-input","onUpdate:modelValue":a[1]||(a[1]=t=>e.unref(r).title=t),placeholder:t.$t("todo.header_loading"),"auto-height":"",maxlength:"256","confirm-type":"done",disabled:e.unref(ue),onConfirm:a[2]||(a[2]=(...t)=>e.unref(le)&&e.unref(le)(...t)),onBlur:a[3]||(a[3]=(...t)=>e.unref(le)&&e.unref(le)(...t)),"placeholder-class":"input-placeholder"},null,40,["placeholder","disabled"]),[[e.vModelText,e.unref(r).title]])]),e.createElementVNode("view",{class:"detail-body"},[e.createElementVNode("view",{class:"section-title"},e.toDisplayString(t.$t("todo.desc_section")),1),e.createElementVNode("view",{class:"section-block"},[e.createVNode(Ha,{modelValue:e.unref(r).desc,"onUpdate:modelValue":a[4]||(a[4]=t=>e.unref(r).desc=t),placeholder:t.$t("todo.desc_placeholder"),"read-only":e.unref(ue)},null,8,["modelValue","placeholder","read-only"]),e.unref(ue)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"input-actions",style:{"margin-top":"10px"}},[e.createVNode(xa,{type:"primary",size:"small",loading:e.unref(ae),label:e.unref(ae)?t.$t("common.saving"):t.$t("common.save"),onClick:e.unref(ne)},null,8,["loading","label","onClick"])]))]),e.createElementVNode("view",{class:"section-title"},e.toDisplayString(t.$t("todo.info_section")),1),e.createElementVNode("view",{class:e.normalizeClass(["info-group",{"disabled-group":e.unref(ue)}])},[e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:m,class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(t.$t("todo.status")),1)]),e.createElementVNode("view",{class:"item-picker-box"},[e.createVNode(T,{range:e.unref(c),value:e.unref(r).statusIndex,onChange:e.unref(h),title:t.$t("todo.status")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["picker-text",{"disabled-text":e.unref(oe)}])},[e.createTextVNode(e.toDisplayString(e.unref(c)[e.unref(r).statusIndex]||t.$t("common.loading"))+" ",1),e.unref(oe)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:0},"▾"))],2)])),_:1},8,["range","value","onChange","title"])])]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/internet.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(t.$t("todo.source")),1)]),e.createElementVNode("view",{class:"item-picker-box"},[e.createElementVNode("view",{class:"picker-text disabled-text"},e.toDisplayString(e.unref(d)[e.unref(r).sourceIndex]||"..."),1)])]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/user.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(t.$t("todo.assignee")),1)]),e.createElementVNode("view",{class:"item-picker-box"},[e.createVNode(T,{range:e.unref(u),value:e.unref(r).assigneeIndex,onChange:e.unref(g),title:t.$t("todo.assignee")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(e.unref(u).length>0&&e.unref(r).assigneeIndex>-1?e.unref(u)[e.unref(r).assigneeIndex]:t.$t("common.loading"))+" ▾ ",1)])),_:1},8,["range","value","onChange","title"])])]),e.createVNode(Wa,{dueDate:e.unref(r).dueDate,"onUpdate:dueDate":a[5]||(a[5]=t=>e.unref(r).dueDate=t),notifyAt:e.unref(r).notifyAt,"onUpdate:notifyAt":a[6]||(a[6]=t=>e.unref(r).notifyAt=t),onChange:e.unref(ie)},null,8,["dueDate","notifyAt","onChange"])],2),e.createElementVNode("view",{class:"section-title"},e.toDisplayString(t.$t("todo.customer_section")),1),e.createElementVNode("view",{class:"info-group customer-block"},[e.unref(o)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-row"},[e.createElementVNode("text",{class:"loading-text"},e.toDisplayString(t.$t("todo.loading_crm")),1)])):e.unref(r).customerCode?(e.openBlock(),e.createElementBlock("view",{key:2},[e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/user-male-circle.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(t.$t("todo.customer_name_label")),1)]),e.createElementVNode("view",{class:"item-right-text"},e.toDisplayString(e.unref(r).customerName),1)]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/phone.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(t.$t("todo.customer_phone_label")),1)]),e.createElementVNode("view",{class:"item-right-text phone-text"},e.toDisplayString(e.unref(r).customerPhone),1)]),e.createElementVNode("view",{class:"flat-item"},[e.createElementVNode("view",{class:"item-left"},[e.createElementVNode("image",{src:"/static/manager.png",class:"item-icon"}),e.createElementVNode("text",{class:"item-label"},e.toDisplayString(t.$t("todo.customer_manager_label")),1)]),e.createElementVNode("view",{class:"item-right-text highlight-text"},e.toDisplayString(e.unref(r).customerManagerName||t.$t("todo.manager_none")),1)])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-row"},[e.createElementVNode("text",null,e.toDisplayString(t.$t("todo.no_customer_attached")),1)]))]),e.createElementVNode("view",{class:"section-header-row"},[e.createElementVNode("view",{class:"toggle-header",onClick:he},[e.createElementVNode("text",{class:"section-title no-margin"},e.toDisplayString(t.$t("todo.comments_activities")),1),e.createElementVNode("image",{src:Oa,class:e.normalizeClass(["toggle-icon",{open:me.value}])},null,2)]),e.createVNode(T,{range:e.unref(ee),value:e.unref(Z),onClick:a[7]||(a[7]=e.withModifiers((()=>{}),["stop"])),onChange:e.unref(te),title:t.$t("common.filter")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"filter-badge"},e.toDisplayString(e.unref(ee)[e.unref(Z)])+" ▾",1)])),_:1},8,["range","value","onChange","title"])]),me.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"comments-section"},[e.createElementVNode("view",{class:"comment-input-block",id:"comment-input-anchor"},[e.createElementVNode("view",{class:"editor-container"},[e.createVNode(Ha,{ref_key:"todoEditorRef",ref:pe,modelValue:e.unref(w),"onUpdate:modelValue":a[8]||(a[8]=t=>e.isRef(w)?w.value=t:null),placeholder:e.unref($)?t.$t("todo.comment_placeholder_edit"):e.unref(H)?t.$t("todo.comment_placeholder_reply"):t.$t("todo.comment_placeholder_write")},null,8,["modelValue","placeholder"])]),e.unref($)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"editing-alert"},[e.createElementVNode("text",{class:"editing-text"},[e.createTextVNode(e.toDisplayString(t.$t("todo.editing_alert"))+" ",1),e.createElementVNode("text",{class:"editing-name"},e.toDisplayString(e.unref(L)),1)])])):e.createCommentVNode("",!0),e.unref(H)&&e.unref(q)?(e.openBlock(),e.createElementBlock("view",{key:1,class:"reply-alert"},[e.createElementVNode("view",{class:"reply-info"},[e.createElementVNode("text",{class:"reply-label"},e.toDisplayString(t.$t("todo.replying_alert")),1),e.createElementVNode("text",{class:"reply-name"},e.toDisplayString(e.unref(W)),1)]),e.createElementVNode("view",{class:"reply-quote"},[e.createElementVNode("text",{class:"quote-icon"},"“"),e.createElementVNode("rich-text",{nodes:e.unref(se),class:"quote-content"},null,8,["nodes"]),e.createElementVNode("text",{class:"quote-icon"},"”")])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"input-actions"},[e.unref($)||e.unref(H)?e.unref($)?(e.openBlock(),e.createElementBlock("view",{key:1,class:"edit-actions-row"},[e.createVNode(xa,{type:"secondary",size:"small",label:t.$t("common.cancel"),disabled:e.unref(D),onClick:e.unref(I)},null,8,["label","disabled","onClick"]),e.createVNode(xa,{type:"primary",size:"small",loading:e.unref(D),label:e.unref(D)?t.$t("common.saving"):t.$t("todo.update_btn"),onClick:e.unref(M)},null,8,["loading","label","onClick"])])):e.unref(H)?(e.openBlock(),e.createElementBlock("view",{key:2,class:"edit-actions-row"},[e.createVNode(xa,{type:"secondary",size:"small",label:t.$t("common.cancel"),disabled:e.unref(D),onClick:e.unref(G)},null,8,["label","disabled","onClick"]),e.createVNode(xa,{type:"primary",size:"small",loading:e.unref(D),label:e.unref(D)?t.$t("common.saving"):t.$t("todo.reply_btn"),onClick:e.unref(K)},null,8,["loading","label","onClick"])])):e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(xa,{key:0,type:"primary",size:"small",loading:e.unref(D),label:e.unref(D)?t.$t("common.saving"):t.$t("common.save"),onClick:e.unref(C)},null,8,["loading","label","onClick"]))])]),e.createElementVNode("view",{class:"divider-line"}),e.unref(b)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-row"},[e.createElementVNode("text",null,e.toDisplayString(t.$t("todo.loading_comments")),1)])):0===e.unref(k).length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-row"},[e.createElementVNode("text",null,e.toDisplayString(t.$t("todo.no_comments")),1)])):(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(k),(t=>(e.openBlock(),e.createBlock(hn,{key:t.id,data:t,onReact:e.unref(U),onReply:a[9]||(a[9]=e=>(e=>{Y(e),ge()})(e)),onEdit:a[10]||(a[10]=e=>(e=>{B(e.id),ge()})(e)),onDelete:a[11]||(a[11]=t=>e.unref(N)(t))},null,8,["data","onReact"])))),128))]))])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"section-header-row"},[e.createElementVNode("view",{class:"toggle-header",onClick:a[12]||(a[12]=(...t)=>e.unref(ce)&&e.unref(ce)(...t))},[e.createElementVNode("text",{class:"section-title no-margin"},e.toDisplayString(t.$t("todo.history_section")),1),e.createElementVNode("image",{src:Oa,class:e.normalizeClass(["toggle-icon",{open:e.unref(re)}])},null,2)]),e.createVNode(T,{range:e.unref(_),value:e.unref(v),onClick:a[13]||(a[13]=e.withModifiers((()=>{}),["stop"])),onChange:e.unref(y),title:t.$t("common.filter")},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"filter-badge"},e.toDisplayString(e.unref(_)[e.unref(v)])+" ▾",1)])),_:1},8,["range","value","onChange","title"])]),e.unref(re)?(e.openBlock(),e.createElementBlock("view",{key:1,class:"history-container"},[e.unref(l)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loading-row"},[e.createElementVNode("text",{class:"loading-text"},e.toDisplayString(t.$t("todo.loading_history")),1)])):0===e.unref(s).length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-row"},[e.createElementVNode("text",null,e.toDisplayString(t.$t("todo.no_history")),1)])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"timeline-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"timeline-item"},[a!==e.unref(s).length-1?(e.openBlock(),e.createElementBlock("view",{key:0,class:"timeline-line"})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"timeline-dot"}),e.createElementVNode("view",{class:"timeline-content"},[e.createElementVNode("view",{class:"timeline-header"},[e.createElementVNode("text",{class:"t-actor"},e.toDisplayString(t.actorName),1),e.createElementVNode("text",{class:"t-time"},e.toDisplayString(t.timeStr),1)]),e.createElementVNode("text",{class:"t-action"},e.toDisplayString(t.content),1)])])))),128))]))])):e.createCommentVNode("",!0),e.createElementVNode("view",{style:{height:"50px"}})]),e.createVNode($a,{visible:e.unref(O),"onUpdate:visible":a[14]||(a[14]=t=>e.isRef(O)?O.value=t:null),title:t.$t("todo.cancel_edit_title"),message:t.$t("todo.cancel_edit_msg"),"cancel-label":t.$t("todo.continue_edit"),"confirm-label":t.$t("common.cancel_action"),"confirm-type":"danger",onCancel:e.unref(R),onConfirm:e.unref(A)},null,8,["visible","title","message","cancel-label","confirm-label","onCancel","onConfirm"]),e.createVNode($a,{visible:e.unref(J),"onUpdate:visible":a[15]||(a[15]=t=>e.isRef(J)?J.value=t:null),title:t.$t("todo.cancel_reply_title"),message:t.$t("todo.cancel_reply_msg"),"cancel-label":t.$t("todo.continue_reply"),"confirm-label":t.$t("common.cancel_action"),"confirm-type":"danger",onCancel:e.unref(Q),onConfirm:e.unref(X)},null,8,["visible","title","message","cancel-label","confirm-label","onCancel","onConfirm"]),e.createVNode($a,{visible:e.unref(S),"onUpdate:visible":a[16]||(a[16]=t=>e.isRef(S)?S.value=t:null),title:t.$t("todo.delete_comment_title"),message:t.$t("todo.delete_comment_msg"),"confirm-type":"danger",onConfirm:e.unref(E),onCancel:e.unref(x)},null,8,["visible","title","message","onConfirm","onCancel"]),e.unref(F)?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal-overlay",onClick:a[18]||(a[18]=(...t)=>e.unref(z)&&e.unref(z)(...t))},[e.createElementVNode("view",{class:"emoji-picker-container",onClick:a[17]||(a[17]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("view",{class:"emoji-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(P),((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"emoji-item",onClick:a=>e.unref(j)(t)},e.toDisplayString(t),9,["onClick"])))),128))])])])):e.createCommentVNode("",!0),e.createVNode(Va),e.createVNode(Ma)],2))}}),[["__scopeId","data-v-4a8a4b4d"]]);__definePage("pages/todo/list_todo",Ia),__definePage("pages/todo/create_todo",qa),__definePage("pages/todo/todo_detail",pn);const gn=e.defineComponent({__name:"App",setup(e){const t=async(e,t=null)=>{i("log","at App.vue:9",`[${e}] Bắt đầu kiểm tra dữ liệu từ Native...`);const a=ia(),n=aa();let o=null;if(t&&t.referrerInfo&&t.referrerInfo.extraData)i("log","at App.vue:17","-> Tìm thấy dữ liệu trong options.referrerInfo"),o=t.referrerInfo.extraData;else if("undefined"!=typeof plus&&plus.runtime&&plus.runtime.arguments){i("log","at App.vue:21","-> Tìm thấy dữ liệu trong plus.runtime.arguments");const e=plus.runtime.arguments;try{o="string"==typeof e&&e.startsWith("{")?JSON.parse(e):e}catch(l){i("error","at App.vue:26","Lỗi parse arguments:",l),"object"==typeof e&&(o=e)}}else{const e=uni.getLaunchOptionsSync();e&&e.extraData&&(o=e.extraData)}o?("en"!==o.language&&"vi"!==o.language||(i("log","at App.vue:44","🔥 App.vue: Native yêu cầu ngôn ngữ ->",o.language),na(o.language)),o.themeMode?(i("log","at App.vue:49","🎨 Native yêu cầu theme:",o.themeMode),a.applyTheme(o.themeMode)):a.applyTheme("auto"),o.uid&&o.access_token&&(i("log","at App.vue:56","✅ Dữ liệu Auth hợp lệ -> Tiến hành đồng bộ Store"),await a.initFromNative(o),a.isLoggedIn&&n.connect())):(i("log","at App.vue:64","⚠️ Không tìm thấy dữ liệu auth hợp lệ từ Native ở pha này."),"Launch"===e&&i("warn","at App.vue:66","App Launch thiếu data"))};return c((e=>{i("log","at App.vue:72"," App Launch"),t("Launch",e)})),s((e=>{i("log","at App.vue:77","App Show"),t("Show",e)})),r((()=>{i("log","at App.vue:82"," App Hide")})),()=>{}}});const{app:fn,Vuex:_n,Pinia:vn}=function(){const t=e.createVueApp(gn);t.use(vt()),t.use(ta);const a=e.unref(ta.global.locale);return uni.setLocale(a),{app:t,Pinia:$t}}();uni.Vuex=_n,uni.Pinia=vn,fn.provide("__globalStyles",__uniConfig.styles),fn._component.mpType="app",fn._component.render=()=>{},fn.mount("#app")}(Vue);
